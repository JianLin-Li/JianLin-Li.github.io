
<!DOCTYPE html>
<html
  lang="zh-cn"
  data-figures="true"
  
    class="page"
  
  
  >
  <head>
<title>PHPè¯­è¨€çš„çŸ¥è¯†ç‚¹-3 | æµ©ç€šå¤©ç©º</title>
<meta charset="utf-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">






<meta property="og:locale" content="zh-cn" />

<meta property="og:type" content="article">
<meta name="description" content="Article description." />
<meta name="twitter:card" content="summary" />
<meta name="twitter:creator" content="">
<meta name="twitter:title" content="PHPè¯­è¨€çš„çŸ¥è¯†ç‚¹-3" />
<meta name="twitter:image" content="https://jianlin-li.github.io/images/thumbnail.png"/>
<meta property="og:url" content="https://jianlin-li.github.io/post/php_review_3/" />
<meta property="og:title" content="PHPè¯­è¨€çš„çŸ¥è¯†ç‚¹-3" />
<meta property="og:description" content="Article description." />
<meta property="og:image" content="https://jianlin-li.github.io/images/thumbnail.png" />
  <meta name="keywords" content="PHP" />
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "BlogPosting",
      "mainEntityOfPage":"https:\/\/jianlin-li.github.io\/post\/php_review_3\/",
      "name": "æµ©ç€šå¤©ç©º",
      "headline": "PHPè¯­è¨€çš„çŸ¥è¯†ç‚¹-3",
      "description": "Article description.",
      "url": "https:\/\/jianlin-li.github.io\/post\/php_review_3\/",
      "datePublished": "2025-06-03T15:04:49+08:00",
      "dateModified": "2025-06-03T15:04:49+08:00",
      "keywords": ["PHP"],
        "articleSection": ["PHPè¯­è¨€"],
      "author": {
        "@type": "Person",
        "name": "map[name:æå»ºæ— photo:images\/fish-head.png]"
      },
      "image":{
        "@type":"ImageObject",
        "url": "https:\/\/jianlin-li.github.io\/images\/thumbnail.png"
      },
      "publisher": {
        "@type": "Organization",
        "logo": {
          "@type":"ImageObject",
          "url": "https:\/\/jianlin-li.github.io\/logos\/logo.png"
        },
        "name": "æµ©ç€šå¤©ç©º"
      }
    }
  </script>

<link rel="apple-touch-icon" sizes="180x180" href="https://jianlin-li.github.io/icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://jianlin-li.github.io/icons/favicon-32x32.png">
<link rel="manifest" href="https://jianlin-li.github.io/icons/site.webmanifest">

<link rel="canonical" href="https://jianlin-li.github.io/post/php_review_3/">



<link rel="preload" href="https://jianlin-li.github.io/css/styles.dc38388a8f0b890e788bd3a99b7495d14e7d5ac4359ed3b49abeb778497863b284ad4cc7e496ef58c84139295f9bafed82f5a41345eda86bd2d429cccb7c2596.css" integrity = "sha512-3Dg4io8LiQ54i9Opm3SV0U59WsQ1ntO0mr63eEl4Y7KErUzH5JbvWMhBOSlfm6/tgvWkE0XtqGvS1CnMy3wllg==" as="style" crossorigin="anonymous">



<link rel="preload" href="https://jianlin-li.github.io/zh-cn/js/bundle.e4e0e4fbe8acb50d7f973828f4138cdbea727800047fc93f9abbd6751e8f3422d6ef193f98da36fdb8488219c25692d73da89480f46abc8421a4ee3526dd6c23.js" as="script" integrity=
"sha512-5ODk&#43;&#43;istQ1/lzgo9BOM2&#43;pyeAAEf8k/mrvWdR6PNCLW7xk/mNo2/bhIghnCVpLXPaiUgPRqvIQhpO41Jt1sIw==" crossorigin="anonymous">


<link rel="stylesheet" type="text/css" href="https://jianlin-li.github.io/css/styles.dc38388a8f0b890e788bd3a99b7495d14e7d5ac4359ed3b49abeb778497863b284ad4cc7e496ef58c84139295f9bafed82f5a41345eda86bd2d429cccb7c2596.css" integrity="sha512-3Dg4io8LiQ54i9Opm3SV0U59WsQ1ntO0mr63eEl4Y7KErUzH5JbvWMhBOSlfm6/tgvWkE0XtqGvS1CnMy3wllg==" crossorigin="anonymous">

  </head>
  <body
    data-code="10"
    data-lines="false"
    id="documentTop"
    data-lang="zh-cn"
  >

<header class="nav_header" >
  <nav class="nav"><a href='https://jianlin-li.github.io/' class="nav_brand nav_item" title="æµ©ç€šå¤©ç©º">
  <img src="https://jianlin-li.github.io/logos/logo.png" class="logo" alt="æµ©ç€šå¤©ç©º">
  <div class="nav_close">
    <div><svg class="icon">
  <title>open-menu</title>
  <use xlink:href="#open-menu"></use>
</svg>
<svg class="icon">
  <title>closeme</title>
  <use xlink:href="#closeme"></use>
</svg>
</div>
  </div>
</a>

    <div class='nav_body nav_body_left'>
      
      
      
        

  <div class="nav_parent">
    <a href="https://jianlin-li.github.io/" class="nav_item" title="é¦–é¡µ">é¦–é¡µ </a>
  </div>
  <div class="nav_parent">
    <a href="https://jianlin-li.github.io/archives/" class="nav_item" title="å½’æ¡£">å½’æ¡£ </a>
  </div>
  <div class="nav_parent">
    <a href="https://jianlin-li.github.io/categories/" class="nav_item" title="åˆ†ç±»">åˆ†ç±» </a>
  </div>
  <div class="nav_parent">
    <a href="https://jianlin-li.github.io/tags/" class="nav_item" title="æ ‡ç­¾">æ ‡ç­¾ </a>
  </div>
  <div class="nav_parent">
    <a href="https://jianlin-li.github.io/about/" class="nav_item" title="å…³äº">å…³äº </a>
  </div>
      
<div class='follow'>
  <a href="https://github.com/JianLin-Li">
    <svg class="icon">
  <title>github</title>
  <use xlink:href="#github"></use>
</svg>

  </a>
  <a href="http://local.gitlab.com">
    <svg class="icon">
  <title>gitlab</title>
  <use xlink:href="#gitlab"></use>
</svg>

  </a>
<div class="color_mode">
  <input type="checkbox" class="color_choice" id="mode">
</div>

</div>

    </div>
  </nav>
</header>

    <main>
  
<div class="grid-inverse wrap content">
  <article class="post_content">
    <h1 class="post_title">PHPè¯­è¨€çš„çŸ¥è¯†ç‚¹-3</h1>
  <div class="post_meta">
    <span><svg class="icon">
  <title>calendar</title>
  <use xlink:href="#calendar"></use>
</svg>
</span>
    <span class="post_date">
      2025-06-03	  
    </span>
    <span class="post_time"> Â· 32 åˆ†é’Ÿé˜…è¯»</span><span>&nbsp;Â· <a href='https://jianlin-li.github.io/tags/php/' title="PHP" class="post_tag button button_translucent">PHP
        </a>
    </span>
    <span class="page_only">&nbsp;Â·
  <div class="post_share">
    åˆ†äº«åˆ°:
    <a href="https://twitter.com/intent/tweet?text=PHP%e8%af%ad%e8%a8%80%e7%9a%84%e7%9f%a5%e8%af%86%e7%82%b9-3&url=https%3a%2f%2fjianlin-li.github.io%2fpost%2fphp_review_3%2f&tw_p=tweetbutton" class="twitter" title="åˆ†äº«åˆ° Twitter" target="_blank" rel="nofollow">
      <svg class="icon">
  <title>twitter</title>
  <use xlink:href="#twitter"></use>
</svg>

    </a>
    <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fjianlin-li.github.io%2fpost%2fphp_review_3%2f&t=PHP%e8%af%ad%e8%a8%80%e7%9a%84%e7%9f%a5%e8%af%86%e7%82%b9-3" class="facebook" title="åˆ†äº«åˆ° Facebook" target="_blank" rel="nofollow">
      <svg class="icon">
  <title>facebook</title>
  <use xlink:href="#facebook"></use>
</svg>

    </a>
    <a href="#linkedinshare" id = "linkedinshare" class="linkedin" title="åˆ†äº«åˆ° LinkedIn" rel="nofollow">
      <svg class="icon">
  <title>linkedin</title>
  <use xlink:href="#linkedin"></use>
</svg>

    </a>
    <a href="https://jianlin-li.github.io/post/php_review_3/" title="Copy Link" class="link link_yank">
      <svg class="icon">
  <title>copy</title>
  <use xlink:href="#copy"></use>
</svg>

    </a>
  </div>
  </span>
  </div>

    <div class="post_body"><h1 id="åœ¨-php-çš„è‡ªåŠ¨åŠ è½½autoloadingæœºåˆ¶ä¸­æœ‰å‡ ç§å¸¸è§çš„æ–¹å¼ç”¨äºåŠ è½½ç±»æ–‡ä»¶åŒ…æ‹¬-psr-0psr-4classmap-å’Œ-files-includeså®ƒä»¬å„è‡ªæœ‰ä¸åŒçš„ä½¿ç”¨åœºæ™¯å’Œå®ç°æ–¹å¼">åœ¨ PHP çš„è‡ªåŠ¨åŠ è½½ï¼ˆAutoloadingï¼‰æœºåˆ¶ä¸­ï¼Œæœ‰å‡ ç§å¸¸è§çš„æ–¹å¼ç”¨äºåŠ è½½ç±»æ–‡ä»¶ï¼ŒåŒ…æ‹¬ <strong>PSR-0</strong>ã€<strong>PSR-4</strong>ã€<strong>classmap</strong> å’Œ <strong>files includes</strong>ã€‚å®ƒä»¬å„è‡ªæœ‰ä¸åŒçš„ä½¿ç”¨åœºæ™¯å’Œå®ç°æ–¹å¼ã€‚</h1>
<hr>
<h2 id="1-psr-0å·²åºŸå¼ƒ">1. PSR-0ï¼ˆå·²åºŸå¼ƒï¼‰</h2>
<h3 id="ç®€ä»‹">ç®€ä»‹ï¼š</h3>
<p>PSR-0 æ˜¯ PHP-FIGï¼ˆPHP Framework Interop Groupï¼‰æœ€æ—©æå‡ºçš„è‡ªåŠ¨åŠ è½½è§„èŒƒï¼Œç°å·²<strong>è¢« PSR-4 å–ä»£å¹¶åºŸå¼ƒ</strong>ï¼Œä½†ä¸€äº›è€é¡¹ç›®ä»åœ¨ä½¿ç”¨ã€‚</p>
<h3 id="è§„åˆ™">è§„åˆ™ï¼š</h3>
<ul>
<li>ç±»åå¿…é¡»æ˜ å°„åˆ°æ–‡ä»¶ç³»ç»Ÿè·¯å¾„ã€‚</li>
<li>ä¸‹åˆ’çº¿ <code>_</code> è¢«è§†ä¸ºç›®å½•åˆ†éš”ç¬¦ã€‚</li>
<li>å‘½åç©ºé—´åˆ†éš”ç¬¦ <code>\</code> ä¹Ÿè¢«è§†ä¸ºç›®å½•åˆ†éš”ç¬¦ã€‚</li>
<li>æ–‡ä»¶å¿…é¡»ä»¥ <code>.php</code> ç»“å°¾ã€‚</li>
</ul>
<h3 id="ç¤ºä¾‹">ç¤ºä¾‹ï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">// ç±»ï¼šVendor\Package\ClassName
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1">// å¯¹åº”è·¯å¾„ï¼š/path/to/project/Vendor/Package/ClassName.php
</span></span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1">// æˆ–è€…å¸¦ä¸‹åˆ’çº¿çš„ç±»ï¼ˆæ—§å¼ PEAR é£æ ¼ï¼‰
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="c1">// ç±»ï¼šVendor_Package_ClassName
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="c1">// å¯¹åº”è·¯å¾„ï¼š/path/to/project/Vendor/Package/ClassName.php
</span></span></span></code></pre></div><h3 id="composer-ä¸­çš„é…ç½®å·²ä¸æ¨è">Composer ä¸­çš„é…ç½®ï¼ˆå·²ä¸æ¨èï¼‰ï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="nt">&#34;autoload&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">        <span class="nt">&#34;psr-0&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">            <span class="nt">&#34;Vendor\\&#34;</span><span class="p">:</span> <span class="s2">&#34;src/&#34;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>âš ï¸ æ³¨æ„ï¼šPSR-0 ä¸æ”¯æŒçµæ´»çš„ç›®å½•ç»“æ„ï¼Œæ¯”å¦‚ä¸èƒ½å°† <code>src/</code> ç›´æ¥æ˜ å°„åˆ°å‘½åç©ºé—´æ ¹ï¼Œå¿…é¡»åŒ…å« Vendor åã€‚</p>
</blockquote>
<hr>
<h2 id="2-psr-4ç°ä»£æ ‡å‡†">2. PSR-4ï¼ˆç°ä»£æ ‡å‡†ï¼‰</h2>
<h3 id="ç®€ä»‹-1">ç®€ä»‹ï¼š</h3>
<p>PSR-4 æ˜¯ç›®å‰æ¨èçš„æ ‡å‡†ï¼Œæ›´åŠ çµæ´»ç®€æ´ï¼Œæ˜¯ç°ä»£ PHP é¡¹ç›®çš„é¦–é€‰ã€‚</p>
<h3 id="è§„åˆ™-1">è§„åˆ™ï¼š</h3>
<ul>
<li>å‘½åç©ºé—´å‰ç¼€æ˜ å°„åˆ°ä¸€ä¸ªåŸºç¡€ç›®å½•ã€‚</li>
<li>ç±»åçš„å‰©ä½™éƒ¨åˆ†ç›´æ¥å¯¹åº”å­ç›®å½•å’Œæ–‡ä»¶åã€‚</li>
<li>ä¸å†æ”¯æŒä¸‹åˆ’çº¿ <code>_</code> ä½œä¸ºè·¯å¾„åˆ†éš”ç¬¦ã€‚</li>
</ul>
<h3 id="ç¤ºä¾‹-1">ç¤ºä¾‹ï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">// å‘½åç©ºé—´ï¼šApp\Controller\UserController
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1">// å¦‚æœé…ç½®äº† &#34;App\\&#34;: &#34;src/&#34;
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="c1">// åˆ™å¯¹åº”æ–‡ä»¶è·¯å¾„ä¸ºï¼šsrc/Controller/UserController.php
</span></span></span></code></pre></div><h3 id="composer-é…ç½®">Composer é…ç½®ï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="nt">&#34;autoload&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">        <span class="nt">&#34;psr-4&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">            <span class="nt">&#34;App\\&#34;</span><span class="p">:</span> <span class="s2">&#34;src/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">            <span class="nt">&#34;MyLib\\&#34;</span><span class="p">:</span> <span class="s2">&#34;lib/&#34;</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>âœ… ä¼˜ç‚¹ï¼šç»“æ„æ¸…æ™°ã€æ”¯æŒä»»æ„æ·±åº¦ç›®å½•ã€ä¸å‘½åç©ºé—´å®Œç¾å¥‘åˆã€‚</p>
</blockquote>
<hr>
<h2 id="3-classmapç±»æ˜ å°„">3. classmapï¼ˆç±»æ˜ å°„ï¼‰</h2>
<h3 id="ç®€ä»‹-2">ç®€ä»‹ï¼š</h3>
<p>Composer æ‰«ææŒ‡å®šç›®å½•æˆ–æ–‡ä»¶ï¼Œ<strong>ç”Ÿæˆä¸€ä¸ªç±»ååˆ°æ–‡ä»¶è·¯å¾„çš„æ˜ å°„è¡¨</strong>ï¼ˆåœ¨ <code>vendor/composer/autoload_classmap.php</code> ä¸­ï¼‰ã€‚é€‚ç”¨äºæ— æ³•éµå¾ª PSR-4 çš„è€æ—§ä»£ç æˆ–ç¬¬ä¸‰æ–¹åº“ã€‚</p>
<h3 id="ç‰¹ç‚¹">ç‰¹ç‚¹ï¼š</h3>
<ul>
<li>ä¸ä¾èµ–å‘½åç©ºé—´æˆ–æ–‡ä»¶å‘½åè§„åˆ™ã€‚</li>
<li>æ‰«ææ—¶è¯»å–æ‰€æœ‰ PHP æ–‡ä»¶ï¼Œæå– <code>class</code>ã€<code>interface</code>ã€<code>trait</code> å£°æ˜ã€‚</li>
<li>åŠ è½½é€Ÿåº¦å¿«ï¼ˆç›´æ¥æŸ¥è¡¨ï¼‰ï¼Œä½†æ¯æ¬¡æ–°å¢ç±»éœ€é‡æ–° dumpã€‚</li>
</ul>
<h3 id="ç¤ºä¾‹-2">ç¤ºä¾‹ï¼š</h3>
<p>å‡è®¾ä½ æœ‰å¦‚ä¸‹æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">// lib/OldStyleClass.php
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="k">class</span> <span class="nc">OldStyleClass</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="composer-é…ç½®-1">Composer é…ç½®ï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="nt">&#34;autoload&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">        <span class="nt">&#34;classmap&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;lib/&#34;</span><span class="p">,</span> <span class="s2">&#34;database/seeds/&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿è¡Œ <code>composer dump-autoload</code> åï¼Œä¼šç”Ÿæˆç±»ä¼¼ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="s1">&#39;OldStyleClass&#39;</span> <span class="o">=&gt;</span> <span class="nv">$baseDir</span> <span class="o">.</span> <span class="s1">&#39;/lib/OldStyleClass.php&#39;</span><span class="p">,</span>
</span></span></code></pre></div><blockquote>
<p>âœ… é€‚åˆéæ ‡å‡†å‘½åçš„é—ç•™ä»£ç ã€‚</p>
</blockquote>
<hr>
<h2 id="4-files-includesç›´æ¥åŒ…å«æ–‡ä»¶">4. files includesï¼ˆç›´æ¥åŒ…å«æ–‡ä»¶ï¼‰</h2>
<h3 id="ç®€ä»‹-3">ç®€ä»‹ï¼š</h3>
<p>æœ‰äº›æ–‡ä»¶ä¸åŒ…å«ç±»ï¼Œè€Œæ˜¯å®šä¹‰å‡½æ•°ã€å¸¸é‡æˆ–å…¨å±€é€»è¾‘ï¼ˆå¦‚ helpers.phpï¼‰ã€‚è¿™äº›æ–‡ä»¶æ— æ³•é€šè¿‡ç±»åè‡ªåŠ¨åŠ è½½ï¼Œéœ€æ‰‹åŠ¨ includeã€‚</p>
<h3 id="ç‰¹ç‚¹-1">ç‰¹ç‚¹ï¼š</h3>
<ul>
<li>æ¯æ¬¡è¯·æ±‚éƒ½ä¼šåŠ è½½è¿™äº›æ–‡ä»¶ï¼ˆæ— æ¡ä»¶åŒ…å«ï¼‰ã€‚</li>
<li>é€‚ç”¨äºå‡½æ•°åº“ã€å…¨å±€å®ç­‰ã€‚</li>
</ul>
<h3 id="ç¤ºä¾‹-3">ç¤ºä¾‹ï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">// helpers.php
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="k">function</span> <span class="nf">dd</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="nx">var_dump</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="composer-é…ç½®-2">Composer é…ç½®ï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="nt">&#34;autoload&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">        <span class="nt">&#34;files&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;src/helpers.php&#34;</span><span class="p">,</span> <span class="s2">&#34;src/constants.php&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>âš ï¸ æ³¨æ„ï¼šè¿™äº›æ–‡ä»¶ä¼šåœ¨æ¯æ¬¡è¯·æ±‚æ—¶è¢«åŒ…å«ï¼Œå½±å“æ€§èƒ½ï¼Œåº”å°½é‡ç²¾ç®€ã€‚</p>
</blockquote>
<hr>
<h2 id="å››ç§æ–¹å¼å¯¹æ¯”æ€»ç»“">å››ç§æ–¹å¼å¯¹æ¯”æ€»ç»“</h2>
<table>
  <thead>
      <tr>
          <th>æ–¹å¼</th>
          <th>æ˜¯å¦åŸºäºå‘½åç©ºé—´</th>
          <th>æ˜¯å¦éœ€è¦ç¬¦åˆå‘½åè§„åˆ™</th>
          <th>æ˜¯å¦æ¯æ¬¡æ‰«æ</th>
          <th>é€‚ç”¨åœºæ™¯</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>PSR-0</strong></td>
          <td>âœ…</td>
          <td>âœ…ï¼ˆå«ä¸‹åˆ’çº¿æ”¯æŒï¼‰</td>
          <td>âŒï¼ˆå®æ—¶è®¡ç®—ï¼‰</td>
          <td>è€æ—§é¡¹ç›®ï¼ˆå·²åºŸå¼ƒï¼‰</td>
      </tr>
      <tr>
          <td><strong>PSR-4</strong></td>
          <td>âœ…</td>
          <td>âœ…ï¼ˆä¸¥æ ¼å‘½åç©ºé—´åŒ¹é…ï¼‰</td>
          <td>âŒï¼ˆå®æ—¶è®¡ç®—ï¼‰</td>
          <td>ç°ä»£ PHP é¡¹ç›®ï¼ˆæ¨èï¼‰</td>
      </tr>
      <tr>
          <td><strong>classmap</strong></td>
          <td>âŒ</td>
          <td>âŒï¼ˆä»»æ„å‘½åï¼‰</td>
          <td>âœ…ï¼ˆéœ€ dumpï¼‰</td>
          <td>é—ç•™ä»£ç ã€é—­æºåº“</td>
      </tr>
      <tr>
          <td><strong>files</strong></td>
          <td>âŒ</td>
          <td>âŒï¼ˆä¸åŠ è½½ç±»ï¼‰</td>
          <td>âœ…ï¼ˆå§‹ç»ˆåŠ è½½ï¼‰</td>
          <td>å…¨å±€å‡½æ•°ã€å¸¸é‡ã€è¾…åŠ©è„šæœ¬</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="ç»¼åˆç¤ºä¾‹composerjson">ç»¼åˆç¤ºä¾‹ï¼ˆComposer.jsonï¼‰</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="nt">&#34;autoload&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">        <span class="nt">&#34;psr-4&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">            <span class="nt">&#34;App\\&#34;</span><span class="p">:</span> <span class="s2">&#34;src/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">            <span class="nt">&#34;Tests\\&#34;</span><span class="p">:</span> <span class="s2">&#34;tests/&#34;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">        <span class="nt">&#34;classmap&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">            <span class="s2">&#34;database/seeds&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">            <span class="s2">&#34;legacy/&#34;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="nt">&#34;files&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">            <span class="s2">&#34;src/helpers.php&#34;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿è¡Œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">composer dump-autoload
</span></span></code></pre></div><p>ä¹‹åå°±å¯ä»¥åœ¨é¡¹ç›®ä¸­ç›´æ¥ä½¿ç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">use</span> <span class="nx">App\Controller\HomeController</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nv">$controller</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HomeController</span><span class="p">();</span> <span class="c1">// è‡ªåŠ¨é€šè¿‡ PSR-4 åŠ è½½
</span></span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="nx">dd</span><span class="p">(</span><span class="s1">&#39;debug&#39;</span><span class="p">);</span> <span class="c1">// æ¥è‡ª files ä¸­çš„ helpers.php
</span></span></span></code></pre></div><hr>
<h2 id="æ€»ç»“å»ºè®®">æ€»ç»“å»ºè®®</h2>
<ul>
<li><strong>æ–°é¡¹ç›®ä¸€å¾‹ç”¨ PSR-4</strong>ã€‚</li>
<li><strong>è€æ—§æ— å‘½åç©ºé—´çš„ç±»ç”¨ classmap</strong>ã€‚</li>
<li><strong>å…¨å±€å‡½æ•°ç”¨ files</strong>ã€‚</li>
<li><strong>é¿å…ä½¿ç”¨ PSR-0</strong>ï¼Œé™¤éç»´æŠ¤éå¸¸è€çš„ç³»ç»Ÿã€‚</li>
</ul>
<hr>
<h1 id="php-çš„-spl-autoloaderstandard-php-library-autoloadingæ˜¯-php-æä¾›çš„ä¸€å¥—æ ‡å‡†åŒ–å¯æ‰©å±•çš„è‡ªåŠ¨åŠ è½½æœºåˆ¶ç”¨äºåœ¨è¿è¡Œæ—¶æŒ‰éœ€åŠ è½½ç±»æ¥å£æˆ–-trait-æ–‡ä»¶é¿å…æ‰‹åŠ¨å†™å¤§é‡-requireinclude">PHP çš„ <strong>SPL autoloader</strong>ï¼ˆStandard PHP Library Autoloadingï¼‰æ˜¯ PHP æä¾›çš„ä¸€å¥—æ ‡å‡†åŒ–ã€å¯æ‰©å±•çš„è‡ªåŠ¨åŠ è½½æœºåˆ¶ï¼Œç”¨äºåœ¨è¿è¡Œæ—¶æŒ‰éœ€åŠ è½½ç±»ã€æ¥å£æˆ– trait æ–‡ä»¶ï¼Œé¿å…æ‰‹åŠ¨å†™å¤§é‡ <code>require</code>/<code>include</code>ã€‚</h1>
<p>å®ƒæ˜¯ç°ä»£ PHP è‡ªåŠ¨åŠ è½½ï¼ˆå¦‚ PSR-4ã€Composerï¼‰çš„åŸºç¡€ã€‚</p>
<hr>
<h2 id="-ä¸€ä»€ä¹ˆæ˜¯-spl-autoloader">ğŸ“Œ ä¸€ã€ä»€ä¹ˆæ˜¯ SPL Autoloaderï¼Ÿ</h2>
<p>SPLï¼ˆStandard PHP Libraryï¼‰ä» PHP 5.1 å¼€å§‹å†…ç½®ï¼Œå…¶ä¸­æœ€å…³é”®çš„åŠŸèƒ½ä¹‹ä¸€å°±æ˜¯ <strong><code>spl_autoload_register()</code></strong> å‡½æ•°ã€‚</p>
<blockquote>
<p>âœ… å®ƒå…è®¸ä½ æ³¨å†Œä¸€ä¸ªæˆ–å¤šä¸ª<strong>è‡ªåŠ¨åŠ è½½å‡½æ•°</strong>ï¼Œå½“ PHP é‡åˆ°æœªå®šä¹‰çš„ç±»æ—¶ï¼Œä¼šä¾æ¬¡è°ƒç”¨è¿™äº›å‡½æ•°å°è¯•åŠ è½½ã€‚</p>
</blockquote>
<hr>
<h2 id="-äºŒæ ¸å¿ƒå‡½æ•°spl_autoload_register">ğŸ”§ äºŒã€æ ¸å¿ƒå‡½æ•°ï¼š<code>spl_autoload_register()</code></h2>
<h3 id="åŸºæœ¬è¯­æ³•">åŸºæœ¬è¯­æ³•ï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">spl_autoload_register</span><span class="p">(</span><span class="nx">callable</span> <span class="nv">$callback</span><span class="p">,</span> <span class="nx">bool</span> <span class="nv">$throw</span> <span class="o">=</span> <span class="k">true</span><span class="p">,</span> <span class="nx">bool</span> <span class="nv">$prepend</span> <span class="o">=</span> <span class="k">false</span><span class="p">)</span><span class="o">:</span> <span class="nx">bool</span>
</span></span></code></pre></div><ul>
<li><code>$callback</code>ï¼šå½“ç±»æœªå®šä¹‰æ—¶è°ƒç”¨çš„å‡½æ•°ï¼ˆå¯ä»¥æ˜¯å‡½æ•°åã€é—­åŒ…ã€é™æ€æ–¹æ³•ç­‰ï¼‰ã€‚</li>
<li><code>$throw</code>ï¼šæ˜¯å¦åœ¨ autoload å¤±è´¥æ—¶æŠ›å‡ºå¼‚å¸¸ï¼ˆé»˜è®¤ <code>true</code>ï¼‰ã€‚</li>
<li><code>$prepend</code>ï¼šæ˜¯å¦å°†æ­¤ loader æ’å…¥é˜Ÿåˆ—<strong>æœ€å‰é¢</strong>ï¼ˆé»˜è®¤åŠ åœ¨æœ«å°¾ï¼‰ã€‚</li>
</ul>
<hr>
<h2 id="-ä¸‰ç®€å•ç¤ºä¾‹">âœ… ä¸‰ã€ç®€å•ç¤ºä¾‹</h2>
<h3 id="ç¤ºä¾‹-1åŸºç¡€è‡ªåŠ¨åŠ è½½å™¨">ç¤ºä¾‹ 1ï¼šåŸºç¡€è‡ªåŠ¨åŠ è½½å™¨</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">// è‡ªåŠ¨åŠ è½½å‡½æ•°
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="k">function</span> <span class="nf">myAutoloader</span><span class="p">(</span><span class="nv">$className</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="c1">// å°†å‘½åç©ºé—´ \ è½¬ä¸ºç›®å½•åˆ†éš”ç¬¦
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="nv">$path</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s1">&#39;\\&#39;</span><span class="p">,</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span> <span class="nv">$className</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s1">&#39;/src/&#39;</span> <span class="o">.</span> <span class="nv">$path</span> <span class="o">.</span> <span class="s1">&#39;.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="k">require_once</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="c1">// æ³¨å†Œ
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">spl_autoload_register</span><span class="p">(</span><span class="s1">&#39;myAutoloader&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1">// ä½¿ç”¨
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="nv">$obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyApp\Controller\User</span><span class="p">();</span> <span class="c1">// è‡ªåŠ¨åŠ è½½ src/MyApp/Controller/User.php
</span></span></span></code></pre></div><hr>
<h3 id="ç¤ºä¾‹-2ä½¿ç”¨é—­åŒ…åŒ¿åå‡½æ•°">ç¤ºä¾‹ 2ï¼šä½¿ç”¨é—­åŒ…ï¼ˆåŒ¿åå‡½æ•°ï¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">spl_autoload_register</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$class</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="s1">&#39;classes/&#39;</span> <span class="o">.</span> <span class="nv">$class</span> <span class="o">.</span> <span class="s1">&#39;.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">        <span class="k">require</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><hr>
<h3 id="ç¤ºä¾‹-3æ³¨å†Œå¤šä¸ªè‡ªåŠ¨åŠ è½½å™¨">ç¤ºä¾‹ 3ï¼šæ³¨å†Œå¤šä¸ªè‡ªåŠ¨åŠ è½½å™¨</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">spl_autoload_register</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$class</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="c1">// å°è¯•ä» lib/ åŠ è½½
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="s2">&#34;lib/</span><span class="si">$class</span><span class="s2">.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">        <span class="k">require</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="nx">spl_autoload_register</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$class</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="c1">// å°è¯•ä» vendor/ åŠ è½½
</span></span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="s2">&#34;vendor/</span><span class="si">$class</span><span class="s2">.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="k">require</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><blockquote>
<p>âš ï¸ æ³¨æ„ï¼šåªè¦<strong>ä»»æ„ä¸€ä¸ª</strong> autoload å‡½æ•°æˆåŠŸåŠ è½½äº†ç±»ï¼Œåç»­çš„å°±ä¸ä¼šå†æ‰§è¡Œã€‚</p>
</blockquote>
<hr>
<h2 id="-å››spl-ä¸-psr-4--composer-çš„å…³ç³»">ğŸ”„ å››ã€SPL ä¸ PSR-4 / Composer çš„å…³ç³»</h2>
<ul>
<li><strong>PSR-4 æ˜¯è§„èŒƒ</strong>ï¼Œè§„å®šäº†â€œå‘½åç©ºé—´å¦‚ä½•æ˜ å°„åˆ°æ–‡ä»¶è·¯å¾„â€ã€‚</li>
<li><strong>SPL æ˜¯å®ç°æœºåˆ¶</strong>ï¼Œæä¾›äº†æ³¨å†Œè‡ªåŠ¨åŠ è½½å‡½æ•°çš„èƒ½åŠ›ã€‚</li>
<li><strong>Composer æ˜¯å·¥å…·</strong>ï¼Œå®ƒæ ¹æ® <code>composer.json</code> ä¸­çš„ PSR-4 é…ç½®ï¼Œ<strong>ç”Ÿæˆä¸€ä¸ªç¬¦åˆ PSR-4 çš„ autoload å‡½æ•°ï¼Œå¹¶é€šè¿‡ <code>spl_autoload_register()</code> æ³¨å†Œå®ƒ</strong>ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼ŒComposer ç”Ÿæˆçš„ <code>vendor/autoload.php</code> å†…éƒ¨å¤§è‡´å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">// ç®€åŒ–ç‰ˆç¤ºæ„
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nx">spl_autoload_register</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$class</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="c1">// æŸ¥æ‰¾ PSR-4 æ˜ å°„
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$psr4Map</span> <span class="k">as</span> <span class="nv">$prefix</span> <span class="o">=&gt;</span> <span class="nv">$dirs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">strpos</span><span class="p">(</span><span class="nv">$class</span><span class="p">,</span> <span class="nv">$prefix</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">            <span class="nv">$relativeClass</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$class</span><span class="p">,</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$prefix</span><span class="p">));</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">            <span class="nv">$path</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s1">&#39;\\&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nv">$relativeClass</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$dirs</span> <span class="k">as</span> <span class="nv">$dir</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$path</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">                    <span class="k">require</span> <span class="nv">$dir</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$path</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">                    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="c1">// å¦‚æœæ²¡æ‰¾åˆ°ï¼Œç»§ç»­å°è¯• classmap...
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><hr>
<h2 id="-äº”å…¶ä»–ç›¸å…³å‡½æ•°">âš™ï¸ äº”ã€å…¶ä»–ç›¸å…³å‡½æ•°</h2>
<table>
  <thead>
      <tr>
          <th>å‡½æ•°</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>spl_autoload_unregister($callback)</code></td>
          <td>æ³¨é”€æŸä¸ªè‡ªåŠ¨åŠ è½½å‡½æ•°</td>
      </tr>
      <tr>
          <td><code>spl_autoload_functions()</code></td>
          <td>è¿”å›å½“å‰æ‰€æœ‰å·²æ³¨å†Œçš„ autoload å‡½æ•°åˆ—è¡¨</td>
      </tr>
      <tr>
          <td><code>spl_autoload_call($class)</code></td>
          <td>æ‰‹åŠ¨è§¦å‘æ‰€æœ‰ autoload å‡½æ•°å»åŠ è½½æŸä¸ªç±»</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-å…­æ³¨æ„äº‹é¡¹">ğŸ›‘ å…­ã€æ³¨æ„äº‹é¡¹</h2>
<ol>
<li>
<p><strong>ä¸è¦æ··ç”¨ <code>__autoload()</code> å’Œ <code>spl_autoload_register()</code></strong></p>
<ul>
<li><code>__autoload()</code> æ˜¯æ—§å¼å• autoload å‡½æ•°ï¼ˆPHP 5.0 å¼•å…¥ï¼‰ã€‚</li>
<li>ä¸€æ—¦ä½¿ç”¨ <code>spl_autoload_register()</code>ï¼Œ<code>__autoload()</code> <strong>ä¼šè¢«å¿½ç•¥</strong>ã€‚</li>
<li><strong>å®˜æ–¹å·²åºŸå¼ƒ <code>__autoload()</code></strong>ï¼Œè¯·å§‹ç»ˆä½¿ç”¨ <code>spl_autoload_register()</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>è‡ªåŠ¨åŠ è½½å‡½æ•°ä¸åº”æŠ›å‡ºå¼‚å¸¸ï¼ˆé™¤éå¿…è¦ï¼‰</strong></p>
<ul>
<li>å¦‚æœ autoload å‡½æ•°æŠ›å¼‚å¸¸ï¼Œä¼šå¯¼è‡´è‡´å‘½é”™è¯¯ã€‚</li>
<li>æ›´å¥½çš„åšæ³•æ˜¯â€œé™é»˜å¤±è´¥â€ï¼Œè®©ä¸‹ä¸€ä¸ª loader å°è¯•ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½å»ºè®®</strong>ï¼š</p>
<ul>
<li>åœ¨ç”Ÿäº§ç¯å¢ƒå¯ç”¨ <strong>OPcache</strong>ï¼Œé¿å…é‡å¤è§£ææ–‡ä»¶ã€‚</li>
<li>å¯¹äºé«˜é¢‘ç±»ï¼Œå¯è€ƒè™‘ä½¿ç”¨ <strong>classmap</strong>ï¼ˆå¦‚ Composer çš„ <code>--optimize-autoloader</code>ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<hr>
<h2 id="-ä¸ƒæœ€ä½³å®è·µ">âœ… ä¸ƒã€æœ€ä½³å®è·µ</h2>
<ul>
<li>ä½¿ç”¨ <strong>Composer + PSR-4</strong>ï¼Œæ— éœ€æ‰‹å†™ autoloadã€‚</li>
<li>è‹¥éœ€è‡ªå®šä¹‰é€»è¾‘ï¼ˆå¦‚æ’ä»¶ç³»ç»Ÿï¼‰ï¼Œå†æ‰‹åŠ¨æ³¨å†Œé¢å¤–çš„ <code>spl_autoload_register()</code>ã€‚</li>
<li>é¿å…åœ¨ autoload å‡½æ•°ä¸­åšå¤æ‚é€»è¾‘ï¼ˆå¦‚æ•°æ®åº“æŸ¥è¯¢ã€è¿œç¨‹è¯·æ±‚ï¼‰ã€‚</li>
</ul>
<hr>
<h2 id="-æ€»ç»“">ğŸ“š æ€»ç»“</h2>
<table>
  <thead>
      <tr>
          <th>æ¦‚å¿µ</th>
          <th>ä½œç”¨</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>SPL Autoloader</strong></td>
          <td>PHP æä¾›çš„è‡ªåŠ¨åŠ è½½æ³¨å†Œæœºåˆ¶ï¼ˆåº•å±‚ï¼‰</td>
      </tr>
      <tr>
          <td><strong>PSR-4</strong></td>
          <td>ç±»ååˆ°æ–‡ä»¶è·¯å¾„çš„æ˜ å°„è§„èŒƒï¼ˆçº¦å®šï¼‰</td>
      </tr>
      <tr>
          <td><strong>Composer</strong></td>
          <td>æ ¹æ® PSR-4 è‡ªåŠ¨ç”Ÿæˆå¹¶æ³¨å†Œç¬¦åˆ SPL çš„ autoload å‡½æ•°ï¼ˆå·¥å…·ï¼‰</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>ğŸ’¡ ç®€å•è¯´ï¼š<strong>SPL æ˜¯â€œå‘åŠ¨æœºâ€ï¼ŒPSR-4 æ˜¯â€œäº¤é€šè§„åˆ™â€ï¼ŒComposer æ˜¯â€œè‡ªåŠ¨é©¾é©¶ç³»ç»Ÿâ€</strong>ã€‚</p>
</blockquote>
<hr>
<h1 id="psr-4-æ˜¯-php-æ ‡å‡†æ¨èphp-standard-recommendationä¸­å…³äº-è‡ªåŠ¨åŠ è½½autoloading-çš„è§„èŒƒç”±-php-figphp-framework-interop-groupåˆ¶å®šå®ƒæ˜¯ç°ä»£-php-å¼€å‘ä¸­æœ€å¹¿æ³›é‡‡ç”¨çš„è‡ªåŠ¨åŠ è½½æ ‡å‡†è¢«-composerlaravelsymfony-ç­‰ä¸»æµæ¡†æ¶å’Œå·¥å…·æ‰€æ”¯æŒ">PSR-4 æ˜¯ PHP æ ‡å‡†æ¨èï¼ˆPHP Standard Recommendationï¼‰ä¸­å…³äº <strong>è‡ªåŠ¨åŠ è½½ï¼ˆAutoloadingï¼‰</strong> çš„è§„èŒƒï¼Œç”± PHP-FIGï¼ˆPHP Framework Interop Groupï¼‰åˆ¶å®šã€‚å®ƒæ˜¯ç°ä»£ PHP å¼€å‘ä¸­æœ€å¹¿æ³›é‡‡ç”¨çš„è‡ªåŠ¨åŠ è½½æ ‡å‡†ï¼Œè¢« Composerã€Laravelã€Symfony ç­‰ä¸»æµæ¡†æ¶å’Œå·¥å…·æ‰€æ”¯æŒã€‚</h1>
<hr>
<h2 id="-ä»€ä¹ˆæ˜¯-psr-4">ğŸ“Œ ä»€ä¹ˆæ˜¯ PSR-4ï¼Ÿ</h2>
<p><strong>PSR-4</strong> å®šä¹‰äº†ä¸€ç§å°† <strong>å‘½åç©ºé—´ï¼ˆnamespaceï¼‰</strong> ä¸ <strong>æ–‡ä»¶ç³»ç»Ÿè·¯å¾„</strong> æ˜ å°„èµ·æ¥çš„è§„åˆ™ï¼Œä½¿å¾— PHP èƒ½å¤Ÿåœ¨éœ€è¦æ—¶è‡ªåŠ¨åŠ è½½å¯¹åº”çš„ç±»æ–‡ä»¶ï¼Œè€Œæ— éœ€æ‰‹åŠ¨ <code>require</code> æˆ– <code>include</code>ã€‚</p>
<blockquote>
<p>âœ… ç›®æ ‡ï¼šå®ç°â€œä¸€ä¸ªç±»ä¸€ä¸ªæ–‡ä»¶â€ï¼Œå¹¶é€šè¿‡å‘½åç©ºé—´ç»“æ„åæ˜ ç›®å½•ç»“æ„ã€‚</p>
</blockquote>
<hr>
<h2 id="-psr-4-æ ¸å¿ƒè§„åˆ™">ğŸ”§ PSR-4 æ ¸å¿ƒè§„åˆ™</h2>
<h3 id="1-å‘½åç©ºé—´å‰ç¼€--åŸºç¡€ç›®å½•æ˜ å°„">1. <strong>å‘½åç©ºé—´å‰ç¼€ â†’ åŸºç¡€ç›®å½•æ˜ å°„</strong></h3>
<p>æ¯ä¸ªå‘½åç©ºé—´å‰ç¼€ï¼ˆå¦‚ <code>MyApp\\</code>ï¼‰å¿…é¡»æ˜ å°„åˆ°ä¸€ä¸ªå…·ä½“çš„æ–‡ä»¶ç³»ç»Ÿç›®å½•ï¼ˆå¦‚ <code>src/</code>ï¼‰ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">// composer.json ä¸­çš„é…ç½®ç¤ºä¾‹
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="nt">&#34;autoload&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">        <span class="nt">&#34;psr-4&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">            <span class="nt">&#34;MyApp\\&#34;</span><span class="p">:</span> <span class="s2">&#34;src/&#34;</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™æ„å‘³ç€ï¼š</p>
<ul>
<li>ç±» <code>MyApp\Controller\UserController</code></li>
<li>å¯¹åº”æ–‡ä»¶è·¯å¾„ï¼š<code>src/Controller/UserController.php</code></li>
</ul>
<h3 id="2-å®Œå…¨é™å®šç±»åfqcn--æ–‡ä»¶è·¯å¾„è½¬æ¢è§„åˆ™">2. <strong>å®Œå…¨é™å®šç±»åï¼ˆFQCNï¼‰ â†’ æ–‡ä»¶è·¯å¾„è½¬æ¢è§„åˆ™</strong></h3>
<p>ç»™å®šä¸€ä¸ªå®Œå…¨é™å®šç±»åï¼ˆFully Qualified Class Nameï¼‰ï¼Œå¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">\MyApp\Controller\Admin\UserManager</span>
</span></span></code></pre></div><p>æŒ‰ç…§ PSR-4 è§„åˆ™ï¼š</p>
<ol>
<li>æ‰¾åˆ°åŒ¹é…çš„å‘½åç©ºé—´å‰ç¼€ï¼ˆè¿™é‡Œæ˜¯ <code>MyApp\</code>ï¼‰ã€‚</li>
<li>å»æ‰å‰ç¼€ï¼Œå‰©ä¸‹ï¼š<code>Controller\Admin\UserManager</code></li>
<li>å°† <code>\</code> æ›¿æ¢ä¸º <code>DIRECTORY_SEPARATOR</code>ï¼ˆå³ <code>/</code> æˆ– <code>\</code>ï¼Œå–å†³äºæ“ä½œç³»ç»Ÿï¼‰</li>
<li>åœ¨åŸºç¡€ç›®å½•åæ‹¼æ¥è·¯å¾„ï¼Œå¹¶åŠ ä¸Š <code>.php</code> åç¼€ï¼š</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">src/Controller/Admin/UserManager.php
</span></span></code></pre></div><blockquote>
<p>âš ï¸ æ³¨æ„ï¼šPSR-4 <strong>ä¸å…³å¿ƒå¤§å°å†™</strong>ï¼Œä½†<strong>å¼ºçƒˆå»ºè®®æ–‡ä»¶åä¸ç±»åå¤§å°å†™ä¸€è‡´</strong>ï¼ˆå°¤å…¶åœ¨ Linux ç³»ç»Ÿä¸ŠåŒºåˆ†å¤§å°å†™ï¼‰ã€‚</p>
</blockquote>
<hr>
<h2 id="-ç›®å½•ç»“æ„ç¤ºä¾‹">ğŸ“ ç›®å½•ç»“æ„ç¤ºä¾‹</h2>
<p>å‡è®¾é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">project/
</span></span><span class="line"><span class="ln">2</span><span class="cl">â”œâ”€â”€ src/
</span></span><span class="line"><span class="ln">3</span><span class="cl">â”‚   â”œâ”€â”€ Model/
</span></span><span class="line"><span class="ln">4</span><span class="cl">â”‚   â”‚   â””â”€â”€ User.php
</span></span><span class="line"><span class="ln">5</span><span class="cl">â”‚   â””â”€â”€ Service/
</span></span><span class="line"><span class="ln">6</span><span class="cl">â”‚       â””â”€â”€ Mailer.php
</span></span><span class="line"><span class="ln">7</span><span class="cl">â””â”€â”€ vendor/
</span></span></code></pre></div><p><code>src/Model/User.php</code> å†…å®¹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="k">namespace</span> <span class="nx">MyApp\Model</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="k">class</span> <span class="nc">User</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><code>composer.json</code> é…ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="nt">&#34;autoload&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">        <span class="nt">&#34;psr-4&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">            <span class="nt">&#34;MyApp\\&#34;</span><span class="p">:</span> <span class="s2">&#34;src/&#34;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿è¡Œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">composer dump-autoload
</span></span></code></pre></div><p>ä¹‹åï¼Œä½ å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">use</span> <span class="nx">MyApp\Model\User</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nv">$user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">();</span> <span class="c1">// è‡ªåŠ¨åŠ è½½ src/Model/User.php
</span></span></span></code></pre></div><hr>
<h2 id="-psr-4-çš„è¦æ±‚å¿…é¡»éµå®ˆ">âœ… PSR-4 çš„è¦æ±‚ï¼ˆå¿…é¡»éµå®ˆï¼‰</h2>
<ol>
<li><strong>ç±»åå¿…é¡»ä¸æ–‡ä»¶åå®Œå…¨ä¸€è‡´</strong>ï¼ˆåŒ…æ‹¬å¤§å°å†™ï¼‰ã€‚</li>
<li><strong>æ–‡ä»¶å¿…é¡»åªåŒ…å«ä¸€ä¸ªç±»</strong>ï¼ˆä¸èƒ½å¤šä¸ªç±»æ··åœ¨ä¸€ä¸ªæ–‡ä»¶ï¼‰ã€‚</li>
<li><strong>å‘½åç©ºé—´å¿…é¡»åæ˜ ç›®å½•ç»“æ„</strong>ã€‚</li>
<li><strong>ä¸èƒ½ä½¿ç”¨ <code>_</code> ä½œä¸ºè·¯å¾„åˆ†éš”ç¬¦</strong>ï¼ˆé‚£æ˜¯ PSR-0 çš„åšæ³•ï¼Œå·²åºŸå¼ƒï¼‰ã€‚</li>
<li><strong>è‡ªåŠ¨åŠ è½½å™¨å¿…é¡»å…¼å®¹ SPL autoloader</strong>ï¼ˆå³é€šè¿‡ <code>spl_autoload_register()</code> æ³¨å†Œï¼‰ã€‚</li>
</ol>
<hr>
<h2 id="-ä¸ç¬¦åˆ-psr-4-çš„ä¾‹å­">âŒ ä¸ç¬¦åˆ PSR-4 çš„ä¾‹å­</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">// æ–‡ä»¶è·¯å¾„: src/user.php
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="k">namespace</span> <span class="nx">MyApp</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="k">class</span> <span class="nc">User</span> <span class="p">{}</span> <span class="c1">// âŒ æ–‡ä»¶å user.php â‰  ç±»å Userï¼ˆå¤§å°å†™ä¸ä¸€è‡´ï¼Œåœ¨ Linux ä¼šå‡ºé”™ï¼‰
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">// æ–‡ä»¶è·¯å¾„: src/Util.php
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="k">namespace</span> <span class="nx">MyApp\Utils</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="k">class</span> <span class="nc">Helper</span> <span class="p">{}</span> <span class="c1">// âŒ ç±»å Helper â‰  æ–‡ä»¶å Util.php
</span></span></span></code></pre></div><hr>
<h2 id="-psr-4-vs-psr-0å†å²å¯¹æ¯”">ğŸ”„ PSR-4 vs PSR-0ï¼ˆå†å²å¯¹æ¯”ï¼‰</h2>
<table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th>PSR-0ï¼ˆå·²åºŸå¼ƒï¼‰</th>
          <th>PSR-4ï¼ˆæ¨èï¼‰</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>æ”¯æŒä¸‹åˆ’çº¿ <code>_</code> è½¬è·¯å¾„</td>
          <td>âœ…</td>
          <td>âŒ</td>
      </tr>
      <tr>
          <td>å‘½åç©ºé—´å¿…é¡»å¯¹åº”å®Œæ•´è·¯å¾„</td>
          <td>âœ…</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td>æ›´ç®€æ´çš„ç›®å½•ç»“æ„</td>
          <td>âŒ</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td>æ”¯æŒæ›´çµæ´»çš„æ ¹ç›®å½•æ˜ å°„</td>
          <td>âŒ</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td>æ˜¯å¦æ¨èä½¿ç”¨</td>
          <td>âŒï¼ˆ2014 å¹´åºŸå¼ƒï¼‰</td>
          <td>âœ…</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>ğŸ’¡ PSR-4 æ˜¯ PSR-0 çš„ç®€åŒ–å’Œç°ä»£åŒ–ç‰ˆæœ¬ï¼Œ<strong>æ–°é¡¹ç›®åº”å§‹ç»ˆä½¿ç”¨ PSR-4</strong>ã€‚</p>
</blockquote>
<hr>
<h2 id="-å®é™…åº”ç”¨composer-å¦‚ä½•å®ç°-psr-4">ğŸ›  å®é™…åº”ç”¨ï¼šComposer å¦‚ä½•å®ç° PSR-4</h2>
<p>å½“ä½ è¿è¡Œ <code>composer dump-autoload</code>ï¼ŒComposer ä¼šæ ¹æ® <code>composer.json</code> ä¸­çš„ <code>psr-4</code> é…ç½®ç”Ÿæˆä¸€ä¸ªè‡ªåŠ¨åŠ è½½å™¨ï¼ˆåœ¨ <code>vendor/composer/autoload_psr4.php</code> ä¸­ï¼‰ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">// vendor/composer/autoload_psr4.php
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="k">return</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="s1">&#39;MyApp\\&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="nv">$baseDir</span> <span class="o">.</span> <span class="s1">&#39;/src&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="p">);</span>
</span></span></code></pre></div><p>ç„¶ååœ¨ <code>autoload.php</code> ä¸­æ³¨å†Œè¯¥åŠ è½½å™¨ã€‚</p>
<hr>
<h2 id="-æœ€ä½³å®è·µ">âœ… æœ€ä½³å®è·µ</h2>
<ol>
<li><strong>å§‹ç»ˆä½¿ç”¨ PSR-4</strong> è¿›è¡Œé¡¹ç›®æˆ–åŒ…çš„è‡ªåŠ¨åŠ è½½é…ç½®ã€‚</li>
<li><strong>å‘½åç©ºé—´ä»¥å‚å•†åå¼€å¤´</strong>ï¼ˆå¦‚ <code>Acme\Blog\</code>ï¼‰ï¼Œé¿å…å†²çªã€‚</li>
<li><strong>ä¿æŒç±»åä¸æ–‡ä»¶åä¸¥æ ¼ä¸€è‡´</strong>ï¼ˆåŒ…æ‹¬å¤§å°å†™ï¼‰ã€‚</li>
<li><strong>ä¸€ä¸ªæ–‡ä»¶åªå®šä¹‰ä¸€ä¸ªç±»</strong>ï¼ˆæˆ– trait/interfaceï¼Œä½†é€šå¸¸ä¹Ÿå•ç‹¬æ–‡ä»¶ï¼‰ã€‚</li>
<li>ä½¿ç”¨ <code>composer validate</code> å’Œ <code>composer dump-autoload</code> ç¡®ä¿é…ç½®æ­£ç¡®ã€‚</li>
</ol>
<hr>
<h1 id="psr-4-å’Œ-psr-0-éƒ½æ˜¯-php-figphp-framework-interop-groupåˆ¶å®šçš„è‡ªåŠ¨åŠ è½½autoloadingè§„èŒƒç”¨äºå°†ç±»åæ˜ å°„åˆ°æ–‡ä»¶è·¯å¾„ä½†-psr-0-å·²äº-2014-å¹´è¢«æ­£å¼åºŸå¼ƒpsr-4-æ˜¯å…¶ç°ä»£åŒ–æ›´ç®€æ´çš„æ›¿ä»£æ–¹æ¡ˆ">PSR-4 å’Œ PSR-0 éƒ½æ˜¯ PHP-FIGï¼ˆPHP Framework Interop Groupï¼‰åˆ¶å®šçš„<strong>è‡ªåŠ¨åŠ è½½ï¼ˆAutoloadingï¼‰è§„èŒƒ</strong>ï¼Œç”¨äºå°†ç±»åæ˜ å°„åˆ°æ–‡ä»¶è·¯å¾„ã€‚ä½† <strong>PSR-0 å·²äº 2014 å¹´è¢«æ­£å¼åºŸå¼ƒ</strong>ï¼Œ<strong>PSR-4 æ˜¯å…¶ç°ä»£åŒ–ã€æ›´ç®€æ´çš„æ›¿ä»£æ–¹æ¡ˆ</strong>ã€‚</h1>
<p>ä»¥ä¸‹æ˜¯ä¸¤è€…çš„å…³é”®åŒºåˆ«ï¼š</p>
<hr>
<h3 id="-1-å¯¹ä¸‹åˆ’çº¿">âœ… 1. <strong>å¯¹ä¸‹åˆ’çº¿ <code>_</code> çš„å¤„ç†</strong></h3>
<table>
  <thead>
      <tr>
          <th>è§„èŒƒ</th>
          <th>æ˜¯å¦æ”¯æŒ <code>_</code> è½¬è·¯å¾„</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>PSR-0</strong></td>
          <td>âœ… æ”¯æŒã€‚ç±»åä¸­çš„ <code>_</code> ä¼šè¢«è½¬æ¢ä¸ºç›®å½•åˆ†éš”ç¬¦ã€‚<br>ä¾‹å¦‚ï¼š<code>Vendor_MyClass</code> â†’ <code>Vendor/MyClass.php</code></td>
      </tr>
      <tr>
          <td><strong>PSR-4</strong></td>
          <td>âŒ <strong>ä¸æ”¯æŒ</strong>ã€‚<code>_</code> è¢«è§†ä¸ºæ™®é€šå­—ç¬¦ï¼Œä¸ä¼šå½±å“è·¯å¾„è§£æã€‚</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>ğŸ“Œ è¿™æ˜¯ PSR-4 æœ€æ˜¾è‘—çš„å˜åŒ–ä¹‹ä¸€ã€‚PSR-0 çš„ <code>_</code> æœºåˆ¶æºäº PHP 5.2 æ—¶ä»£ï¼ˆå‘½åç©ºé—´å°šæœªæ™®åŠï¼‰ï¼Œç°å·²è¿‡æ—¶ã€‚</p>
</blockquote>
<hr>
<h3 id="-2-ç›®å½•ç»“æ„ä¸å‘½åç©ºé—´çš„å…³ç³»">âœ… 2. <strong>ç›®å½•ç»“æ„ä¸å‘½åç©ºé—´çš„å…³ç³»</strong></h3>
<table>
  <thead>
      <tr>
          <th>è§„èŒƒ</th>
          <th>ç›®å½•è¦æ±‚</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>PSR-0</strong></td>
          <td>å‘½åç©ºé—´å¿…é¡»ä»<strong>é¡¹ç›®æ ¹ç›®å½•å¼€å§‹å®Œæ•´æ˜ å°„</strong>ã€‚<br>ä¾‹å¦‚ï¼š<code>Vendor\Package\Class</code> å¿…é¡»ä½äº <code>&lt;base&gt;/Vendor/Package/Class.php</code></td>
      </tr>
      <tr>
          <td><strong>PSR-4</strong></td>
          <td><strong>åªæ˜ å°„å‘½åç©ºé—´å‰ç¼€åˆ°ä»»æ„ç›®å½•</strong>ï¼Œå…¶ä½™éƒ¨åˆ†è‡ªç”±ç»„ç»‡ã€‚<br>ä¾‹å¦‚ï¼š<code>Vendor\Package\Class</code> å¯ä»¥æ”¾åœ¨ <code>src/Class.php</code>ï¼ˆåªè¦ <code>Vendor\Package\</code> æ˜ å°„åˆ° <code>src/</code>ï¼‰</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>ğŸ’¡ PSR-4 æ›´çµæ´»ï¼šä½ å¯ä»¥æŠŠä»£ç æ”¾åœ¨ <code>src/</code>ã€<code>lib/</code>ã€<code>app/</code> ç­‰ä»»æ„ç›®å½•ï¼Œè€Œä¸å¼ºåˆ¶åŒ…å«å‚å•†åä½œä¸ºé¡¶å±‚ç›®å½•ã€‚</p>
</blockquote>
<hr>
<h3 id="-3-æ–‡ä»¶ä½ç½®çµæ´»æ€§">âœ… 3. <strong>æ–‡ä»¶ä½ç½®çµæ´»æ€§</strong></h3>
<ul>
<li>
<p><strong>PSR-0</strong>ï¼š<br>
å¼ºåˆ¶è¦æ±‚ç±»æ–‡ä»¶è·¯å¾„ = å®Œæ•´å‘½åç©ºé—´ + ç±»åã€‚<br>
â†’ é¡¹ç›®ç»“æ„è‡ƒè‚¿ï¼ˆå¦‚ <code>src/Vendor/Package/...</code>ï¼‰ã€‚</p>
</li>
<li>
<p><strong>PSR-4</strong>ï¼š<br>
å…è®¸â€œè·³è¿‡â€å‘½åç©ºé—´å‰ç¼€åçš„å±‚çº§ã€‚<br>
ç¤ºä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">// composer.json
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="s2">&#34;psr-4&#34;</span><span class="err">:</span> <span class="p">{</span> <span class="nt">&#34;Acme\\Blog\\&#34;</span><span class="p">:</span> <span class="s2">&#34;src/&#34;</span> <span class="p">}</span>
</span></span></code></pre></div><p>é‚£ä¹ˆï¼š</p>
<ul>
<li><code>Acme\Blog\Post</code> â†’ <code>src/Post.php</code></li>
<li><code>Acme\Blog\Controller\Home</code> â†’ <code>src/Controller/Home.php</code></li>
</ul>
<p>è€Œ PSR-0 è¦æ±‚ï¼š</p>
<ul>
<li><code>Acme\Blog\Post</code> â†’ <code>src/Acme/Blog/Post.php</code>ï¼ˆå¤šä¸¤å±‚ç›®å½•ï¼‰</li>
</ul>
</li>
</ul>
<hr>
<h3 id="-4-æ˜¯å¦æ”¯æŒéå‘½åç©ºé—´ç±»å…¨å±€ç±»">âœ… 4. <strong>æ˜¯å¦æ”¯æŒéå‘½åç©ºé—´ç±»ï¼ˆå…¨å±€ç±»ï¼‰</strong></h3>
<table>
  <thead>
      <tr>
          <th>è§„èŒƒ</th>
          <th>æ”¯æŒå…¨å±€ç±»ï¼ˆæ— å‘½åç©ºé—´ï¼‰ï¼Ÿ</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>PSR-0</strong></td>
          <td>âœ… æ”¯æŒã€‚å¦‚ <code>MyClass</code> â†’ <code>MyClass.php</code></td>
      </tr>
      <tr>
          <td><strong>PSR-4</strong></td>
          <td>âŒ <strong>ä¸æ”¯æŒ</strong>ã€‚PSR-4 <strong>ä»…é€‚ç”¨äºå‘½åç©ºé—´ç±»</strong>ï¼ˆå¿…é¡»æœ‰ <code>\</code>ï¼‰ã€‚<br>ï¼ˆä½†å¯é€šè¿‡å…¶ä»– autoload æœºåˆ¶å¦‚ <code>classmap</code> åŠ è½½å…¨å±€ç±»ï¼‰</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>âš ï¸ å®é™…å¼€å‘ä¸­ï¼Œç°ä»£ PHP é¡¹ç›®å‡ ä¹éƒ½ä½¿ç”¨å‘½åç©ºé—´ï¼Œå› æ­¤è¿™ä¸æ˜¯å¤§é—®é¢˜ã€‚</p>
</blockquote>
<hr>
<h3 id="-5-æ€§èƒ½ä¸ç®€æ´æ€§">âœ… 5. <strong>æ€§èƒ½ä¸ç®€æ´æ€§</strong></h3>
<ul>
<li><strong>PSR-4</strong> æ›´è½»é‡ã€è·¯å¾„è®¡ç®—æ›´ç®€å•ã€‚</li>
<li><strong>PSR-0</strong> å› æ”¯æŒ <code>_</code> å’Œå®Œæ•´è·¯å¾„æ˜ å°„ï¼Œé€»è¾‘æ›´å¤æ‚ï¼Œå·²æ— å¿…è¦ã€‚</li>
</ul>
<hr>
<h3 id="-å¯¹æ¯”æ€»ç»“è¡¨">ğŸ“Š å¯¹æ¯”æ€»ç»“è¡¨</h3>
<table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th>PSR-0ï¼ˆå·²åºŸå¼ƒï¼‰</th>
          <th>PSR-4ï¼ˆæ¨èï¼‰</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>æ”¯æŒ <code>_</code> è½¬è·¯å¾„</td>
          <td>âœ…</td>
          <td>âŒ</td>
      </tr>
      <tr>
          <td>å‘½åç©ºé—´å¿…é¡»å®Œæ•´æ˜ å°„åˆ°è·¯å¾„</td>
          <td>âœ…ï¼ˆå¼ºåˆ¶ï¼‰</td>
          <td>âŒï¼ˆä»…å‰ç¼€æ˜ å°„ï¼‰</td>
      </tr>
      <tr>
          <td>æ–‡ä»¶å¯æ”¾åœ¨ä»»æ„å­ç›®å½•</td>
          <td>âŒ</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td>æ”¯æŒæ— å‘½åç©ºé—´çš„ç±»</td>
          <td>âœ…</td>
          <td>âŒ</td>
      </tr>
      <tr>
          <td>è·¯å¾„ç»“æ„æ›´ç®€æ´</td>
          <td>âŒ</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td>å½“å‰æ˜¯å¦æ¨èä½¿ç”¨</td>
          <td>âŒ</td>
          <td>âœ…</td>
      </tr>
  </tbody>
</table>
<hr>
<h3 id="-ç¤ºä¾‹å¯¹æ¯”">ğŸ§© ç¤ºä¾‹å¯¹æ¯”</h3>
<p>å‡è®¾ç±»åä¸ºï¼š<code>Acme\Blog\Controller\Article</code></p>
<table>
  <thead>
      <tr>
          <th>è§„èŒƒ</th>
          <th>composer.json é…ç½®</th>
          <th>å¯¹åº”æ–‡ä»¶è·¯å¾„</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>PSR-0</strong></td>
          <td><code>&quot;psr-0&quot;: { &quot;Acme\\&quot;: &quot;src/&quot; }</code></td>
          <td><code>src/Acme/Blog/Controller/Article.php</code></td>
      </tr>
      <tr>
          <td><strong>PSR-4</strong></td>
          <td><code>&quot;psr-4&quot;: { &quot;Acme\\Blog\\&quot;: &quot;src/&quot; }</code></td>
          <td><code>src/Controller/Article.php</code></td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>ğŸ” PSR-4 å°‘äº† <code>Acme/Blog/</code> ä¸¤å±‚ç›®å½•ï¼Œç»“æ„æ›´æ‰å¹³ã€æ¸…æ™°ã€‚</p>
</blockquote>
<hr>
<h3 id="-ç»“è®º">âœ… ç»“è®º</h3>
<ul>
<li><strong>æ–°é¡¹ç›®å¿…é¡»ä½¿ç”¨ PSR-4</strong>ã€‚</li>
<li><strong>ä¸è¦åœ¨æ–°ä»£ç ä¸­ä½¿ç”¨ PSR-0</strong>ã€‚</li>
<li>Composer ä»æ”¯æŒ PSR-0ï¼ˆä¸ºäº†å…¼å®¹æ—§åŒ…ï¼‰ï¼Œä½†å®˜æ–¹æ˜ç¡®å»ºè®®è¿ç§»åˆ° PSR-4ã€‚</li>
</ul>
<hr>
<h1 id="åœ¨-php-çš„è‡ªåŠ¨åŠ è½½æœºåˆ¶ä¸­psr-4-å’Œ-classmap-æ˜¯-composer-æä¾›çš„ä¸¤ç§ä¸»è¦çš„ç±»è‡ªåŠ¨åŠ è½½æ–¹å¼å®ƒä»¬å„æœ‰é€‚ç”¨åœºæ™¯ç†è§£å®ƒä»¬çš„åŒºåˆ«å’Œä½¿ç”¨æ–¹æ³•å¯¹æ„å»ºé«˜æ•ˆå¯ç»´æŠ¤çš„é¡¹ç›®éå¸¸é‡è¦">åœ¨ PHP çš„è‡ªåŠ¨åŠ è½½æœºåˆ¶ä¸­ï¼Œ<strong>PSR-4</strong> å’Œ <strong>classmap</strong> æ˜¯ Composer æä¾›çš„ä¸¤ç§ä¸»è¦çš„ç±»è‡ªåŠ¨åŠ è½½æ–¹å¼ã€‚å®ƒä»¬å„æœ‰é€‚ç”¨åœºæ™¯ï¼Œç†è§£å®ƒä»¬çš„åŒºåˆ«å’Œä½¿ç”¨æ–¹æ³•å¯¹æ„å»ºé«˜æ•ˆã€å¯ç»´æŠ¤çš„é¡¹ç›®éå¸¸é‡è¦ã€‚</h1>
<hr>
<h2 id="-ä¸€åŸºæœ¬æ¦‚å¿µ">ğŸ§© ä¸€ã€åŸºæœ¬æ¦‚å¿µ</h2>
<h3 id="-psr-4æ¨èç”¨äºç°ä»£å‘½åç©ºé—´ç±»">âœ… PSR-4ï¼ˆæ¨èç”¨äºç°ä»£å‘½åç©ºé—´ç±»ï¼‰</h3>
<ul>
<li>åŸºäº <strong>å‘½åç©ºé—´å‰ç¼€ â†’ ç›®å½•è·¯å¾„</strong> çš„æ˜ å°„ã€‚</li>
<li>æ–‡ä»¶åå¿…é¡»ä¸ç±»åä¸€è‡´ï¼ˆå¤§å°å†™æ•æ„Ÿï¼‰ã€‚</li>
<li>ä¸€ä¸ªæ–‡ä»¶é€šå¸¸åªåŒ…å«ä¸€ä¸ªç±»ã€‚</li>
<li><strong>æŒ‰éœ€åŠ è½½</strong>ï¼šåªæœ‰åœ¨ä½¿ç”¨æŸä¸ªç±»æ—¶ï¼Œæ‰å»å¯¹åº”è·¯å¾„æŸ¥æ‰¾æ–‡ä»¶ã€‚</li>
</ul>
<h3 id="-classmapé€‚ç”¨äºä»»æ„-php-æ–‡ä»¶ä¸­çš„ç±»">âœ… classmapï¼ˆé€‚ç”¨äºä»»æ„ PHP æ–‡ä»¶ä¸­çš„ç±»ï¼‰</h3>
<ul>
<li>é€šè¿‡ <strong>æ‰«ææŒ‡å®šç›®å½•æˆ–æ–‡ä»¶</strong>ï¼Œç”Ÿæˆä¸€ä¸ªâ€œç±»å â†’ æ–‡ä»¶è·¯å¾„â€çš„é™æ€æ˜ å°„è¡¨ã€‚</li>
<li>ä¸ä¾èµ–å‘½åç©ºé—´æˆ–æ–‡ä»¶åè§„åˆ™ã€‚</li>
<li>æ”¯æŒï¼š
<ul>
<li>éå‘½åç©ºé—´ç±»ï¼ˆå…¨å±€ç±»ï¼‰</li>
<li>å¤šä¸ªç±»åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­</li>
<li>å‡½æ•°åº“ã€æ—§å¼ PHP æ–‡ä»¶ç­‰</li>
</ul>
</li>
</ul>
<hr>
<h2 id="-äºŒcomposer-ä¸­çš„é…ç½®æ–¹å¼">ğŸ›  äºŒã€Composer ä¸­çš„é…ç½®æ–¹å¼</h2>
<h3 id="1-psr-4-é…ç½®">1. <strong>PSR-4 é…ç½®</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">  <span class="nt">&#34;autoload&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="nt">&#34;psr-4&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">      <span class="nt">&#34;App\\&#34;</span><span class="p">:</span> <span class="s2">&#34;src/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">      <span class="nt">&#34;MyVendor\\MyPackage\\&#34;</span><span class="p">:</span> <span class="s2">&#34;packages/my-package/src/&#34;</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>ç±» <code>App\Controller\User</code> â†’ è‡ªåŠ¨åŠ è½½ <code>src/Controller/User.php</code></p>
</blockquote>
<hr>
<h3 id="2-classmap-é…ç½®">2. <strong>classmap é…ç½®</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">  <span class="nt">&#34;autoload&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="nt">&#34;classmap&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">      <span class="s2">&#34;database/seeds&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">      <span class="s2">&#34;legacy/classes&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">      <span class="s2">&#34;utils/helpers.php&#34;</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>Composer ä¼šæ‰«æè¿™äº›ç›®å½•/æ–‡ä»¶ï¼Œæ‰¾å‡ºæ‰€æœ‰ <code>class</code>ã€<code>interface</code>ã€<code>trait</code>ï¼Œå¹¶è®°å½•å…¶æ‰€åœ¨è·¯å¾„ã€‚</p>
</blockquote>
<hr>
<h2 id="-ä¸‰å·¥ä½œåŸç†å¯¹æ¯”">ğŸ” ä¸‰ã€å·¥ä½œåŸç†å¯¹æ¯”</h2>
<table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th>PSR-4</th>
          <th>classmap</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>åŠ è½½æ–¹å¼</strong></td>
          <td>åŠ¨æ€è®¡ç®—è·¯å¾„ï¼ˆè¿è¡Œæ—¶æ‹¼æ¥ï¼‰</td>
          <td>é™æ€æ˜ å°„ï¼ˆé¢„ç”Ÿæˆæ•°ç»„ï¼‰</td>
      </tr>
      <tr>
          <td><strong>æ˜¯å¦éœ€è¦å‘½åç©ºé—´</strong></td>
          <td>âœ… å¿…é¡»</td>
          <td>âŒ ä¸éœ€è¦</td>
      </tr>
      <tr>
          <td><strong>æ–‡ä»¶åæ˜¯å¦å¿…é¡»åŒ¹é…ç±»å</strong></td>
          <td>âœ… æ˜¯</td>
          <td>âŒ å¦</td>
      </tr>
      <tr>
          <td><strong>æ”¯æŒå¤šä¸ªç±»åœ¨ä¸€ä¸ªæ–‡ä»¶ï¼Ÿ</strong></td>
          <td>âŒï¼ˆä¸æ¨èï¼Œä¸”æ— æ³•æ­£ç¡® autoloadï¼‰</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td><strong>æ€§èƒ½</strong></td>
          <td>é¦–æ¬¡ç•¥æ…¢ï¼ˆéœ€æ–‡ä»¶å­˜åœ¨æ£€æŸ¥ï¼‰ï¼Œä½†å¯ä¼˜åŒ–</td>
          <td>é¦–æ¬¡ç”Ÿæˆæ…¢ï¼Œè¿è¡Œæ—¶æå¿«ï¼ˆç›´æ¥æŸ¥æ•°ç»„ï¼‰</td>
      </tr>
      <tr>
          <td><strong>é€‚ç”¨åœºæ™¯</strong></td>
          <td>ç°ä»£ PSR å…¼å®¹é¡¹ç›®</td>
          <td>æ—§ä»£ç ã€ç¬¬ä¸‰æ–¹åº“ã€è¾…åŠ©ç±»ã€å‡½æ•°æ–‡ä»¶</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-å››å®é™…ç¤ºä¾‹">ğŸ“‚ å››ã€å®é™…ç¤ºä¾‹</h2>
<h3 id="ç¤ºä¾‹-1psr-4æ ‡å‡†ç”¨æ³•">ç¤ºä¾‹ 1ï¼šPSR-4ï¼ˆæ ‡å‡†ç”¨æ³•ï¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">// src/Service/Mailer.php
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="k">namespace</span> <span class="nx">App\Service</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="k">class</span> <span class="nc">Mailer</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">// composer.json
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="s2">&#34;autoload&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="nt">&#34;psr-4&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;App\\&#34;</span><span class="p">:</span> <span class="s2">&#34;src/&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>âœ… ä½¿ç”¨ <code>new App\Service\Mailer()</code> æ—¶è‡ªåŠ¨åŠ è½½ã€‚</p>
<hr>
<h3 id="ç¤ºä¾‹-2classmapå¤„ç†æ—§å¼ä»£ç ">ç¤ºä¾‹ 2ï¼šclassmapï¼ˆå¤„ç†æ—§å¼ä»£ç ï¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">// legacy/UserManager.php
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="k">class</span> <span class="nc">UserManager</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="c1">// æ³¨æ„ï¼šæ²¡æœ‰å‘½åç©ºé—´ï¼
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="k">class</span> <span class="nc">UserValidator</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">    <span class="c1">// åŒä¸€ä¸ªæ–‡ä»¶å¤šä¸ªç±»
</span></span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">// composer.json
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="s2">&#34;autoload&#34;</span><span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="nt">&#34;classmap&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;legacy/&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>âœ… æ‰§è¡Œ <code>composer dump-autoload</code> åï¼Œ<code>UserManager</code> å’Œ <code>UserValidator</code> éƒ½èƒ½è¢«è‡ªåŠ¨åŠ è½½ã€‚</p>
<hr>
<h2 id="-äº”ç”Ÿæˆçš„-autoload-æ–‡ä»¶ä½ç½®">âš™ï¸ äº”ã€ç”Ÿæˆçš„ autoload æ–‡ä»¶ä½ç½®</h2>
<p>è¿è¡Œ <code>composer dump-autoload</code> åï¼š</p>
<ul>
<li>
<p><strong>PSR-4 æ˜ å°„</strong> â†’ <code>vendor/composer/autoload_psr4.php</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">return</span> <span class="p">[</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="s1">&#39;App\\&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="no">__DIR__</span> <span class="o">.</span> <span class="s1">&#39;/../../src/&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="p">];</span>
</span></span></code></pre></div></li>
<li>
<p><strong>classmap æ˜ å°„</strong> â†’ <code>vendor/composer/autoload_classmap.php</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">return</span> <span class="p">[</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="s1">&#39;UserManager&#39;</span> <span class="o">=&gt;</span> <span class="nv">$baseDir</span> <span class="o">.</span> <span class="s1">&#39;/legacy/UserManager.php&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="s1">&#39;UserValidator&#39;</span> <span class="o">=&gt;</span> <span class="nv">$baseDir</span> <span class="o">.</span> <span class="s1">&#39;/legacy/UserManager.php&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="p">];</span>
</span></span></code></pre></div></li>
</ul>
<hr>
<h2 id="-å…­ä½•æ—¶ç”¨å“ªä¸ª">ğŸ”„ å…­ã€ä½•æ—¶ç”¨å“ªä¸ªï¼Ÿ</h2>
<table>
  <thead>
      <tr>
          <th>åœºæ™¯</th>
          <th>æ¨èæ–¹å¼</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>æ–°é¡¹ç›®ã€ä½¿ç”¨å‘½åç©ºé—´</td>
          <td>âœ… <strong>PSR-4</strong></td>
      </tr>
      <tr>
          <td>ç¬¬ä¸‰æ–¹åº“ç¬¦åˆ PSR-4</td>
          <td>âœ… <strong>PSR-4</strong></td>
      </tr>
      <tr>
          <td>æ—§é¡¹ç›®ã€æ— å‘½åç©ºé—´ç±»</td>
          <td>âœ… <strong>classmap</strong></td>
      </tr>
      <tr>
          <td>ä¸€ä¸ªæ–‡ä»¶å«å¤šä¸ªç±»</td>
          <td>âœ… <strong>classmap</strong></td>
      </tr>
      <tr>
          <td>åŠ è½½éç±»æ–‡ä»¶ï¼ˆå¦‚å‡½æ•°åº“ï¼‰</td>
          <td>âŒ ä¸¤è€…éƒ½ä¸è¡Œ â†’ ç”¨ <code>files</code> autoload</td>
      </tr>
      <tr>
          <td>éœ€è¦æè‡´æ€§èƒ½ï¼ˆå¦‚æ¡†æ¶æ ¸å¿ƒç±»ï¼‰</td>
          <td>å¯è€ƒè™‘ <strong>classmap + opcache</strong></td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>ğŸ’¡ å°æŠ€å·§ï¼šä½ å¯ä»¥åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­<strong>åŒæ—¶ä½¿ç”¨ PSR-4 å’Œ classmap</strong>ï¼</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">  <span class="nt">&#34;autoload&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="nt">&#34;psr-4&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;App\\&#34;</span><span class="p">:</span> <span class="s2">&#34;src/&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="nt">&#34;classmap&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;legacy/&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="nt">&#34;files&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;helpers/functions.php&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><hr>
<h2 id="-å¸¸è§è¯¯åŒº">ğŸš« å¸¸è§è¯¯åŒº</h2>
<ol>
<li>
<p><strong>è¯¯ä»¥ä¸º classmap æ¯” PSR-4 â€œæ›´å¿«â€</strong><br>
â†’ åœ¨å¯ç”¨ OPcache åï¼Œä¸¤è€…æ€§èƒ½å·®å¼‚æå°ã€‚PSR-4 æ›´æ¸…æ™°ã€å¯ç»´æŠ¤ã€‚</p>
</li>
<li>
<p><strong>ç”¨ classmap åŠ è½½ç°ä»£å‘½åç©ºé—´ç±»</strong><br>
â†’ ä¸å¿…è¦ï¼Œä¸”å¤±å»â€œçº¦å®šä¼˜äºé…ç½®â€çš„ä¼˜åŠ¿ã€‚</p>
</li>
<li>
<p><strong>ä¿®æ”¹äº† classmap ç›®å½•ä¸­çš„æ–‡ä»¶ä½†æ²¡é‡æ–° dump</strong><br>
â†’ å¿…é¡»è¿è¡Œ <code>composer dump-autoload</code> æ‰èƒ½æ›´æ–°æ˜ å°„ï¼</p>
</li>
</ol>
<hr>
<h2 id="-æ€»ç»“-1">âœ… æ€»ç»“</h2>
<table>
  <thead>
      <tr>
          <th></th>
          <th>PSR-4</th>
          <th>classmap</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>ç°ä»£å¼€å‘é¦–é€‰</strong></td>
          <td>âœ…</td>
          <td>âŒ</td>
      </tr>
      <tr>
          <td><strong>å…¼å®¹æ—§ä»£ç </strong></td>
          <td>âŒ</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td><strong>ç»“æ„æ¸…æ™°</strong></td>
          <td>âœ…</td>
          <td>âŒ</td>
      </tr>
      <tr>
          <td><strong>è‡ªåŠ¨å‘ç°æ–°ç±»</strong></td>
          <td>âœ…ï¼ˆåªè¦è·¯å¾„å¯¹ï¼‰</td>
          <td>âŒï¼ˆéœ€é‡æ–° dumpï¼‰</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>ğŸ“Œ <strong>æœ€ä½³å®è·µ</strong>ï¼šæ–°ä»£ç ç”¨ PSR-4ï¼Œé—ç•™ä»£ç ç”¨ classmapï¼Œä¸¤è€…å…±å­˜æ— å†²çªã€‚</p>
</blockquote>
<hr>
<h1 id="åœ¨-php-ä¸­é—­åŒ…closure-å’Œ-åŒ¿åå‡½æ•°anonymous-function-å¯†åˆ‡ç›¸å…³ä½†æœ‰ç»†å¾®åŒºåˆ«å®ƒä»¬æ˜¯ç°ä»£-php-ç¼–ç¨‹å¦‚å›è°ƒé«˜é˜¶å‡½æ•°ä¾èµ–æ³¨å…¥ç­‰çš„é‡è¦å·¥å…·">åœ¨ PHP ä¸­ï¼Œ<strong>é—­åŒ…ï¼ˆClosureï¼‰</strong> å’Œ <strong>åŒ¿åå‡½æ•°ï¼ˆAnonymous Functionï¼‰</strong> å¯†åˆ‡ç›¸å…³ï¼Œä½†æœ‰ç»†å¾®åŒºåˆ«ã€‚å®ƒä»¬æ˜¯ç°ä»£ PHP ç¼–ç¨‹ï¼ˆå¦‚å›è°ƒã€é«˜é˜¶å‡½æ•°ã€ä¾èµ–æ³¨å…¥ç­‰ï¼‰çš„é‡è¦å·¥å…·ã€‚</h1>
<hr>
<h2 id="-ä¸€åŒ¿åå‡½æ•°-vs-é—­åŒ…å…³ç³»ä¸åŒºåˆ«">âœ… ä¸€ã€åŒ¿åå‡½æ•° vs é—­åŒ…ï¼šå…³ç³»ä¸åŒºåˆ«</h2>
<h3 id="1-åŒ¿åå‡½æ•°anonymous-function">1. <strong>åŒ¿åå‡½æ•°ï¼ˆAnonymous Functionï¼‰</strong></h3>
<ul>
<li>æ˜¯<strong>æ²¡æœ‰åå­—çš„å‡½æ•°</strong>ï¼Œé€šå¸¸èµ‹å€¼ç»™å˜é‡æˆ–ç›´æ¥ä½œä¸ºå‚æ•°ä¼ é€’ã€‚</li>
<li>ä½¿ç”¨ <code>function () { ... }</code> è¯­æ³•å®šä¹‰ã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">$greet</span> <span class="o">=</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="k">return</span> <span class="s2">&#34;Hello, </span><span class="si">$name</span><span class="s2">!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="k">echo</span> <span class="nv">$greet</span><span class="p">(</span><span class="s2">&#34;Alice&#34;</span><span class="p">);</span> <span class="c1">// Hello, Alice!
</span></span></span></code></pre></div><blockquote>
<p>âœ… æ‰€æœ‰åŒ¿åå‡½æ•°åœ¨ PHP ä¸­éƒ½æ˜¯ <strong><code>Closure</code> ç±»çš„å®ä¾‹</strong>ã€‚</p>
</blockquote>
<hr>
<h3 id="2-é—­åŒ…closure">2. <strong>é—­åŒ…ï¼ˆClosureï¼‰</strong></h3>
<ul>
<li><strong>é—­åŒ… = åŒ¿åå‡½æ•° + èƒ½æ•è·å¤–éƒ¨ä½œç”¨åŸŸå˜é‡çš„èƒ½åŠ›</strong></li>
<li>åœ¨ PHP ä¸­ï¼Œ<strong>åªè¦åŒ¿åå‡½æ•°ä½¿ç”¨äº† <code>use</code> å…³é”®å­—å¼•å…¥å¤–éƒ¨å˜é‡ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªâ€œé—­åŒ…â€</strong>ã€‚</li>
<li>å³ä½¿æ²¡ç”¨ <code>use</code>ï¼ŒPHP ä¹ŸæŠŠåŒ¿åå‡½æ•°å½“ä½œ <code>Closure</code> å¯¹è±¡å¤„ç†ã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">$message</span> <span class="o">=</span> <span class="s2">&#34;Hi&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="c1">// è¿™æ˜¯ä¸€ä¸ªé—­åŒ…ï¼ˆå› ä¸ºå®ƒé€šè¿‡ use æ•è·äº† $messageï¼‰
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="nv">$closure</span> <span class="o">=</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$message</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="k">return</span> <span class="s2">&#34;</span><span class="si">$message</span><span class="s2">, </span><span class="si">$name</span><span class="s2">!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="k">echo</span> <span class="nv">$closure</span><span class="p">(</span><span class="s2">&#34;Bob&#34;</span><span class="p">);</span> <span class="c1">// Hi, Bob!
</span></span></span></code></pre></div><blockquote>
<p>ğŸ“Œ <strong>ç®€å•è¯´ï¼šåœ¨ PHP ä¸­ï¼Œâ€œåŒ¿åå‡½æ•°â€å’Œâ€œé—­åŒ…â€åŸºæœ¬å¯ä»¥äº’æ¢ä½¿ç”¨ï¼Œä½†ä¸¥æ ¼æ¥è¯´ï¼š</strong></p>
<ul>
<li>æ‰€æœ‰é—­åŒ…éƒ½æ˜¯åŒ¿åå‡½æ•°ï¼›</li>
<li>ä¸ä½¿ç”¨å¤–éƒ¨å˜é‡çš„åŒ¿åå‡½æ•° technically ä¸æ˜¯â€œé—­åŒ…â€ï¼ˆä½†åœ¨ PHP ä¸­ä»å« Closureï¼‰ã€‚</li>
</ul>
</blockquote>
<hr>
<h2 id="-äºŒuse-å…³é”®å­—æ•è·å¤–éƒ¨å˜é‡">âœ… äºŒã€<code>use</code> å…³é”®å­—ï¼šæ•è·å¤–éƒ¨å˜é‡</h2>
<p><code>use</code> å…è®¸åŒ¿åå‡½æ•°<strong>è®¿é—®å…¶å®šä¹‰ä½œç”¨åŸŸä¹‹å¤–çš„å˜é‡</strong>ã€‚</p>
<h3 id="åŸºæœ¬è¯­æ³•-1">åŸºæœ¬è¯­æ³•ï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$var1</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$var2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="1-é»˜è®¤æ˜¯å€¼ä¼ é€’æ‹·è´">1. <strong>é»˜è®¤æ˜¯å€¼ä¼ é€’ï¼ˆæ‹·è´ï¼‰</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">$prefix</span> <span class="o">=</span> <span class="s2">&#34;Mr.&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="nv">$greet</span> <span class="o">=</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$prefix</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="k">return</span> <span class="s2">&#34;</span><span class="si">$prefix</span><span class="s2"> </span><span class="si">$name</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="nv">$prefix</span> <span class="o">=</span> <span class="s2">&#34;Ms.&#34;</span><span class="p">;</span> <span class="c1">// ä¿®æ”¹å¤–éƒ¨å˜é‡
</span></span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="k">echo</span> <span class="nv">$greet</span><span class="p">(</span><span class="s2">&#34;Alice&#34;</span><span class="p">);</span> <span class="c1">// è¾“å‡º: Mr. Alice ï¼ˆå› ä¸ºæ˜¯æ‹·è´ï¼‰
</span></span></span></code></pre></div><blockquote>
<p>â— <code>use ($x)</code> æ˜¯<strong>ä¼ å€¼</strong>ï¼Œå‡½æ•°å†…éƒ¨çš„ <code>$x</code> æ˜¯å¤–éƒ¨å˜é‡çš„å‰¯æœ¬ã€‚</p>
</blockquote>
<hr>
<h3 id="2-å¼•ç”¨ä¼ é€’ç”¨">2. <strong>å¼•ç”¨ä¼ é€’ï¼šç”¨ <code>&amp;</code> å®ç°åŒå‘ç»‘å®š</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">$count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="nv">$increment</span> <span class="o">=</span> <span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="o">&amp;</span><span class="nv">$count</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="nv">$count</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="nv">$increment</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="k">echo</span> <span class="nv">$count</span><span class="p">;</span> <span class="c1">// è¾“å‡º: 1
</span></span></span></code></pre></div><blockquote>
<p>âœ… <code>use (&amp;$var)</code> è®©é—­åŒ…èƒ½<strong>ä¿®æ”¹å¤–éƒ¨å˜é‡</strong>ã€‚</p>
</blockquote>
<hr>
<h3 id="3-å¯ä»¥åŒæ—¶ä¼ å¤šä¸ªå˜é‡">3. <strong>å¯ä»¥åŒæ—¶ä¼ å¤šä¸ªå˜é‡</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nv">$name</span> <span class="o">=</span> <span class="s2">&#34;Alice&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nv">$age</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nv">$show</span> <span class="o">=</span> <span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$age</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="nv">$age</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">return</span> <span class="s2">&#34;</span><span class="si">$name</span><span class="s2"> is </span><span class="si">$age</span><span class="s2"> years old.&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">echo</span> <span class="nv">$show</span><span class="p">();</span> <span class="c1">// Alice is 31 years old.
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="k">echo</span> <span class="nv">$age</span><span class="p">;</span>    <span class="c1">// 31
</span></span></span></code></pre></div><hr>
<h2 id="-ä¸‰é—­åŒ…çš„ç±»å‹closure-å¯¹è±¡">âœ… ä¸‰ã€é—­åŒ…çš„ç±»å‹ï¼š<code>Closure</code> å¯¹è±¡</h2>
<p>PHP ä¸­çš„åŒ¿åå‡½æ•°æ˜¯ä¸€ä¸ª <strong><code>Closure</code> ç±»çš„å®ä¾‹</strong>ï¼Œä½ å¯ä»¥ï¼š</p>
<h3 id="1-æ£€æŸ¥ç±»å‹">1. æ£€æŸ¥ç±»å‹</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">$fn</span> <span class="o">=</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{};</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nv">$fn</span> <span class="nx">instanceof</span> <span class="nx">Closure</span><span class="p">);</span> <span class="c1">// bool(true)
</span></span></span></code></pre></div><h3 id="2-ä½¿ç”¨-closurebind-æ”¹å˜ä½œç”¨åŸŸé«˜çº§ç”¨æ³•">2. ä½¿ç”¨ <code>Closure::bind()</code> æ”¹å˜ä½œç”¨åŸŸï¼ˆé«˜çº§ç”¨æ³•ï¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">class</span> <span class="nc">MyClass</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">private</span> <span class="nv">$secret</span> <span class="o">=</span> <span class="s1">&#39;hidden&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nv">$closure</span> <span class="o">=</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">secret</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="nv">$obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="nv">$bound</span> <span class="o">=</span> <span class="nx">Closure</span><span class="o">::</span><span class="na">bind</span><span class="p">(</span><span class="nv">$closure</span><span class="p">,</span> <span class="nv">$obj</span><span class="p">,</span> <span class="nv">$obj</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="k">echo</span> <span class="nv">$bound</span><span class="p">();</span> <span class="c1">// è¾“å‡º: hidden
</span></span></span></code></pre></div><blockquote>
<p>è¿™åœ¨å®ç°ä¾èµ–æ³¨å…¥ã€æµ‹è¯•ç§æœ‰å±æ€§ç­‰åœºæ™¯æœ‰ç”¨ã€‚</p>
</blockquote>
<hr>
<h2 id="-å››å¸¸è§ä½¿ç”¨åœºæ™¯">âœ… å››ã€å¸¸è§ä½¿ç”¨åœºæ™¯</h2>
<table>
  <thead>
      <tr>
          <th>åœºæ™¯</th>
          <th>ç¤ºä¾‹</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>æ•°ç»„å›è°ƒ</strong></td>
          <td><code>array_map(function ($n) { return $n * 2; }, $arr);</code></td>
      </tr>
      <tr>
          <td><strong>äº‹ä»¶å¤„ç†</strong></td>
          <td><code>$emitter-&gt;on('event', function ($data) use ($logger) { ... });</code></td>
      </tr>
      <tr>
          <td><strong>å»¶è¿Ÿè®¡ç®—</strong></td>
          <td>è¿”å›ä¸€ä¸ªé—­åŒ…ä¾›åç»­è°ƒç”¨</td>
      </tr>
      <tr>
          <td><strong>ä¾èµ–æ³¨å…¥å®¹å™¨</strong></td>
          <td>ç”¨é—­åŒ…å®šä¹‰æœåŠ¡åˆ›å»ºé€»è¾‘</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-äº”æ³¨æ„äº‹é¡¹">âš ï¸ äº”ã€æ³¨æ„äº‹é¡¹</h2>
<ol>
<li>
<p><strong><code>use</code> åªåœ¨å®šä¹‰æ—¶æ•è·å˜é‡å€¼</strong><br>
å¾ªç¯ä¸­åˆ›å»ºé—­åŒ…è¦ç‰¹åˆ«å°å¿ƒï¼š</p>
<p>âœ… æ­£ç¡®åšæ³•ï¼ˆPHP 7.0+ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">$funcs</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="nv">$funcs</span><span class="p">[]</span> <span class="o">=</span> <span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$i</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$i</span><span class="p">;</span> <span class="p">};</span> <span class="c1">// æ¯æ¬¡å¾ªç¯ $i è¢«æ‹·è´
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="c1">// ä½†å¦‚æœåœ¨å¾ªç¯å¤–ä¿®æ”¹ $iï¼Œä¸å½±å“é—­åŒ…å†…å€¼ï¼ˆå› ä¸ºæ˜¯æ‹·è´ï¼‰
</span></span></span></code></pre></div></li>
<li>
<p><strong>é¿å…å†…å­˜æ³„æ¼</strong><br>
é—­åŒ…æŒæœ‰å¯¹è±¡å¼•ç”¨æ—¶ï¼Œå¯èƒ½é˜»æ­¢åƒåœ¾å›æ”¶ï¼ˆå°¤å…¶åœ¨é•¿ç”Ÿå‘½å‘¨æœŸåº”ç”¨ä¸­ï¼‰ã€‚</p>
</li>
</ol>
<hr>
<h2 id="-æ€»ç»“-2">âœ… æ€»ç»“</h2>
<table>
  <thead>
      <tr>
          <th>æ¦‚å¿µ</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>åŒ¿åå‡½æ•°</strong></td>
          <td>æ²¡æœ‰åå­—çš„å‡½æ•°ï¼Œ<code>function() { }</code></td>
      </tr>
      <tr>
          <td><strong>é—­åŒ…</strong></td>
          <td>èƒ½æ•è·å¤–éƒ¨å˜é‡çš„åŒ¿åå‡½æ•°ï¼ˆé€šè¿‡ <code>use</code>ï¼‰</td>
      </tr>
      <tr>
          <td><strong><code>use</code></strong></td>
          <td>å¼•å…¥å¤–éƒ¨å˜é‡ï¼Œé»˜è®¤<strong>ä¼ å€¼</strong>ï¼ŒåŠ  <code>&amp;</code> å¯<strong>ä¼ å¼•ç”¨</strong></td>
      </tr>
      <tr>
          <td><strong>æœ¬è´¨</strong></td>
          <td>æ‰€æœ‰åŒ¿åå‡½æ•°éƒ½æ˜¯ <code>Closure</code> å¯¹è±¡</td>
      </tr>
      <tr>
          <td><strong>ç”¨é€”</strong></td>
          <td>å›è°ƒã€ä½œç”¨åŸŸå°è£…ã€å»¶è¿Ÿæ‰§è¡Œã€ä¾èµ–æ³¨å…¥ç­‰</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>ğŸ’¡ <strong>è®°ä½</strong>ï¼š</p>
<ul>
<li><code>use ($x)</code> â†’ æ‹·è´ä¸€ä»½ <code>$x</code></li>
<li><code>use (&amp;$x)</code> â†’ å’Œå¤–éƒ¨ <code>$x</code> å…±äº«åŒä¸€ä¸ªå€¼</li>
</ul>
</blockquote>
<h1 id="åœ¨-php-ä¸­traitç‰¹æ€§-æ˜¯ä¸€ç§ä»£ç å¤ç”¨æœºåˆ¶ç”¨äºåœ¨å•ç»§æ‰¿è¯­è¨€ä¸­å®ç°å¤šç»§æ‰¿é£æ ¼çš„åŠŸèƒ½å…±äº«å®ƒä»-php-54-å¼€å§‹å¼•å…¥æ˜¯ç°ä»£-php-é¢å‘å¯¹è±¡ç¼–ç¨‹oopçš„é‡è¦ç»„æˆéƒ¨åˆ†">åœ¨ PHP ä¸­ï¼Œ<strong>Traitï¼ˆç‰¹æ€§ï¼‰</strong> æ˜¯ä¸€ç§<strong>ä»£ç å¤ç”¨æœºåˆ¶</strong>ï¼Œç”¨äºåœ¨<strong>å•ç»§æ‰¿è¯­è¨€ä¸­å®ç°â€œå¤šç»§æ‰¿â€é£æ ¼çš„åŠŸèƒ½å…±äº«</strong>ã€‚å®ƒä» <strong>PHP 5.4</strong> å¼€å§‹å¼•å…¥ï¼Œæ˜¯ç°ä»£ PHP é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚</h1>
<hr>
<h2 id="-ä¸€ä¸ºä»€ä¹ˆéœ€è¦-trait">ğŸ¯ ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ Traitï¼Ÿ</h2>
<p>PHP åªæ”¯æŒ<strong>å•ç»§æ‰¿</strong>ï¼ˆä¸€ä¸ªç±»åªèƒ½ <code>extends</code> ä¸€ä¸ªçˆ¶ç±»ï¼‰ï¼Œä½†æœ‰æ—¶ä½ å¸Œæœ›å¤šä¸ªä¸ç›¸å…³çš„ç±»å…±äº«åŒä¸€æ®µé€»è¾‘ï¼ˆå¦‚æ—¥å¿—è®°å½•ã€ç¼“å­˜ã€éªŒè¯ç­‰ï¼‰ã€‚</p>
<ul>
<li><strong>æ¥å£ï¼ˆInterfaceï¼‰</strong> åªèƒ½å®šä¹‰æ–¹æ³•ç­¾åï¼Œä¸èƒ½æä¾›å®ç°ã€‚</li>
<li><strong>æŠ½è±¡ç±»ï¼ˆAbstract Classï¼‰</strong> è™½å¯æä¾›å®ç°ï¼Œä½†å—å•ç»§æ‰¿é™åˆ¶ã€‚</li>
<li><strong>Trait</strong> æ­£å¥½å¡«è¡¥ç©ºç™½ï¼š<strong>æä¾›å¯å¤ç”¨çš„æ–¹æ³•å®ç°ï¼Œä¸”å¯è¢«å¤šä¸ªç±»â€œç»„åˆâ€ä½¿ç”¨</strong>ã€‚</li>
</ul>
<blockquote>
<p>ğŸ’¡ Trait ä¸æ˜¯ç±»ï¼Œä¸æ˜¯æ¥å£ï¼Œè€Œæ˜¯ä¸€ç§â€œæ°´å¹³å¤ç”¨â€ï¼ˆHorizontal Reuseï¼‰çš„è¯­æ³•ç»“æ„ã€‚</p>
</blockquote>
<hr>
<h2 id="-äºŒåŸºæœ¬è¯­æ³•">ğŸ”§ äºŒã€åŸºæœ¬è¯­æ³•</h2>
<h3 id="1-å®šä¹‰-trait">1. å®šä¹‰ Trait</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">trait</span> <span class="nx">Loggable</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">log</span><span class="p">(</span><span class="nv">$message</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;[LOG] &#34;</span> <span class="o">.</span> <span class="nv">$message</span> <span class="o">.</span> <span class="nx">PHP_EOL</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="2-åœ¨ç±»ä¸­ä½¿ç”¨-trait">2. åœ¨ç±»ä¸­ä½¿ç”¨ Trait</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">class</span> <span class="nc">User</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">use</span> <span class="nx">Loggable</span><span class="p">;</span> <span class="c1">// å¼•å…¥ Trait
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">register</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s2">&#34;User registered&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="nv">$user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">register</span><span class="p">();</span> <span class="c1">// è¾“å‡º: [LOG] User registered
</span></span></span></code></pre></div><hr>
<h2 id="-ä¸‰trait-çš„æ ¸å¿ƒç‰¹æ€§">ğŸ”„ ä¸‰ã€Trait çš„æ ¸å¿ƒç‰¹æ€§</h2>
<h3 id="-1-ä¸€ä¸ªç±»å¯ä»¥ä½¿ç”¨å¤šä¸ª-trait">âœ… 1. <strong>ä¸€ä¸ªç±»å¯ä»¥ä½¿ç”¨å¤šä¸ª Trait</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">trait</span> <span class="nx">Loggable</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">log</span><span class="p">(</span><span class="nv">$msg</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&#34;Log: </span><span class="si">$msg\n</span><span class="s2">&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">trait</span> <span class="nx">Timestampable</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">now</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">class</span> <span class="nc">Order</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">use</span> <span class="nx">Loggable</span><span class="p">,</span> <span class="nx">Timestampable</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">place</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s2">&#34;Order placed at &#34;</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">now</span><span class="p">());</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><hr>
<h3 id="-2-trait-å¯åŒ…å«å±æ€§æ–¹æ³•é™æ€æˆå‘˜">âœ… 2. <strong>Trait å¯åŒ…å«å±æ€§ã€æ–¹æ³•ã€é™æ€æˆå‘˜</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">trait</span> <span class="nx">Configurable</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">private</span> <span class="nv">$config</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">setConfig</span><span class="p">(</span><span class="k">array</span> <span class="nv">$config</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">config</span> <span class="o">=</span> <span class="nv">$config</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="k">protected</span> <span class="k">function</span> <span class="nf">getConfig</span><span class="p">(</span><span class="nv">$key</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">config</span><span class="p">[</span><span class="nv">$key</span><span class="p">]</span> <span class="o">??</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">version</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="k">return</span> <span class="s1">&#39;1.0&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>âš ï¸ æ³¨æ„ï¼šå¦‚æœå¤šä¸ª Trait å®šä¹‰äº†åŒåå±æ€§ï¼Œä¼šæŠ¥è‡´å‘½é”™è¯¯ã€‚</p>
</blockquote>
<hr>
<h3 id="-3-è§£å†³æ–¹æ³•å†²çª">âœ… 3. <strong>è§£å†³æ–¹æ³•å†²çªï¼š<code>insteadof</code> å’Œ <code>as</code></strong></h3>
<p>å½“å¤šä¸ª Trait æœ‰åŒåæ–¹æ³•æ—¶ï¼Œå¿…é¡»æ˜¾å¼è§£å†³å†²çªï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">trait</span> <span class="nx">A</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">say</span><span class="p">()</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&#34;A&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">trait</span> <span class="nx">B</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">say</span><span class="p">()</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&#34;B&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">class</span> <span class="nc">MyClass</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">use</span> <span class="nx">A</span><span class="p">,</span> <span class="nx">B</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="nx">B</span><span class="o">::</span><span class="na">say</span> <span class="nx">insteadof</span> <span class="nx">A</span><span class="p">;</span>   <span class="c1">// ä½¿ç”¨ B çš„ sayï¼Œå¿½ç•¥ A çš„
</span></span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="nx">A</span><span class="o">::</span><span class="na">say</span> <span class="k">as</span> <span class="nx">sayA</span><span class="p">;</span>       <span class="c1">// ç»™ A çš„ say èµ·åˆ«å
</span></span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="nv">$obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="nv">$obj</span><span class="o">-&gt;</span><span class="na">say</span><span class="p">();</span>  <span class="c1">// è¾“å‡º: B
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="nv">$obj</span><span class="o">-&gt;</span><span class="na">sayA</span><span class="p">();</span> <span class="c1">// è¾“å‡º: A
</span></span></span></code></pre></div><hr>
<h3 id="-4-ä¿®æ”¹-trait-æ–¹æ³•çš„è®¿é—®æƒé™">âœ… 4. <strong>ä¿®æ”¹ Trait æ–¹æ³•çš„è®¿é—®æƒé™</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">class</span> <span class="nc">MyClass</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="k">use</span> <span class="nx">A</span><span class="p">,</span> <span class="nx">B</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">        <span class="nx">A</span><span class="o">::</span><span class="na">say</span> <span class="k">as</span> <span class="k">protected</span><span class="p">;</span>     <span class="c1">// å°† say æ”¹ä¸º protected
</span></span></span><span class="line"><span class="ln">4</span><span class="cl">        <span class="nx">B</span><span class="o">::</span><span class="na">say</span> <span class="k">as</span> <span class="k">private</span> <span class="nx">sayB</span><span class="p">;</span>  <span class="c1">// æ”¹ä¸º private å¹¶é‡å‘½å
</span></span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><hr>
<h3 id="-5-trait-å¯ä»¥åµŒå¥—ä½¿ç”¨trait-ä¸­ä½¿ç”¨å…¶ä»–-trait">âœ… 5. <strong>Trait å¯ä»¥åµŒå¥—ä½¿ç”¨ï¼ˆTrait ä¸­ä½¿ç”¨å…¶ä»– Traitï¼‰</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">trait</span> <span class="nx">Hello</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">sayHello</span><span class="p">()</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&#34;Hello&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">trait</span> <span class="nx">HelloWorld</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">use</span> <span class="nx">Hello</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">sayWorld</span><span class="p">()</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&#34; World&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="k">class</span> <span class="nc">Greeting</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">use</span> <span class="nx">HelloWorld</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nv">$g</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Greeting</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nv">$g</span><span class="o">-&gt;</span><span class="na">sayHello</span><span class="p">();</span> <span class="c1">// Hello
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="nv">$g</span><span class="o">-&gt;</span><span class="na">sayWorld</span><span class="p">();</span> <span class="c1">// World
</span></span></span></code></pre></div><hr>
<h2 id="-å››trait-vs-ç»§æ‰¿-vs-æ¥å£">âš–ï¸ å››ã€Trait vs ç»§æ‰¿ vs æ¥å£</h2>
<table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th>ç»§æ‰¿ï¼ˆ<code>extends</code>ï¼‰</th>
          <th>æ¥å£ï¼ˆ<code>implements</code>ï¼‰</th>
          <th>Traitï¼ˆ<code>use</code>ï¼‰</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>ä»£ç å¤ç”¨</strong></td>
          <td>âœ…ï¼ˆæ¥è‡ªçˆ¶ç±»ï¼‰</td>
          <td>âŒï¼ˆåªæœ‰ç­¾åï¼‰</td>
          <td>âœ…ï¼ˆå®Œæ•´å®ç°ï¼‰</td>
      </tr>
      <tr>
          <td><strong>å¤šç»§æ‰¿</strong></td>
          <td>âŒï¼ˆä»…å•ç»§æ‰¿ï¼‰</td>
          <td>âœ…ï¼ˆå¯å¤šå®ç°ï¼‰</td>
          <td>âœ…ï¼ˆå¯å¤š useï¼‰</td>
      </tr>
      <tr>
          <td><strong>åŒ…å«å±æ€§</strong></td>
          <td>âœ…</td>
          <td>âŒ</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td><strong>åŒ…å«æ–¹æ³•å®ç°</strong></td>
          <td>âœ…</td>
          <td>âŒ</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td><strong>è¯­ä¹‰</strong></td>
          <td>â€œæ˜¯ä¸€ä¸ªâ€ï¼ˆis-aï¼‰</td>
          <td>â€œèƒ½åšâ€ï¼ˆcan-doï¼‰</td>
          <td>â€œæ‹¥æœ‰è¡Œä¸ºâ€ï¼ˆhas-behaviorï¼‰</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>ğŸ“Œ <strong>æœ€ä½³å®è·µ</strong>ï¼š</p>
<ul>
<li>ç”¨ <strong>ç»§æ‰¿</strong> è¡¨è¾¾â€œç±»å‹å…³ç³»â€ï¼ˆå¦‚ <code>Dog extends Animal</code>ï¼‰</li>
<li>ç”¨ <strong>æ¥å£</strong> å®šä¹‰å¥‘çº¦ï¼ˆå¦‚ <code>LoggerInterface</code>ï¼‰</li>
<li>ç”¨ <strong>Trait</strong> å¤ç”¨é€šç”¨åŠŸèƒ½ï¼ˆå¦‚ <code>Loggable</code>, <code>Cacheable</code>ï¼‰</li>
</ul>
</blockquote>
<hr>
<h2 id="-äº”æ³¨æ„äº‹é¡¹ä¸é™·é˜±">âš ï¸ äº”ã€æ³¨æ„äº‹é¡¹ä¸é™·é˜±</h2>
<h3 id="1-trait-ä¸æ˜¯ç±»ä¸èƒ½å®ä¾‹åŒ–">1. <strong>Trait ä¸æ˜¯ç±»ï¼Œä¸èƒ½å®ä¾‹åŒ–</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">new</span> <span class="nx">Loggable</span><span class="p">();</span> <span class="c1">// âŒ Fatal error
</span></span></span></code></pre></div><h3 id="2-ä¼˜å…ˆçº§é¡ºåºå½“å‰ç±»--trait--çˆ¶ç±»">2. <strong>ä¼˜å…ˆçº§é¡ºåºï¼šå½“å‰ç±» &gt; Trait &gt; çˆ¶ç±»</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">class</span> <span class="nc">ParentClass</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">say</span><span class="p">()</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&#34;Parent&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">trait</span> <span class="nx">MyTrait</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">say</span><span class="p">()</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&#34;Trait&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">class</span> <span class="nc">Child</span> <span class="k">extends</span> <span class="nx">ParentClass</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">use</span> <span class="nx">MyTrait</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="c1">// public function say() { echo &#34;Child&#34;; } // å¦‚æœå–æ¶ˆæ³¨é‡Šï¼Œåˆ™ Child ä¼˜å…ˆ
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="p">(</span><span class="k">new</span> <span class="nx">Child</span><span class="p">())</span><span class="o">-&gt;</span><span class="na">say</span><span class="p">();</span> <span class="c1">// è¾“å‡º: Traitï¼ˆTrait è¦†ç›–çˆ¶ç±»ï¼‰
</span></span></span></code></pre></div><h3 id="3-é¿å…è¿‡åº¦ä½¿ç”¨-trait">3. <strong>é¿å…è¿‡åº¦ä½¿ç”¨ Trait</strong></h3>
<ul>
<li>Trait ä¼šè®©ä»£ç è€¦åˆå˜éšå¼ï¼Œéš¾ä»¥è¿½è¸ªæ–¹æ³•æ¥æºã€‚</li>
<li>ä¼˜å…ˆè€ƒè™‘ç»„åˆï¼ˆCompositionï¼‰æˆ–æ¥å£ + ä¾èµ–æ³¨å…¥ã€‚</li>
</ul>
<h3 id="4-æ— æ³•å¼ºåˆ¶ç±»å‹çº¦æŸ-trait">4. <strong>æ— æ³•å¼ºåˆ¶ç±»å‹çº¦æŸ Trait</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">function</span> <span class="nf">process</span><span class="p">(</span><span class="nx">Loggable</span> <span class="nv">$obj</span><span class="p">)</span> <span class="p">{}</span> <span class="c1">// âŒ é”™è¯¯ï¼Trait ä¸èƒ½ä½œä¸ºç±»å‹æç¤º
</span></span></span></code></pre></div><p>âœ… æ­£ç¡®åšæ³•ï¼šé…åˆæ¥å£ä½¿ç”¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">interface</span> <span class="nx">LoggableInterface</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">log</span><span class="p">(</span><span class="nv">$msg</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">trait</span> <span class="nx">Loggable</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">log</span><span class="p">(</span><span class="nv">$msg</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* å®ç° */</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">class</span> <span class="nc">User</span> <span class="k">implements</span> <span class="nx">LoggableInterface</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">use</span> <span class="nx">Loggable</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">function</span> <span class="nf">process</span><span class="p">(</span><span class="nx">LoggableInterface</span> <span class="nv">$obj</span><span class="p">)</span> <span class="p">{}</span> <span class="c1">// âœ… åˆæ³•
</span></span></span></code></pre></div><hr>
<h2 id="-å…­å…¸å‹ä½¿ç”¨åœºæ™¯">âœ… å…­ã€å…¸å‹ä½¿ç”¨åœºæ™¯</h2>
<table>
  <thead>
      <tr>
          <th>åœºæ™¯</th>
          <th>ç¤ºä¾‹ Trait</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>æ—¥å¿—è®°å½•</td>
          <td><code>Loggable</code></td>
      </tr>
      <tr>
          <td>æ—¶é—´æˆ³</td>
          <td><code>Timestampable</code></td>
      </tr>
      <tr>
          <td>è½¯åˆ é™¤</td>
          <td><code>SoftDeletable</code></td>
      </tr>
      <tr>
          <td>ç¼“å­˜ä»£ç†</td>
          <td><code>Cacheable</code></td>
      </tr>
      <tr>
          <td>éªŒè¯é€»è¾‘</td>
          <td><code>Validatable</code></td>
      </tr>
      <tr>
          <td>æ•°ç»„/JSON è½¬æ¢</td>
          <td><code>Arrayable</code>, <code>Jsonable</code></td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>Laravelã€Symfony ç­‰æ¡†æ¶å¹¿æ³›ä½¿ç”¨ Traitï¼ˆå¦‚ Laravel çš„ <code>HasFactory</code>, <code>SoftDeletes</code>ï¼‰ã€‚</p>
</blockquote>
<hr>
<h2 id="-æ€»ç»“-3">ğŸ“Œ æ€»ç»“</h2>
<ul>
<li><strong>Trait æ˜¯ PHP å®ç°ä»£ç å¤ç”¨çš„å¼ºå¤§å·¥å…·</strong>ï¼Œçªç ´å•ç»§æ‰¿é™åˆ¶ã€‚</li>
<li><strong>å¯åŒ…å«å±æ€§ã€æ–¹æ³•ã€é™æ€æˆå‘˜</strong>ï¼Œæ”¯æŒåµŒå¥—å’Œå†²çªè§£å†³ã€‚</li>
<li><strong>ä¸æ˜¯æ›¿ä»£ç»§æ‰¿æˆ–æ¥å£ï¼Œè€Œæ˜¯è¡¥å……</strong>ï¼šç”¨äºâ€œè¡Œä¸ºç»„åˆâ€ã€‚</li>
<li><strong>æ…ç”¨</strong>ï¼šä¿æŒèŒè´£å•ä¸€ï¼Œé¿å…æ»¥ç”¨å¯¼è‡´ä»£ç æ··ä¹±ã€‚</li>
</ul>
<blockquote>
<p>ğŸ’¡ è®°ä½ï¼š<strong>â€œFavor composition over inheritanceâ€</strong> â€”â€” Trait æ˜¯å®ç°ç»„åˆçš„ä¸€ç§ä¼˜é›…æ–¹å¼ã€‚</p>
</blockquote>
<h1 id="åœ¨-php-ä¸­é”™è¯¯error-å’Œ-å¼‚å¸¸exception-æ˜¯ä¸¤ç§ä¸åŒçš„ç¨‹åºæ•…éšœå¤„ç†æœºåˆ¶ä»-php-7-å¼€å§‹ä¸¤è€…åœ¨åº•å±‚è¢«ç»Ÿä¸€ä¸º-throwable-æ¥å£-çš„å®ç°ä½†å®ƒä»¬çš„æ¥æºç”¨é€”å’Œå¤„ç†æ–¹å¼ä»æœ‰é‡è¦åŒºåˆ«">åœ¨ PHP ä¸­ï¼Œ<strong>é”™è¯¯ï¼ˆErrorï¼‰</strong> å’Œ <strong>å¼‚å¸¸ï¼ˆExceptionï¼‰</strong> æ˜¯ä¸¤ç§ä¸åŒçš„ç¨‹åºæ•…éšœå¤„ç†æœºåˆ¶ã€‚ä» <strong>PHP 7 å¼€å§‹</strong>ï¼Œä¸¤è€…åœ¨åº•å±‚è¢«ç»Ÿä¸€ä¸º <strong>Throwable æ¥å£</strong> çš„å®ç°ï¼Œä½†å®ƒä»¬çš„æ¥æºã€ç”¨é€”å’Œå¤„ç†æ–¹å¼ä»æœ‰é‡è¦åŒºåˆ«ã€‚</h1>
<p>ä¸‹é¢å°†ä»æ¦‚å¿µã€åˆ†ç±»ã€å¤„ç†æœºåˆ¶ã€æœ€ä½³å®è·µç­‰æ–¹é¢è¯¦ç»†è§£æï¼Œå¹¶é™„å¸¦å¤§é‡å¯è¿è¡Œç¤ºä¾‹ã€‚</p>
<hr>
<h2 id="-ä¸€æ ¸å¿ƒæ¦‚å¿µerror-vs-exception">ğŸ§© ä¸€ã€æ ¸å¿ƒæ¦‚å¿µï¼šError vs Exception</h2>
<table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th><strong>Errorï¼ˆé”™è¯¯ï¼‰</strong></th>
          <th><strong>Exceptionï¼ˆå¼‚å¸¸ï¼‰</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>æ¥æº</strong></td>
          <td>å¼•æ“å†…éƒ¨ï¼ˆå¦‚è¯­æ³•é”™è¯¯ã€å†…å­˜æº¢å‡ºï¼‰æˆ–ç”¨æˆ·è§¦å‘ï¼ˆ<code>trigger_error()</code>ï¼‰</td>
          <td>ç”¨æˆ·ä»£ç ä¸»åŠ¨æŠ›å‡ºï¼ˆ<code>throw new Exception()</code>ï¼‰</td>
      </tr>
      <tr>
          <td><strong>æ˜¯å¦å¯æ¢å¤</strong></td>
          <td>å¤šæ•°ä¸å¯æ¢å¤ï¼ˆå¦‚ Fatal Errorï¼‰ï¼Œä½†éƒ¨åˆ†å¯æ•è·ï¼ˆPHP 7+ï¼‰</td>
          <td>è®¾è®¡ä¸Šå°±æ˜¯<strong>å¯æ¢å¤</strong>çš„æµç¨‹æ§åˆ¶</td>
      </tr>
      <tr>
          <td><strong>ç»§æ‰¿å…³ç³»</strong></td>
          <td><code>Error</code> ç±»ï¼ˆPHP 7+ï¼‰</td>
          <td><code>Exception</code> ç±»</td>
      </tr>
      <tr>
          <td><strong>å…±åŒç¥–å…ˆ</strong></td>
          <td>éƒ½å®ç° <code>Throwable</code> æ¥å£ï¼ˆPHP 7+ï¼‰</td>
          <td></td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>âœ… <strong>å…³é”®å˜åŒ–</strong>ï¼š</p>
<ul>
<li><strong>PHP 5</strong>ï¼šError æ˜¯è‡´å‘½é”™è¯¯ï¼Œæ— æ³•ç”¨ <code>try/catch</code> æ•è·ã€‚</li>
<li><strong>PHP 7+</strong>ï¼šå¤šæ•° Error è¢«è½¬æ¢ä¸º <code>Error</code> å¯¹è±¡ï¼Œ<strong>å¯ä»¥è¢«æ•è·</strong>ï¼</li>
</ul>
</blockquote>
<hr>
<h2 id="-äºŒthrowable-æ¥å£php-7-ç»Ÿä¸€é¡¶å±‚æ¥å£">ğŸ” äºŒã€Throwable æ¥å£ï¼ˆPHP 7+ ç»Ÿä¸€é¡¶å±‚æ¥å£ï¼‰</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">interface</span> <span class="nx">Throwable</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getMessage</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getCode</span><span class="p">()</span><span class="o">:</span> <span class="nx">int</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getFile</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getLine</span><span class="p">()</span><span class="o">:</span> <span class="nx">int</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getTrace</span><span class="p">()</span><span class="o">:</span> <span class="k">array</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getPrevious</span><span class="p">()</span><span class="o">:</span> <span class="o">?</span><span class="nx">Throwable</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>æ‰€æœ‰å¯æŠ›å‡ºçš„å¯¹è±¡å¿…é¡»å®ç° <code>Throwable</code>ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><code>Exception</code>ï¼ˆåŠå…¶å­ç±»ï¼‰</li>
<li><code>Error</code>ï¼ˆåŠå…¶å­ç±»ï¼‰</li>
</ul>
<hr>
<h2 id="-ä¸‰php-é”™è¯¯errorè¯¦è§£">ğŸ“š ä¸‰ã€PHP é”™è¯¯ï¼ˆErrorï¼‰è¯¦è§£</h2>
<h3 id="1-error-çš„ä¸»è¦å­ç±»php-7">1. <strong>Error çš„ä¸»è¦å­ç±»ï¼ˆPHP 7+ï¼‰</strong></h3>
<table>
  <thead>
      <tr>
          <th>é”™è¯¯ç±»å‹</th>
          <th>è§¦å‘åœºæ™¯</th>
          <th>æ˜¯å¦å¯æ•è·</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>ParseError</code></td>
          <td>è¯­æ³•é”™è¯¯ï¼ˆå¦‚å°‘åˆ†å·ï¼‰</td>
          <td>âŒï¼ˆè„šæœ¬æœªè¿è¡Œï¼‰</td>
      </tr>
      <tr>
          <td><code>TypeError</code></td>
          <td>ç±»å‹å£°æ˜ä¸åŒ¹é…</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td><code>ArgumentCountError</code></td>
          <td>å‡½æ•°å‚æ•°æ•°é‡é”™è¯¯</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td><code>ArithmeticError</code></td>
          <td>æ•°å­¦è¿ç®—é”™è¯¯ï¼ˆå¦‚ <code>intdiv(1,0)</code>ï¼‰</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td><code>DivisionByZeroError</code></td>
          <td>é™¤é›¶é”™è¯¯ï¼ˆPHP 8+ï¼‰</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td><code>CompileError</code></td>
          <td>ç¼–è¯‘æ—¶é”™è¯¯ï¼ˆå¦‚æ— æ•ˆ trait ä½¿ç”¨ï¼‰</td>
          <td>âŒ</td>
      </tr>
      <tr>
          <td><code>Fatal Error</code></td>
          <td>å¦‚è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•</td>
          <td>âœ…ï¼ˆè½¬ä¸º <code>Error</code>ï¼‰</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼š<strong>ParseError å’Œ CompileError å‘ç”Ÿåœ¨è„šæœ¬æ‰§è¡Œå‰ï¼Œæ— æ³•ç”¨ try/catch æ•è·</strong>ã€‚</p>
</blockquote>
<hr>
<h3 id="2-error-ç¤ºä¾‹">2. <strong>Error ç¤ºä¾‹</strong></h3>
<h4 id="-å¯æ•è·çš„-errorphp-7">âœ… å¯æ•è·çš„ Errorï¼ˆPHP 7+ï¼‰</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="c1">// TypeError: æœŸæœ› intï¼Œä¼ äº† string
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">function</span> <span class="nf">add</span><span class="p">(</span><span class="nx">int</span> <span class="nv">$a</span><span class="p">,</span> <span class="nx">int</span> <span class="nv">$b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$a</span> <span class="o">+</span> <span class="nv">$b</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="nx">add</span><span class="p">(</span><span class="s2">&#34;hello&#34;</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">TypeError</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;ç±»å‹é”™è¯¯: &#34;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="c1">// ArithmeticError: é™¤é›¶
</span></span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="nx">intdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">DivisionByZeroError</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;é™¤é›¶é”™è¯¯: &#34;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="c1">// è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³• â†’ Fatal Error è½¬ä¸º Error
</span></span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nv">$obj</span> <span class="o">=</span> <span class="k">new</span> <span class="k">stdClass</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="nv">$obj</span><span class="o">-&gt;</span><span class="na">nonExistentMethod</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Error</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;è‡´å‘½é”™è¯¯è¢«æ•è·: &#34;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="-ä¸å¯æ•è·çš„-parseerror">âŒ ä¸å¯æ•è·çš„ ParseError</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1">// è¿™æ®µä»£ç æœ‰è¯­æ³•é”™è¯¯ï¼Œæ ¹æœ¬ä¸ä¼šè¿›å…¥è¿è¡Œæ—¶
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="k">echo</span> <span class="s2">&#34;Hello&#34;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1">// ç¼ºå°‘åˆ†å· â†’ ParseErrorï¼Œç›´æ¥æŠ¥é”™ï¼Œæ— æ³• catch
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><hr>
<h2 id="-å››php-å¼‚å¸¸exceptionè¯¦è§£">ğŸ“š å››ã€PHP å¼‚å¸¸ï¼ˆExceptionï¼‰è¯¦è§£</h2>
<h3 id="1-exception-çš„ç»§æ‰¿ä½“ç³»">1. <strong>Exception çš„ç»§æ‰¿ä½“ç³»</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln"> 1</span><span class="cl">Throwable
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">â”œâ”€â”€ Exception
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">â”‚   â”œâ”€â”€ LogicException
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">â”‚   â”‚   â”œâ”€â”€ BadFunctionCallException
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">â”‚   â”‚   â””â”€â”€ BadMethodCallException
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">â”‚   â”‚   â””â”€â”€ InvalidArgumentException
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">â”‚   â”‚   â””â”€â”€ LengthException
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">â”‚   â”‚   â””â”€â”€ OutOfRangeException
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">â”‚   â””â”€â”€ RuntimeException
</span></span><span class="line"><span class="ln">10</span><span class="cl">â”‚       â”œâ”€â”€ OutOfBoundsException
</span></span><span class="line"><span class="ln">11</span><span class="cl">â”‚       â”œâ”€â”€ OverflowException
</span></span><span class="line"><span class="ln">12</span><span class="cl">â”‚       â”œâ”€â”€ RangeException
</span></span><span class="line"><span class="ln">13</span><span class="cl">â”‚       â”œâ”€â”€ UnderflowException
</span></span><span class="line"><span class="ln">14</span><span class="cl">â”‚       â””â”€â”€ UnexpectedValueException
</span></span><span class="line"><span class="ln">15</span><span class="cl">â””â”€â”€ Error
</span></span><span class="line"><span class="ln">16</span><span class="cl">    â””â”€â”€ ...ï¼ˆè§ä¸Šæ–‡ï¼‰
</span></span></code></pre></div><blockquote>
<p>ğŸ’¡ <strong>æœ€ä½³å®è·µ</strong>ï¼š</p>
<ul>
<li>é€»è¾‘é”™è¯¯ï¼ˆå¦‚å‚æ•°æ— æ•ˆï¼‰â†’ æŠ› <code>LogicException</code></li>
<li>è¿è¡Œæ—¶é”™è¯¯ï¼ˆå¦‚æ–‡ä»¶ä¸å­˜åœ¨ï¼‰â†’ æŠ› <code>RuntimeException</code></li>
</ul>
</blockquote>
<hr>
<h3 id="2-è‡ªå®šä¹‰å¼‚å¸¸">2. <strong>è‡ªå®šä¹‰å¼‚å¸¸</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">class</span> <span class="nc">InvalidEmailException</span> <span class="k">extends</span> <span class="nx">InvalidArgumentException</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$email</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">(</span><span class="s2">&#34;Invalid email: </span><span class="si">$email</span><span class="s2">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">function</span> <span class="nf">validateEmail</span><span class="p">(</span><span class="nv">$email</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">filter_var</span><span class="p">(</span><span class="nv">$email</span><span class="p">,</span> <span class="nx">FILTER_VALIDATE_EMAIL</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="k">throw</span> <span class="k">new</span> <span class="nx">InvalidEmailException</span><span class="p">(</span><span class="nv">$email</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nx">validateEmail</span><span class="p">(</span><span class="s2">&#34;not-an-email&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">InvalidEmailException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;éªŒè¯å¤±è´¥: &#34;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><hr>
<h2 id="-äº”é”™è¯¯ä¸å¼‚å¸¸çš„å¤„ç†æœºåˆ¶">ğŸ›  äº”ã€é”™è¯¯ä¸å¼‚å¸¸çš„å¤„ç†æœºåˆ¶</h2>
<h3 id="1-try--catch--finally">1. <strong>try / catch / finally</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="c1">// å¯èƒ½æŠ›å‡º Exception æˆ– Error çš„ä»£ç 
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="nx">riskyOperation</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">InvalidArgumentException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="c1">// æ•è·ç‰¹å®šå¼‚å¸¸
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="nx">handleLogicError</span><span class="p">(</span><span class="nv">$e</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">RuntimeException</span> <span class="o">|</span> <span class="nx">Error</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="c1">// PHP 7.1+ æ”¯æŒå¤šç±»å‹ catch
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="nx">handleRuntimeError</span><span class="p">(</span><span class="nv">$e</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="c1">// æ— è®ºæˆåŠŸ/å¤±è´¥éƒ½ä¼šæ‰§è¡Œï¼ˆPHP 5.5+ï¼‰
</span></span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="nx">cleanup</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>âœ… <strong>æ¨è</strong>ï¼šå…ˆæ•è·å…·ä½“ç±»å‹ï¼Œå†æ•è·é€šç”¨ç±»å‹ï¼ˆ<code>Exception</code> / <code>Error</code>ï¼‰ã€‚</p>
</blockquote>
<hr>
<h3 id="2-å…¨å±€å¼‚å¸¸å¤„ç†å™¨">2. <strong>å…¨å±€å¼‚å¸¸å¤„ç†å™¨</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">// æ•è·æœªè¢«æ•è·çš„ Exception
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nx">set_exception_handler</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nx">Throwable</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="nx">error_log</span><span class="p">(</span><span class="s2">&#34;Uncaught: &#34;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">());</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;ç³»ç»Ÿé”™è¯¯ï¼Œè¯·ç¨åå†è¯•ã€‚&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="c1">// æ•è·æœªè¢«æ•è·çš„ Errorï¼ˆPHP 7+ï¼‰
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1">// å®é™…ä¸Š set_exception_handler ä¹Ÿèƒ½æ•è· Errorï¼
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1">// å› ä¸º Error å®ç°äº† Throwable
</span></span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="c1">// è§¦å‘æœªå¤„ç†å¼‚å¸¸
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span><span class="s2">&#34;Oops!&#34;</span><span class="p">);</span>
</span></span></code></pre></div><blockquote>
<p>âš ï¸ æ³¨æ„ï¼š<code>set_exception_handler</code> åœ¨ PHP 7+ å¯å¤„ç†æ‰€æœ‰ <code>Throwable</code>ã€‚</p>
</blockquote>
<hr>
<h3 id="3-ä¼ ç»Ÿé”™è¯¯e_">3. <strong>ä¼ ç»Ÿé”™è¯¯ï¼ˆE_ERROR, E_WARNING ç­‰ï¼‰çš„å¤„ç†</strong></h3>
<p>PHP è¿˜æœ‰ä¸€å¥—<strong>ä¼ ç»Ÿé”™è¯¯æŠ¥å‘Šç³»ç»Ÿ</strong>ï¼ˆåŸºäº <code>error_reporting</code> å’Œ <code>trigger_error</code>ï¼‰ï¼Œä¸å¼‚å¸¸ç³»ç»Ÿå¹¶å­˜ã€‚</p>
<h4 id="å¯ç”¨ä¼ ç»Ÿé”™è¯¯è½¬å¼‚å¸¸æ¨è">å¯ç”¨ä¼ ç»Ÿé”™è¯¯è½¬å¼‚å¸¸ï¼ˆæ¨èï¼ï¼‰</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">// å°† E_WARNING, E_NOTICE ç­‰è½¬æ¢ä¸º ErrorException
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nx">set_error_handler</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$severity</span><span class="p">,</span> <span class="nv">$message</span><span class="p">,</span> <span class="nv">$file</span><span class="p">,</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">error_reporting</span><span class="p">()</span> <span class="o">&amp;</span> <span class="nv">$severity</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">        <span class="k">return</span> <span class="k">false</span><span class="p">;</span> <span class="c1">// è¢« @ æŠ‘åˆ¶çš„é”™è¯¯
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">throw</span> <span class="k">new</span> <span class="nx">ErrorException</span><span class="p">(</span><span class="nv">$message</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$severity</span><span class="p">,</span> <span class="nv">$file</span><span class="p">,</span> <span class="nv">$line</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1">// ç°åœ¨ä»¥ä¸‹è­¦å‘Šä¼šå˜æˆå¼‚å¸¸ï¼
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">echo</span> <span class="nv">$undefinedVariable</span><span class="p">;</span> <span class="c1">// åŸæœ¬æ˜¯ E_NOTICE
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ErrorException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;æ•è·åˆ°ä¼ ç»Ÿé”™è¯¯: &#34;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>âœ… <strong>å¼ºçƒˆå»ºè®®</strong>ï¼šåœ¨å¼€å‘ç¯å¢ƒä¸­å¯ç”¨æ­¤è½¬æ¢ï¼Œä½¿æ‰€æœ‰é”™è¯¯ç»Ÿä¸€é€šè¿‡å¼‚å¸¸æœºåˆ¶å¤„ç†ã€‚</p>
</blockquote>
<hr>
<h2 id="-å…­php-é”™è¯¯çº§åˆ«error-levels">ğŸ“Š å…­ã€PHP é”™è¯¯çº§åˆ«ï¼ˆError Levelsï¼‰</h2>
<table>
  <thead>
      <tr>
          <th>å¸¸é‡</th>
          <th>è¯´æ˜</th>
          <th>æ˜¯å¦åœæ­¢è„šæœ¬</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>E_ERROR</code></td>
          <td>è‡´å‘½è¿è¡Œæ—¶é”™è¯¯</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td><code>E_WARNING</code></td>
          <td>è¿è¡Œæ—¶è­¦å‘Š</td>
          <td>âŒ</td>
      </tr>
      <tr>
          <td><code>E_PARSE</code></td>
          <td>ç¼–è¯‘æ—¶è§£æé”™è¯¯</td>
          <td>âœ…ï¼ˆè„šæœ¬ä¸è¿è¡Œï¼‰</td>
      </tr>
      <tr>
          <td><code>E_NOTICE</code></td>
          <td>è¿è¡Œæ—¶é€šçŸ¥ï¼ˆå¦‚æœªå®šä¹‰å˜é‡ï¼‰</td>
          <td>âŒ</td>
      </tr>
      <tr>
          <td><code>E_STRICT</code></td>
          <td>ç¼–ç å»ºè®®ï¼ˆPHP 8 å·²ç§»é™¤ï¼‰</td>
          <td>âŒ</td>
      </tr>
      <tr>
          <td><code>E_DEPRECATED</code></td>
          <td>å·²åºŸå¼ƒåŠŸèƒ½è­¦å‘Š</td>
          <td>âŒ</td>
      </tr>
  </tbody>
</table>
<p>å¯é€šè¿‡ <code>error_reporting(E_ALL)</code> æ§åˆ¶æ˜¾ç¤ºå“ªäº›çº§åˆ«ã€‚</p>
<hr>
<h2 id="-ä¸ƒå®Œæ•´ç»¼åˆç¤ºä¾‹">ğŸ§ª ä¸ƒã€å®Œæ•´ç»¼åˆç¤ºä¾‹</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="c1">// 1. å°†ä¼ ç»Ÿé”™è¯¯è½¬ä¸ºå¼‚å¸¸
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nx">set_error_handler</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$severity</span><span class="p">,</span> <span class="nv">$msg</span><span class="p">,</span> <span class="nv">$file</span><span class="p">,</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="k">throw</span> <span class="k">new</span> <span class="nx">ErrorException</span><span class="p">(</span><span class="nv">$msg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$severity</span><span class="p">,</span> <span class="nv">$file</span><span class="p">,</span> <span class="nv">$line</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1">// 2. å…¨å±€æœªæ•è·å¤„ç†å™¨
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="nx">set_exception_handler</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nx">Throwable</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;ã€å…¨å±€æ•è·ã€‘&#34;</span> <span class="o">.</span> <span class="nx">get_class</span><span class="p">(</span><span class="nv">$e</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&#34;: &#34;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1">// 3. æµ‹è¯•å„ç§æƒ…å†µ
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">class</span> <span class="nc">Calculator</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">divide</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">)</span><span class="o">:</span> <span class="nx">float</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nx">InvalidArgumentException</span><span class="p">(</span><span class="s2">&#34;Division by zero&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="k">return</span> <span class="nv">$a</span> <span class="o">/</span> <span class="nv">$b</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="nv">$calc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Calculator</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="c1">// æµ‹è¯• 1: è‡ªå®šä¹‰å¼‚å¸¸
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="nv">$calc</span><span class="o">-&gt;</span><span class="na">divide</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">InvalidArgumentException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;ã€æ•è·å¼‚å¸¸ã€‘&#34;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">
</span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="c1">// æµ‹è¯• 2: ç±»å‹é”™è¯¯ï¼ˆPHP 7+ Errorï¼‰
</span></span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">    <span class="nx">strlen</span><span class="p">(</span><span class="k">null</span><span class="p">);</span> <span class="c1">// PHP 8.1+ ä¼šè§¦å‘ TypeError
</span></span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">TypeError</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;ã€æ•è·ç±»å‹é”™è¯¯ã€‘&#34;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">
</span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="c1">// æµ‹è¯• 3: ä¼ ç»Ÿé”™è¯¯è½¬å¼‚å¸¸
</span></span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">    <span class="k">echo</span> <span class="nv">$undefinedVar</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ErrorException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;ã€æ•è·ä¼ ç»Ÿé”™è¯¯ã€‘&#34;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">
</span></span><span class="line"><span class="ln">46</span><span class="cl"><span class="c1">// æµ‹è¯• 4: æœªæ•è·çš„ Errorï¼ˆä¼šè¢«å…¨å±€å¤„ç†å™¨æ•è·ï¼‰
</span></span></span><span class="line"><span class="ln">47</span><span class="cl"><span class="k">new</span> <span class="nx">NonExistentClass</span><span class="p">();</span>
</span></span></code></pre></div><p><strong>è¾“å‡ºç¤ºä¾‹ï¼ˆPHP 8.1+ï¼‰</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="err">ã€æ•è·å¼‚å¸¸ã€‘</span><span class="n">Division</span> <span class="n">by</span> <span class="n">zero</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err">ã€æ•è·ç±»å‹é”™è¯¯ã€‘</span><span class="n">strlen</span><span class="p">():</span> <span class="n">Argument</span> <span class="c1">#1 ($string) must be of type string, null given</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="err">ã€æ•è·ä¼ ç»Ÿé”™è¯¯ã€‘</span><span class="n">Undefined</span> <span class="n">variable</span> <span class="o">$</span><span class="n">undefinedVar</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="err">ã€å…¨å±€æ•è·ã€‘</span><span class="n">Error</span><span class="p">:</span> <span class="n">Class</span> <span class="s2">&#34;NonExistentClass&#34;</span> <span class="ow">not</span> <span class="n">found</span>
</span></span></code></pre></div><hr>
<h2 id="-å…«æœ€ä½³å®è·µæ€»ç»“">âœ… å…«ã€æœ€ä½³å®è·µæ€»ç»“</h2>
<table>
  <thead>
      <tr>
          <th>åœºæ™¯</th>
          <th>æ¨èåšæ³•</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>æ–°é¡¹ç›®</strong></td>
          <td>å¯ç”¨ <code>set_error_handler</code> å°†ä¼ ç»Ÿé”™è¯¯è½¬ä¸ºå¼‚å¸¸</td>
      </tr>
      <tr>
          <td><strong>å¼‚å¸¸ç±»å‹</strong></td>
          <td>ä½¿ç”¨æ ‡å‡†å¼‚å¸¸å­ç±»ï¼ˆ<code>InvalidArgumentException</code> ç­‰ï¼‰</td>
      </tr>
      <tr>
          <td><strong>é”™è¯¯å¤„ç†</strong></td>
          <td>ç”¨ <code>try/catch</code> æ•è·å¯æ¢å¤é”™è¯¯ï¼Œå…¨å±€å¤„ç†å™¨å…œåº•</td>
      </tr>
      <tr>
          <td><strong>æ—¥å¿—è®°å½•</strong></td>
          <td>åœ¨å…¨å±€å¤„ç†å™¨ä¸­è®°å½• <code>Throwable</code> çš„å®Œæ•´ä¿¡æ¯ï¼ˆå« traceï¼‰</td>
      </tr>
      <tr>
          <td><strong>ç”Ÿäº§ç¯å¢ƒ</strong></td>
          <td>ä¸è¦æš´éœ²é”™è¯¯ç»†èŠ‚ç»™ç”¨æˆ·ï¼Œåªè®°å½•æ—¥å¿—</td>
      </tr>
      <tr>
          <td><strong>é¿å…</strong></td>
          <td>ä¸è¦æ··ç”¨ <code>die()</code>/<code>exit()</code> å’Œå¼‚å¸¸ï¼›ä¸è¦å¿½ç•¥å¯æ¢å¤é”™è¯¯</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-ä¹å¸¸è§è¯¯åŒº">ğŸ“Œ ä¹ã€å¸¸è§è¯¯åŒº</h2>
<ol>
<li>
<p><strong>â€œError ä¸èƒ½è¢«æ•è·â€</strong><br>
â†’ <strong>PHP 7+ å¤§éƒ¨åˆ†å¯ä»¥ï¼</strong>ï¼ˆé™¤äº† ParseErrorï¼‰</p>
</li>
<li>
<p><strong>â€œException èƒ½æ•è·æ‰€æœ‰é”™è¯¯â€</strong><br>
â†’ å¿…é¡»ç”¨ <code>catch (Throwable $e)</code> æ‰èƒ½åŒæ—¶æ•è· <code>Exception</code> å’Œ <code>Error</code></p>
</li>
<li>
<p><strong>â€œå…³é—­ error_reporting å°±å®‰å…¨äº†â€</strong><br>
â†’ é”™è¯¯ä»ä¼šå‘ç”Ÿï¼Œåªæ˜¯ä¸æ˜¾ç¤ºã€‚åº”æ­£ç¡®å¤„ç†è€Œééšè—ã€‚</p>
</li>
</ol>
<hr>
<h2 id="-æ€»ç»“-4">ğŸ”š æ€»ç»“</h2>
<ul>
<li><strong>PHP 7+ ç»Ÿä¸€äº†é”™è¯¯å’Œå¼‚å¸¸æ¨¡å‹</strong>ï¼Œéƒ½åŸºäº <code>Throwable</code>ã€‚</li>
<li><strong>Error</strong>ï¼šå¼•æ“çº§é—®é¢˜ï¼ˆå¤šæ•°å¯æ•è·ï¼‰ã€‚</li>
<li><strong>Exception</strong>ï¼šåº”ç”¨çº§é—®é¢˜ï¼ˆè®¾è®¡ä¸ºå¯æ¢å¤ï¼‰ã€‚</li>
<li><strong>ä¼ ç»Ÿé”™è¯¯</strong>ï¼ˆE_WARNING ç­‰ï¼‰åº”é€šè¿‡ <code>set_error_handler</code> è½¬ä¸ºå¼‚å¸¸ã€‚</li>
<li><strong>å§‹ç»ˆä½¿ç”¨ <code>try/catch</code> + å…¨å±€å¤„ç†å™¨</strong> æ„å»ºå¥å£®åº”ç”¨ã€‚</li>
</ul>
<blockquote>
<p>ğŸ’¡ è®°ä½ï¼š<strong>â€œFail fast, handle gracefully.â€</strong> â€”â€” å¿«é€Ÿå¤±è´¥ï¼Œä¼˜é›…å¤„ç†ã€‚</p>
</blockquote>
<h1 id="ä»-php-5-å¼€å§‹ç³»ç»Ÿæ¢³ç†-mysqlnd-çš„æ¼”è¿›å…³ç³»å¹¶è§£é‡Šå®ƒä»¬åœ¨ä¸åŒ-php-ç‰ˆæœ¬ä¸­çš„è§’è‰²ä¸åä½œæœºåˆ¶">ä» <strong>PHP 5 å¼€å§‹</strong>ï¼Œç³»ç»Ÿæ¢³ç† <strong><code>mysqlnd</code>ã€<code>PDO</code>ã€MySQL é©±åŠ¨</strong> çš„æ¼”è¿›å…³ç³»ï¼Œå¹¶è§£é‡Šå®ƒä»¬åœ¨ä¸åŒ PHP ç‰ˆæœ¬ä¸­çš„è§’è‰²ä¸åä½œæœºåˆ¶ã€‚</h1>
<hr>
<h2 id="-æ ¸å¿ƒæ¦‚å¿µå…ˆæ¾„æ¸…">ğŸ”‘ æ ¸å¿ƒæ¦‚å¿µå…ˆæ¾„æ¸…</h2>
<table>
  <thead>
      <tr>
          <th>æœ¯è¯­</th>
          <th>å…¨ç§° / å«ä¹‰</th>
          <th>ä½œç”¨</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>PDO</strong></td>
          <td>PHP Data Objects</td>
          <td><strong>æ•°æ®åº“æŠ½è±¡å±‚</strong>ï¼ˆç»Ÿä¸€æ¥å£ï¼‰ï¼Œæœ¬èº«ä¸ç›´æ¥è¿æ•°æ®åº“</td>
      </tr>
      <tr>
          <td><strong>PDO Driver</strong></td>
          <td>PDO é©±åŠ¨ï¼ˆå¦‚ <code>pdo_mysql</code>ï¼‰</td>
          <td>å®ç° PDO æ¥å£ï¼Œå¯¹æ¥å…·ä½“æ•°æ®åº“ï¼ˆå¦‚ MySQLï¼‰</td>
      </tr>
      <tr>
          <td><strong>MySQL Client Library</strong></td>
          <td>è¿æ¥ MySQL çš„åº•å±‚ C åº“</td>
          <td>è´Ÿè´£å®é™…çš„ç½‘ç»œé€šä¿¡ã€åè®®è§£æ</td>
      </tr>
      <tr>
          <td><strong>mysqlnd</strong></td>
          <td>MySQL Native Driver</td>
          <td><strong>PHP å®˜æ–¹ç”¨ C å†™çš„ MySQL å®¢æˆ·ç«¯åº“</strong>ï¼ˆæ›¿ä»£ libmysqlclientï¼‰</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>âœ… <strong>å…³é”®å…³ç³»</strong>ï¼š<br>
<strong>PDOï¼ˆæ¥å£ï¼‰ â†’ pdo_mysqlï¼ˆé©±åŠ¨ï¼‰ â†’ mysqlnd æˆ– libmysqlclientï¼ˆåº•å±‚é€šä¿¡åº“ï¼‰</strong></p>
</blockquote>
<hr>
<h2 id="-ä¸€php-50--52åªæœ‰-libmysqlclient">ğŸ§± ä¸€ã€PHP 5.0 â€“ 5.2ï¼šåªæœ‰ <code>libmysqlclient</code></h2>
<h3 id="æ¶æ„">æ¶æ„ï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">Your Code
</span></span><span class="line"><span class="ln">2</span><span class="cl">   â†“
</span></span><span class="line"><span class="ln">3</span><span class="cl">PDO (or mysql/mysqli extension)
</span></span><span class="line"><span class="ln">4</span><span class="cl">   â†“
</span></span><span class="line"><span class="ln">5</span><span class="cl">libmysqlclient (ç”± Oracle/MySQL AB æä¾›çš„ C åº“)
</span></span><span class="line"><span class="ln">6</span><span class="cl">   â†“
</span></span><span class="line"><span class="ln">7</span><span class="cl">MySQL Server
</span></span></code></pre></div><h3 id="ç‰¹ç‚¹-2">ç‰¹ç‚¹ï¼š</h3>
<ul>
<li>æ‰€æœ‰ MySQL æ‰©å±•ï¼ˆ<code>mysql_*</code>, <code>mysqli</code>, <code>pdo_mysql</code>ï¼‰éƒ½ä¾èµ–ç³»ç»Ÿå®‰è£…çš„ <strong><code>libmysqlclient.so</code></strong>ã€‚</li>
<li>å¿…é¡»åœ¨ç¼–è¯‘ PHP æ—¶é“¾æ¥è¯¥åº“ï¼ˆ<code>--with-mysql=/path</code>ï¼‰ã€‚</li>
<li><strong>ç¼ºç‚¹</strong>ï¼š
<ul>
<li>ä¾èµ–å¤–éƒ¨åº“ï¼Œéƒ¨ç½²å¤æ‚ï¼›</li>
<li>å†…å­˜æ‹·è´å¤šï¼ˆæ•°æ®ä» libmysqlclient â†’ PHP å˜é‡éœ€è½¬æ¢ï¼‰ï¼›</li>
<li>ä¸æ”¯æŒæŸäº›æ–°ç‰¹æ€§ï¼ˆå¦‚å‹ç¼©åè®®ã€æ€§èƒ½ç»Ÿè®¡ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<hr>
<h2 id="-äºŒphp-53mysqlnd-æ­£å¼å¼•å…¥é‡å¤§å˜é©">ğŸš€ äºŒã€PHP 5.3ï¼š<code>mysqlnd</code> æ­£å¼å¼•å…¥ï¼ˆé‡å¤§å˜é©ï¼‰</h2>
<blockquote>
<p><strong>2008 å¹´ï¼ŒPHP 5.3 å‘å¸ƒï¼Œå†…ç½® <code>mysqlnd</code>ï¼ˆMySQL Native Driverï¼‰</strong></p>
</blockquote>
<h3 id="-mysqlnd-æ˜¯ä»€ä¹ˆ">âœ… <code>mysqlnd</code> æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<ul>
<li>ç”± <strong>PHP å›¢é˜Ÿç”¨ C é‡å†™çš„ MySQL å®¢æˆ·ç«¯åº“</strong>ï¼Œ<strong>å®Œå…¨é›†æˆåœ¨ PHP æºç ä¸­</strong>ã€‚</li>
<li><strong>æ— éœ€å®‰è£… <code>libmysqlclient</code></strong>ï¼Œç¼–è¯‘ PHP æ—¶é»˜è®¤å¯ç”¨ï¼ˆé™¤éæ˜¾å¼ç¦ç”¨ï¼‰ã€‚</li>
<li>ä¸“ä¸º PHP ä¼˜åŒ–ï¼Œå‡å°‘å†…å­˜æ‹·è´ï¼Œæå‡æ€§èƒ½ã€‚</li>
</ul>
<h3 id="æ–°æ¶æ„ä¸¤ç§é€‰æ‹©">æ–°æ¶æ„ï¼ˆä¸¤ç§é€‰æ‹©ï¼‰ï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">Option A (æ—§)ï¼š
</span></span><span class="line"><span class="ln">2</span><span class="cl">PDO â†’ pdo_mysql â†’ libmysqlclient
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl">Option B (æ–°ï¼Œé»˜è®¤)ï¼š
</span></span><span class="line"><span class="ln">5</span><span class="cl">PDO â†’ pdo_mysql â†’ mysqlnd
</span></span></code></pre></div><h3 id="å¦‚ä½•æŸ¥çœ‹å½“å‰ä½¿ç”¨å“ªä¸ª">å¦‚ä½•æŸ¥çœ‹å½“å‰ä½¿ç”¨å“ªä¸ªï¼Ÿ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1">// æŸ¥çœ‹ mysqlnd æ˜¯å¦å¯ç”¨
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">function_exists</span><span class="p">(</span><span class="s1">&#39;mysqli_get_client_info&#39;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">echo</span> <span class="nx">mysqli_get_client_info</span><span class="p">();</span> <span class="c1">// è‹¥å« &#34;mysqlnd&#34; åˆ™ä½¿ç”¨ native driver
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="c1">// æˆ–æŸ¥çœ‹ phpinfo()
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="nx">phpinfo</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1">// åœ¨ &#34;mysql&#34;, &#34;mysqli&#34;, &#34;pdo_mysql&#34; åŒºåŸŸä¼šæ˜¾ç¤º &#34;Client API version&#34;
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1">// å¦‚æœæ˜¯ &#34;mysqlnd 5.x.x&#34;ï¼Œè¯´æ˜ç”¨çš„æ˜¯ mysqlnd
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><h3 id="-mysqlnd-çš„ä¼˜åŠ¿php-53">âœ… <code>mysqlnd</code> çš„ä¼˜åŠ¿ï¼ˆPHP 5.3+ï¼‰ï¼š</h3>
<table>
  <thead>
      <tr>
          <th>åŠŸèƒ½</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>é›¶æ‹·è´ç»“æœé›†</strong></td>
          <td>ç›´æ¥å°† MySQL ç»“æœè½¬ä¸º PHP zvalï¼Œå‡å°‘å†…å­˜å¤åˆ¶</td>
      </tr>
      <tr>
          <td><strong>å†…ç½®æ€§èƒ½ç»Ÿè®¡</strong></td>
          <td><code>mysqli_get_cache_stats()</code>, <code>mysqli_get_connection_stats()</code></td>
      </tr>
      <tr>
          <td><strong>æ”¯æŒæ’ä»¶æ¶æ„</strong></td>
          <td>å¯å¼€å‘è®¤è¯ã€è´Ÿè½½å‡è¡¡ç­‰æ’ä»¶</td>
      </tr>
      <tr>
          <td><strong>æ›´å¥½çš„å†…å­˜ç®¡ç†</strong></td>
          <td>ä¸ PHP å†…å­˜æ± é›†æˆ</td>
      </tr>
      <tr>
          <td><strong>æ”¯æŒæ–°åè®®ç‰¹æ€§</strong></td>
          <td>å¦‚å‹ç¼©ã€SSL ç­‰æ›´æ˜“å®ç°</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>ğŸ’¡ <strong>ä» PHP 5.4 èµ·ï¼Œå®˜æ–¹å¼ºçƒˆæ¨èä½¿ç”¨ <code>mysqlnd</code></strong>ã€‚</p>
</blockquote>
<hr>
<h2 id="-ä¸‰php-55--70æ·˜æ±°-mysql_-å‡½æ•°mysqlnd-æˆäº‹å®æ ‡å‡†">ğŸ—‘ ä¸‰ã€PHP 5.5 â€“ 7.0ï¼šæ·˜æ±° <code>mysql_*</code> å‡½æ•°ï¼Œ<code>mysqlnd</code> æˆäº‹å®æ ‡å‡†</h2>
<h3 id="é‡è¦å˜åŒ–">é‡è¦å˜åŒ–ï¼š</h3>
<ul>
<li><strong>PHP 5.5</strong>ï¼šæ ‡è®° <code>mysql_*</code> å‡½æ•°ä¸º <strong>deprecated</strong>ï¼ˆå·²åºŸå¼ƒï¼‰ã€‚</li>
<li><strong>PHP 7.0</strong>ï¼š<strong>å½»åº•ç§»é™¤ <code>mysql_*</code> å‡½æ•°</strong>ï¼
<ul>
<li>åªå‰© <code>mysqli</code> å’Œ <code>PDO</code> ä¸¤ç§å®˜æ–¹ MySQL æ‰©å±•ã€‚</li>
</ul>
</li>
<li><strong><code>mysqlnd</code> æˆä¸ºé»˜è®¤ä¸”æ¨èçš„åº•å±‚é©±åŠ¨</strong>ã€‚
<ul>
<li>å¤§å¤šæ•° Linux å‘è¡Œç‰ˆï¼ˆå¦‚ Ubuntuã€CentOSï¼‰çš„ PHP åŒ…é»˜è®¤ç¼–è¯‘ä¸ºä½¿ç”¨ <code>mysqlnd</code>ã€‚</li>
</ul>
</li>
</ul>
<h3 id="æ­¤æ—¶å…¸å‹æ ˆ">æ­¤æ—¶å…¸å‹æ ˆï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">Your Code (PDO or MySQLi)
</span></span><span class="line"><span class="ln">2</span><span class="cl">   â†“
</span></span><span class="line"><span class="ln">3</span><span class="cl">pdo_mysql æˆ– mysqli æ‰©å±•
</span></span><span class="line"><span class="ln">4</span><span class="cl">   â†“
</span></span><span class="line"><span class="ln">5</span><span class="cl">mysqlnd (å†…ç½®ï¼Œæ— éœ€é¢å¤–å®‰è£…)
</span></span><span class="line"><span class="ln">6</span><span class="cl">   â†“
</span></span><span class="line"><span class="ln">7</span><span class="cl">MySQL Server
</span></span></code></pre></div><blockquote>
<p>âœ… <strong>PDO ä¸ mysqlnd çš„å…³ç³»</strong>ï¼š<br>
<code>pdo_mysql</code> é©±åŠ¨å¯ä»¥ç¼–è¯‘ä¸ºä½¿ç”¨ <code>mysqlnd</code> æˆ– <code>libmysqlclient</code>ï¼Œä½† <strong>PHP 5.4+ é»˜è®¤ä½¿ç”¨ <code>mysqlnd</code></strong>ã€‚</p>
</blockquote>
<hr>
<h2 id="-å››php-71--83mysqlnd-å…¨é¢ä¸»å¯¼å®‰å…¨ä¸æ€§èƒ½å¢å¼º">ğŸ”’ å››ã€PHP 7.1 â€“ 8.3ï¼š<code>mysqlnd</code> å…¨é¢ä¸»å¯¼ï¼Œå®‰å…¨ä¸æ€§èƒ½å¢å¼º</h2>
<h3 id="å…³é”®æ¼”è¿›">å…³é”®æ¼”è¿›ï¼š</h3>
<table>
  <thead>
      <tr>
          <th>ç‰ˆæœ¬</th>
          <th>æ”¹è¿›</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>PHP 7.1</strong></td>
          <td><code>mysqlnd</code> æ”¯æŒ <strong>SHA256 å¯†ç è®¤è¯</strong>ï¼ˆMySQL 8.0 é»˜è®¤ï¼‰</td>
      </tr>
      <tr>
          <td><strong>PHP 7.4</strong></td>
          <td>æ”¹è¿› SSL/TLS æ”¯æŒï¼Œæ”¯æŒ <code>MYSQLI_CLIENT_SSL_DONT_VERIFY_SERVER_CERT</code></td>
      </tr>
      <tr>
          <td><strong>PHP 8.0</strong></td>
          <td>ç§»é™¤ <code>libmysqlclient</code> ç¼–è¯‘é€‰é¡¹ï¼ˆéƒ¨åˆ†å‘è¡Œç‰ˆä»ä¿ç•™ï¼Œä½†å®˜æ–¹å€¾å‘ mysqlndï¼‰</td>
      </tr>
      <tr>
          <td><strong>PHP 8.1+</strong></td>
          <td><code>mysqlnd</code> æˆä¸º <strong>å”¯ä¸€å®˜æ–¹æ”¯æŒçš„ MySQL å®¢æˆ·ç«¯åº“</strong>ï¼ˆ<code>libmysqlclient</code> é€æ¸æ·˜æ±°ï¼‰</td>
      </tr>
  </tbody>
</table>
<h3 id="éªŒè¯-php-8x-æ˜¯å¦ä½¿ç”¨-mysqlnd">éªŒè¯ PHP 8.x æ˜¯å¦ä½¿ç”¨ mysqlndï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nx">PDO</span><span class="o">::</span><span class="na">getAvailableDrivers</span><span class="p">());</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1">// è¾“å‡ºåº”åŒ…å« &#34;mysql&#34;
</span></span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1">// æŸ¥çœ‹ pdo_mysql çš„åº•å±‚é©±åŠ¨
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="nv">$pdo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PDO</span><span class="p">(</span><span class="s1">&#39;mysql:host=127.0.0.1;dbname=test&#39;</span><span class="p">,</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;pass&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$pdo</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&#34;SHOW VARIABLES LIKE &#39;version_compile_machine&#39;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="c1">// å¦‚æœè¿”å›ç©ºæˆ–æŠ¥é”™ï¼Œè¯´æ˜ç”¨çš„æ˜¯ mysqlndï¼ˆå›  libmysqlclient æ‰æ”¯æŒæ­¤æŸ¥è¯¢ï¼‰
</span></span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="c1">// æ›´å¯é æ–¹å¼ï¼šphpinfo() ä¸­çœ‹ &#34;Client API version&#34;
</span></span></span></code></pre></div><blockquote>
<p>âš ï¸ æ³¨æ„ï¼š<strong><code>libmysqlclient</code> åœ¨ PHP 8.1+ ä¸­å·²åŸºæœ¬è¢«å¼ƒç”¨</strong>ï¼Œå®˜æ–¹æ–‡æ¡£æ˜ç¡®æ¨è <code>mysqlnd</code>ã€‚</p>
</blockquote>
<hr>
<h2 id="-äº”pdo--mysql-çš„å®Œæ•´è°ƒç”¨é“¾ç°ä»£-php">ğŸ”„ äº”ã€PDO + MySQL çš„å®Œæ•´è°ƒç”¨é“¾ï¼ˆç°ä»£ PHPï¼‰</h2>
<p>ä»¥ <code>new PDO('mysql:...')</code> ä¸ºä¾‹ï¼š</p>
<ol>
<li><strong>PHP ç”¨æˆ·ä»£ç </strong> è°ƒç”¨ <code>new PDO('mysql:host=...')</code></li>
<li><strong>PDO æ‰©å±•</strong> è§£æ DSNï¼Œå‘ç°æ˜¯ <code>mysql</code> é©±åŠ¨</li>
<li><strong>åŠ è½½ <code>pdo_mysql</code> æ‰©å±•</strong></li>
<li><strong><code>pdo_mysql</code> è°ƒç”¨åº•å±‚å®¢æˆ·ç«¯åº“</strong>ï¼š
<ul>
<li>å¦‚æœ PHP ç¼–è¯‘æ—¶ç”¨äº† <code>--with-mysql=mysqlnd</code> â†’ è°ƒç”¨ <strong>mysqlnd</strong></li>
<li>å¦‚æœç”¨äº† <code>--with-mysql-libs=/usr</code> â†’ è°ƒç”¨ <strong>libmysqlclient</strong>ï¼ˆå·²ç½•è§ï¼‰</li>
</ul>
</li>
<li><strong>åº•å±‚åº“å»ºç«‹ TCP è¿æ¥ï¼Œæ‰§è¡Œ MySQL åè®®é€šä¿¡</strong></li>
<li><strong>ç»“æœè¿”å›ç»™ <code>pdo_mysql</code> â†’ PDO â†’ ç”¨æˆ·ä»£ç </strong></li>
</ol>
<hr>
<h2 id="-å…­ç‰ˆæœ¬å¯¹æ¯”æ€»ç»“è¡¨">ğŸ“Š å…­ã€ç‰ˆæœ¬å¯¹æ¯”æ€»ç»“è¡¨</h2>
<table>
  <thead>
      <tr>
          <th>PHP ç‰ˆæœ¬</th>
          <th>mysql_* å‡½æ•°</th>
          <th>é»˜è®¤ MySQL å®¢æˆ·ç«¯</th>
          <th>PDO é©±åŠ¨</th>
          <th>å¤‡æ³¨</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>5.0 â€“ 5.2</strong></td>
          <td>âœ… å­˜åœ¨</td>
          <td><code>libmysqlclient</code></td>
          <td><code>pdo_mysql</code>ï¼ˆä¾èµ– libmysqlï¼‰</td>
          <td>éœ€æ‰‹åŠ¨å®‰è£… MySQL å®¢æˆ·ç«¯åº“</td>
      </tr>
      <tr>
          <td><strong>5.3 â€“ 5.4</strong></td>
          <td>âœ… å­˜åœ¨</td>
          <td><strong><code>mysqlnd</code>ï¼ˆå¯é€‰ï¼Œé»˜è®¤ï¼‰</strong></td>
          <td><code>pdo_mysql</code>ï¼ˆå¯é€‰ mysqlndï¼‰</td>
          <td><code>mysqlnd</code> é¦–æ¬¡å¼•å…¥</td>
      </tr>
      <tr>
          <td><strong>5.5 â€“ 5.6</strong></td>
          <td>âš ï¸ Deprecated</td>
          <td><strong><code>mysqlnd</code>ï¼ˆæ¨èï¼‰</strong></td>
          <td><code>pdo_mysql</code>ï¼ˆé»˜è®¤ mysqlndï¼‰</td>
          <td>å¼€å§‹æ·˜æ±°æ—§å‡½æ•°</td>
      </tr>
      <tr>
          <td><strong>7.0 â€“ 7.4</strong></td>
          <td>âŒ ç§»é™¤</td>
          <td><strong><code>mysqlnd</code>ï¼ˆä¸»æµï¼‰</strong></td>
          <td><code>pdo_mysql</code>ï¼ˆå‡ ä¹éƒ½ç”¨ mysqlndï¼‰</td>
          <td>æ€§èƒ½å¤§å¹…æå‡</td>
      </tr>
      <tr>
          <td><strong>8.0 â€“ 8.3+</strong></td>
          <td>âŒ ä¸å­˜åœ¨</td>
          <td><strong><code>mysqlnd</code>ï¼ˆå”¯ä¸€å®˜æ–¹æ”¯æŒï¼‰</strong></td>
          <td><code>pdo_mysql</code>ï¼ˆç»‘å®š mysqlndï¼‰</td>
          <td><code>libmysqlclient</code> åŸºæœ¬æ·˜æ±°</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-ä¸ƒæœ€ä½³å®è·µå»ºè®®2025-å¹´">âœ… ä¸ƒã€æœ€ä½³å®è·µå»ºè®®ï¼ˆ2025 å¹´ï¼‰</h2>
<ol>
<li><strong>æ°¸è¿œä¸è¦ç”¨ <code>mysql_*</code> å‡½æ•°</strong>ï¼ˆå·²ä¸å­˜åœ¨äº PHP 7+ï¼‰ã€‚</li>
<li><strong>ä¼˜å…ˆä½¿ç”¨ <code>PDO</code> æˆ– <code>MySQLi</code></strong>ï¼š
<ul>
<li><code>PDO</code>ï¼šè·¨æ•°æ®åº“å…¼å®¹æ€§å¥½ï¼Œæ”¯æŒé¢„å¤„ç†ã€‚</li>
<li><code>MySQLi</code>ï¼šåŠŸèƒ½æ›´ä¸°å¯Œï¼ˆå¦‚å¼‚æ­¥æŸ¥è¯¢ã€å­˜å‚¨è¿‡ç¨‹ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>ç¡®ä¿ä½¿ç”¨ <code>mysqlnd</code></strong>ï¼š
<ul>
<li>æ£€æŸ¥ <code>phpinfo()</code> ä¸­ MySQL æ‰©å±•çš„ &quot;Client API version&quot; æ˜¯å¦å« <code>mysqlnd</code>ã€‚</li>
<li>åœ¨ Docker æˆ–è‡ªç¼–è¯‘ PHP æ—¶ï¼Œ<strong>ä¸è¦æŒ‡å®š <code>--with-mysql</code> è·¯å¾„</strong>ï¼Œè®©å…¶è‡ªåŠ¨ç”¨ mysqlndã€‚</li>
</ul>
</li>
<li><strong>åˆ©ç”¨ <code>mysqlnd</code> ç‰¹æ€§</strong>ï¼š
<ul>
<li>ä½¿ç”¨ <code>mysqli::get_connection_stats()</code> ç›‘æ§è¿æ¥æ€§èƒ½ï¼›</li>
<li>å¯ç”¨ <code>mysqlnd</code> çš„å†…å­˜ç¼“å­˜ï¼ˆéœ€é…ç½®ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<hr>
<h2 id="-é™„å¦‚ä½•ç¡®è®¤ä½ çš„-php-ä½¿ç”¨-mysqlnd">ğŸ” é™„ï¼šå¦‚ä½•ç¡®è®¤ä½ çš„ PHP ä½¿ç”¨ mysqlndï¼Ÿ</h2>
<h3 id="æ–¹æ³•-1phpinfo">æ–¹æ³• 1ï¼š<code>phpinfo()</code></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span> <span class="nx">phpinfo</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>æœç´¢ï¼š</p>
<ul>
<li><code>mysql</code> â†’ çœ‹ &quot;Client API version&quot;</li>
<li><code>mysqli</code> â†’ åŒä¸Š</li>
<li><code>pdo_mysql</code> â†’ åŒä¸Š<br>
å¦‚æœæ˜¾ç¤º <code>mysqlnd 8.1.10</code> ä¹‹ç±»ï¼Œå°±æ˜¯ mysqlndã€‚</li>
</ul>
<h3 id="æ–¹æ³•-2å‘½ä»¤è¡Œ">æ–¹æ³• 2ï¼šå‘½ä»¤è¡Œ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">php -r <span class="s2">&#34;phpinfo();&#34;</span> <span class="p">|</span> grep <span class="s2">&#34;Client API&#34;</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1"># è¾“å‡ºï¼šClient API version =&gt; mysqlnd 8.1.10</span>
</span></span></code></pre></div><h3 id="æ–¹æ³•-3ä»£ç æ£€æµ‹">æ–¹æ³• 3ï¼šä»£ç æ£€æµ‹</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">defined</span><span class="p">(</span><span class="s1">&#39;PDO::ATTR_DRIVER_NAME&#39;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="nv">$pdo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PDO</span><span class="p">(</span><span class="s1">&#39;mysql:host=127.0.0.1;dbname=mysql&#39;</span><span class="p">,</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$pdo</span><span class="o">-&gt;</span><span class="na">getAttribute</span><span class="p">(</span><span class="nx">PDO</span><span class="o">::</span><span class="na">ATTR_DRIVER_NAME</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;mysql&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;PDO MySQL é©±åŠ¨å·²åŠ è½½</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">        <span class="c1">// åº•å±‚æ˜¯å¦ mysqlnd éœ€çœ‹ phpinfo
</span></span></span><span class="line"><span class="ln">6</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><hr>
<h2 id="-æ€»ç»“-5">ğŸ“Œ æ€»ç»“</h2>
<ul>
<li><strong><code>mysqlnd</code> æ˜¯ PHP å®˜æ–¹ç»´æŠ¤çš„ MySQL å®¢æˆ·ç«¯åº“</strong>ï¼Œä» <strong>PHP 5.3 å¼•å…¥</strong>ï¼Œ<strong>PHP 7+ æˆä¸ºé»˜è®¤å’Œæ¨è</strong>ï¼Œ<strong>PHP 8+ åŸºæœ¬å”¯ä¸€é€‰æ‹©</strong>ã€‚</li>
<li><strong>PDO æ˜¯æ•°æ®åº“æŠ½è±¡å±‚</strong>ï¼Œ<code>pdo_mysql</code> æ˜¯å…¶å®ç° MySQL æ”¯æŒçš„é©±åŠ¨ï¼Œ<strong>å®ƒä¾èµ–åº•å±‚å®¢æˆ·ç«¯åº“ï¼ˆmysqlnd æˆ– libmysqlclientï¼‰</strong>ã€‚</li>
<li><strong>ç°ä»£ PHP å¼€å‘ä¸­ï¼Œä½ åªéœ€å…³å¿ƒ PDO æˆ– MySQLiï¼Œåº•å±‚ mysqlnd ä¼šè‡ªåŠ¨å·¥ä½œ</strong>ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚</li>
</ul>
<blockquote>
<p>ğŸ’¡ ç®€å•è®°å¿†ï¼š<br>
<strong>â€œPDO æ˜¯æ–¹å‘ç›˜ï¼Œpdo_mysql æ˜¯ä¼ åŠ¨è½´ï¼Œmysqlnd æ˜¯å‘åŠ¨æœºã€‚â€</strong></p>
</blockquote>
<h1 id="php-ä¸­çš„-åå°„reflection-æ˜¯ä¸€ç§å¼ºå¤§çš„æœºåˆ¶å…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶æ£€æŸ¥ç±»æ–¹æ³•å±æ€§å‡½æ•°æ‰©å±•ç­‰çš„å†…éƒ¨ç»“æ„ç”šè‡³å¯ä»¥åŠ¨æ€è°ƒç”¨æ–¹æ³•è®¿é—®ç§æœ‰æˆå‘˜åˆ›å»ºå¯¹è±¡å®ä¾‹å®ƒå¹¿æ³›åº”ç”¨äºæ¡†æ¶å¦‚-laravelsymfonyormä¾èµ–æ³¨å…¥å®¹å™¨è°ƒè¯•å·¥å…·å’Œè‡ªåŠ¨åŒ–æµ‹è¯•ä¸­">PHP ä¸­çš„ <strong>åå°„ï¼ˆReflectionï¼‰</strong> æ˜¯ä¸€ç§å¼ºå¤§çš„æœºåˆ¶ï¼Œå…è®¸ç¨‹åºåœ¨<strong>è¿è¡Œæ—¶æ£€æŸ¥ç±»ã€æ–¹æ³•ã€å±æ€§ã€å‡½æ•°ã€æ‰©å±•ç­‰çš„å†…éƒ¨ç»“æ„</strong>ï¼Œç”šè‡³å¯ä»¥<strong>åŠ¨æ€è°ƒç”¨æ–¹æ³•ã€è®¿é—®ç§æœ‰æˆå‘˜ã€åˆ›å»ºå¯¹è±¡å®ä¾‹</strong>ã€‚å®ƒå¹¿æ³›åº”ç”¨äºæ¡†æ¶ï¼ˆå¦‚ Laravelã€Symfonyï¼‰ã€ORMã€ä¾èµ–æ³¨å…¥å®¹å™¨ã€è°ƒè¯•å·¥å…·å’Œè‡ªåŠ¨åŒ–æµ‹è¯•ä¸­ã€‚</h1>
<hr>
<h2 id="-ä¸€ä»€ä¹ˆæ˜¯åå°„">ğŸ” ä¸€ã€ä»€ä¹ˆæ˜¯åå°„ï¼Ÿ</h2>
<blockquote>
<p><strong>åå°„ = è‡ªçœï¼ˆIntrospectionï¼‰ + åŠ¨æ€æ“ä½œ</strong></p>
</blockquote>
<ul>
<li><strong>è‡ªçœ</strong>ï¼šè·å–ç±»/æ–¹æ³•/å±æ€§çš„å…ƒä¿¡æ¯ï¼ˆå¦‚åç§°ã€ä¿®é¥°ç¬¦ã€å‚æ•°ã€æ³¨è§£ç­‰ï¼‰ã€‚</li>
<li><strong>åŠ¨æ€æ“ä½œ</strong>ï¼šåœ¨è¿è¡Œæ—¶è°ƒç”¨æ–¹æ³•ã€è®¾ç½®å±æ€§å€¼ï¼Œå³ä½¿å®ƒä»¬æ˜¯ <code>private</code> æˆ– <code>protected</code>ã€‚</li>
</ul>
<p>PHP çš„åå°„åŠŸèƒ½ç”±ä¸€ç»„å†…ç½®ç±»æä¾›ï¼Œå…¨éƒ¨ä½äº <strong><code>Reflection</code> æ‰©å±•</strong>ä¸­ï¼ˆé»˜è®¤å¯ç”¨ï¼Œæ— éœ€é¢å¤–å®‰è£…ï¼‰ã€‚</p>
<hr>
<h2 id="-äºŒæ ¸å¿ƒåå°„ç±»æ¦‚è§ˆ">ğŸ§± äºŒã€æ ¸å¿ƒåå°„ç±»æ¦‚è§ˆ</h2>
<table>
  <thead>
      <tr>
          <th>åå°„ç±»</th>
          <th>ä½œç”¨</th>
          <th>å¯¹åº”ç›®æ ‡</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>ReflectionClass</code></td>
          <td>åå°„ç±»</td>
          <td><code>class</code></td>
      </tr>
      <tr>
          <td><code>ReflectionMethod</code></td>
          <td>åå°„æ–¹æ³•</td>
          <td><code>function/method</code></td>
      </tr>
      <tr>
          <td><code>ReflectionProperty</code></td>
          <td>åå°„å±æ€§</td>
          <td><code>property</code></td>
      </tr>
      <tr>
          <td><code>ReflectionFunction</code></td>
          <td>åå°„å‡½æ•°</td>
          <td>å…¨å±€å‡½æ•°</td>
      </tr>
      <tr>
          <td><code>ReflectionParameter</code></td>
          <td>åå°„å‚æ•°</td>
          <td>å‡½æ•°/æ–¹æ³•çš„å‚æ•°</td>
      </tr>
      <tr>
          <td><code>ReflectionExtension</code></td>
          <td>åå°„æ‰©å±•</td>
          <td>PHP æ‰©å±•ï¼ˆå¦‚ <code>mysqli</code>ï¼‰</td>
      </tr>
  </tbody>
</table>
<p>æ‰€æœ‰åå°„ç±»éƒ½ç»§æ‰¿è‡ª <code>Reflector</code> æ¥å£ã€‚</p>
<hr>
<h2 id="-ä¸‰å¸¸ç”¨åœºæ™¯ä¸ä»£ç ç¤ºä¾‹">ğŸ›  ä¸‰ã€å¸¸ç”¨åœºæ™¯ä¸ä»£ç ç¤ºä¾‹</h2>
<h3 id="-1-è·å–ç±»çš„åŸºæœ¬ä¿¡æ¯reflectionclass">âœ… 1. è·å–ç±»çš„åŸºæœ¬ä¿¡æ¯ï¼ˆ<code>ReflectionClass</code>ï¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">class</span> <span class="nc">User</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">private</span> <span class="nx">string</span> <span class="nv">$name</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="k">public</span> <span class="nx">int</span> <span class="nv">$age</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$name</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">name</span> <span class="o">=</span> <span class="nv">$name</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="k">private</span> <span class="k">function</span> <span class="nf">greet</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="k">return</span> <span class="s2">&#34;Hello, I&#39;m </span><span class="si">{</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">name</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nv">$ref</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ReflectionClass</span><span class="p">(</span><span class="nx">User</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="c1">// åŸºæœ¬ä¿¡æ¯
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="k">echo</span> <span class="s2">&#34;ç±»å: &#34;</span> <span class="o">.</span> <span class="nv">$ref</span><span class="o">-&gt;</span><span class="na">getName</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>           <span class="c1">// User
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="k">echo</span> <span class="s2">&#34;æ˜¯å¦ä¸ºå†…éƒ¨ç±»? &#34;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$ref</span><span class="o">-&gt;</span><span class="na">isInternal</span><span class="p">()</span> <span class="o">?</span> <span class="s1">&#39;æ˜¯&#39;</span> <span class="o">:</span> <span class="s1">&#39;å¦&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span> <span class="c1">// å¦
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="k">echo</span> <span class="s2">&#34;æ‰€åœ¨æ–‡ä»¶: &#34;</span> <span class="o">.</span> <span class="nv">$ref</span><span class="o">-&gt;</span><span class="na">getFileName</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="c1">// è·å–æ‰€æœ‰æ–¹æ³•ï¼ˆåŒ…æ‹¬ privateï¼‰
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="nv">$methods</span> <span class="o">=</span> <span class="nv">$ref</span><span class="o">-&gt;</span><span class="na">getMethods</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$methods</span> <span class="k">as</span> <span class="nv">$method</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;æ–¹æ³•: &#34;</span> <span class="o">.</span> <span class="nv">$method</span><span class="o">-&gt;</span><span class="na">getName</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34; (å¯è§æ€§: &#34;</span> <span class="o">.</span> <span class="nv">$method</span><span class="o">-&gt;</span><span class="na">getModifiers</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="c1">// è·å–æ‰€æœ‰å±æ€§
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="nv">$props</span> <span class="o">=</span> <span class="nv">$ref</span><span class="o">-&gt;</span><span class="na">getProperties</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$props</span> <span class="k">as</span> <span class="nv">$prop</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;å±æ€§: &#34;</span> <span class="o">.</span> <span class="nv">$prop</span><span class="o">-&gt;</span><span class="na">getName</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><hr>
<h3 id="-2-åŠ¨æ€è°ƒç”¨ç§æœ‰æ–¹æ³•çªç ´å°è£…">âœ… 2. åŠ¨æ€è°ƒç”¨ç§æœ‰æ–¹æ³•ï¼ˆçªç ´å°è£…ï¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">$user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">(</span><span class="s2">&#34;Alice&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="nv">$method</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ReflectionMethod</span><span class="p">(</span><span class="nx">User</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;greet&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="nv">$method</span><span class="o">-&gt;</span><span class="na">setAccessible</span><span class="p">(</span><span class="k">true</span><span class="p">);</span> <span class="c1">// âš ï¸ å…è®¸è®¿é—® private/protected
</span></span></span><span class="line"><span class="ln">5</span><span class="cl">
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nv">$result</span> <span class="o">=</span> <span class="nv">$method</span><span class="o">-&gt;</span><span class="na">invoke</span><span class="p">(</span><span class="nv">$user</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="k">echo</span> <span class="nv">$result</span><span class="p">;</span> <span class="c1">// Hello, I&#39;m Alice
</span></span></span></code></pre></div><blockquote>
<p>ğŸ’¡ <strong>æ³¨æ„</strong>ï¼šè¿™ç ´åäº†å°è£…æ€§ï¼Œä»…ç”¨äºæµ‹è¯•ã€è°ƒè¯•æˆ–æ¡†æ¶å†…éƒ¨ï¼Œ<strong>ä¸è¦åœ¨ä¸šåŠ¡é€»è¾‘ä¸­æ»¥ç”¨</strong>ã€‚</p>
</blockquote>
<hr>
<h3 id="-3-åŠ¨æ€è®¾ç½®ç§æœ‰å±æ€§">âœ… 3. åŠ¨æ€è®¾ç½®ç§æœ‰å±æ€§</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nv">$user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">(</span><span class="s2">&#34;Bob&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nv">$prop</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ReflectionProperty</span><span class="p">(</span><span class="nx">User</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nv">$prop</span><span class="o">-&gt;</span><span class="na">setAccessible</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nv">$prop</span><span class="o">-&gt;</span><span class="na">setValue</span><span class="p">(</span><span class="nv">$user</span><span class="p">,</span> <span class="s2">&#34;Charlie&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="c1">// å†æ¬¡è°ƒç”¨ greetï¼ˆéœ€é‡æ–°åå°„ï¼‰
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="nv">$method</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ReflectionMethod</span><span class="p">(</span><span class="nx">User</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;greet&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="nv">$method</span><span class="o">-&gt;</span><span class="na">setAccessible</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="k">echo</span> <span class="nv">$method</span><span class="o">-&gt;</span><span class="na">invoke</span><span class="p">(</span><span class="nv">$user</span><span class="p">);</span> <span class="c1">// Hello, I&#39;m Charlie
</span></span></span></code></pre></div><hr>
<h3 id="-4-åˆ†ææ–¹æ³•å‚æ•°ç”¨äºä¾èµ–æ³¨å…¥">âœ… 4. åˆ†ææ–¹æ³•å‚æ•°ï¼ˆç”¨äºä¾èµ–æ³¨å…¥ï¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">class</span> <span class="nc">Service</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">handle</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$req</span><span class="p">,</span> <span class="nx">Logger</span> <span class="nv">$logger</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">        <span class="c1">// ...
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="nv">$method</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ReflectionMethod</span><span class="p">(</span><span class="nx">Service</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;handle&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="nv">$params</span> <span class="o">=</span> <span class="nv">$method</span><span class="o">-&gt;</span><span class="na">getParameters</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$params</span> <span class="k">as</span> <span class="nv">$param</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;å‚æ•°å: &#34;</span> <span class="o">.</span> <span class="nv">$param</span><span class="o">-&gt;</span><span class="na">getName</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;ç±»å‹: &#34;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$param</span><span class="o">-&gt;</span><span class="na">hasType</span><span class="p">()</span> <span class="o">?</span> <span class="nv">$param</span><span class="o">-&gt;</span><span class="na">getType</span><span class="p">()</span> <span class="o">:</span> <span class="s1">&#39;mixed&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="c1">// è·å–ç±»å‹æç¤ºï¼ˆPHP 7+ï¼‰
</span></span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$param</span><span class="o">-&gt;</span><span class="na">hasType</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="nv">$type</span> <span class="o">=</span> <span class="nv">$param</span><span class="o">-&gt;</span><span class="na">getType</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$type</span> <span class="nx">instanceof</span> <span class="nx">ReflectionNamedType</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;å…·ä½“ç±»å‹: &#34;</span> <span class="o">.</span> <span class="nv">$type</span><span class="o">-&gt;</span><span class="na">getName</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>ğŸŒŸ <strong>è¿™å°±æ˜¯ Laravel/Symfony å®¹å™¨è‡ªåŠ¨è§£æä¾èµ–çš„åŸç†ï¼</strong></p>
</blockquote>
<hr>
<h3 id="-5-è¯»å–æ³¨è§£docblock-é…åˆ-doctrine-annotations">âœ… 5. è¯»å–æ³¨è§£ï¼ˆDocBlockï¼‰â€”â€” é…åˆ Doctrine Annotations</h3>
<p>è™½ç„¶åŸç”Ÿåå°„ä¸ç›´æ¥è§£ææ³¨è§£ï¼Œä½†å¯è·å–æ³¨é‡Šæ–‡æœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="sd">/**
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="sd"> * @Entity(table=&#34;users&#34;)
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="sd"> * @Author(name=&#34;John&#34;)
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="sd"> */</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">class</span> <span class="nc">User</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="sd">     * @Column(type=&#34;string&#34;, length=100)
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="k">private</span> <span class="nx">string</span> <span class="nv">$email</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nv">$ref</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ReflectionClass</span><span class="p">(</span><span class="nx">User</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">echo</span> <span class="nv">$ref</span><span class="o">-&gt;</span><span class="na">getDocComment</span><span class="p">();</span> <span class="c1">// è¾“å‡ºå®Œæ•´çš„ /** ... */ æ³¨é‡Š
</span></span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1">// éœ€è¦ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ doctrine/annotationsï¼‰æ¥è§£æ @Entity ç­‰
</span></span></span></code></pre></div><hr>
<h3 id="-6-åŠ¨æ€åˆ›å»ºå¯¹è±¡å¸¦å‚æ•°">âœ… 6. åŠ¨æ€åˆ›å»ºå¯¹è±¡ï¼ˆå¸¦å‚æ•°ï¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">$ref</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ReflectionClass</span><span class="p">(</span><span class="nx">User</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nv">$user</span> <span class="o">=</span> <span class="nv">$ref</span><span class="o">-&gt;</span><span class="na">newInstanceArgs</span><span class="p">([</span><span class="s2">&#34;David&#34;</span><span class="p">]);</span> <span class="c1">// ç›¸å½“äº new User(&#34;David&#34;)
</span></span></span></code></pre></div><blockquote>
<p>æ¯” <code>new $className(...$args)</code> æ›´å®‰å…¨ï¼Œå°¤å…¶å¤„ç†å¤æ‚æ„é€ å‡½æ•°æ—¶ã€‚</p>
</blockquote>
<hr>
<h2 id="-å››åå°„-vs-å…¶ä»–åŠ¨æ€æœºåˆ¶">âš™ï¸ å››ã€åå°„ vs å…¶ä»–åŠ¨æ€æœºåˆ¶</h2>
<table>
  <thead>
      <tr>
          <th>æ–¹å¼</th>
          <th>èƒ½åŠ›</th>
          <th>æ€§èƒ½</th>
          <th>å®‰å…¨æ€§</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>åå°„</strong></td>
          <td>æœ€å¼ºï¼ˆå¯è®¿é—® privateï¼Œè·å–å…ƒæ•°æ®ï¼‰</td>
          <td>è¾ƒæ…¢ï¼ˆä½†ç°ä»£ PHP å·²ä¼˜åŒ–ï¼‰</td>
          <td>å¯ç»•è¿‡å°è£…</td>
      </tr>
      <tr>
          <td><code>call_user_func()</code></td>
          <td>åªèƒ½è°ƒç”¨ public æ–¹æ³•</td>
          <td>å¿«</td>
          <td>å®‰å…¨</td>
      </tr>
      <tr>
          <td><code>$obj-&gt;$method()</code></td>
          <td>åªèƒ½è°ƒç”¨ public æ–¹æ³•</td>
          <td>å¿«</td>
          <td>å®‰å…¨</td>
      </tr>
      <tr>
          <td><code>eval()</code></td>
          <td>ä»»æ„ä»£ç æ‰§è¡Œ</td>
          <td>æ…¢</td>
          <td>âŒ æåº¦å±é™©</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>âœ… <strong>åå°„æ˜¯â€œå¯æ§çš„åŠ¨æ€æ€§â€</strong>ï¼Œæ¯” <code>eval</code> å®‰å…¨å¾—å¤šã€‚</p>
</blockquote>
<hr>
<h2 id="-äº”æ€§èƒ½ä¸æ³¨æ„äº‹é¡¹">âš ï¸ äº”ã€æ€§èƒ½ä¸æ³¨æ„äº‹é¡¹</h2>
<h3 id="1-æ€§èƒ½å¼€é”€">1. <strong>æ€§èƒ½å¼€é”€</strong></h3>
<ul>
<li>åå°„æ¯”ç›´æ¥è°ƒç”¨æ…¢ <strong>10~100 å€</strong>ï¼ˆä½†ç°ä»£ PHP 8 JIT å·²å¤§å¹…æ”¹å–„ï¼‰ã€‚</li>
<li><strong>å»ºè®®</strong>ï¼šåœ¨å¯åŠ¨é˜¶æ®µï¼ˆå¦‚æ¡†æ¶åˆå§‹åŒ–ï¼‰ä½¿ç”¨åå°„åˆ†æç±»ç»“æ„ï¼Œç¼“å­˜ç»“æœï¼Œè¿è¡Œæ—¶é¿å…é‡å¤åå°„ã€‚</li>
</ul>
<h3 id="2-ä¸è¦æ»¥ç”¨">2. <strong>ä¸è¦æ»¥ç”¨</strong></h3>
<ul>
<li>åå°„æ‰“ç ´äº†å°è£…åŸåˆ™ï¼Œä½¿ä»£ç éš¾ä»¥ç†è§£å’Œç»´æŠ¤ã€‚</li>
<li>ä»…ç”¨äºï¼š
<ul>
<li>æ¡†æ¶å¼€å‘ï¼ˆè·¯ç”±ã€ORMã€DIï¼‰</li>
<li>å•å…ƒæµ‹è¯•ï¼ˆMock ç§æœ‰æ–¹æ³•ï¼‰</li>
<li>è°ƒè¯•å·¥å…·ï¼ˆvar_dump æ›¿ä»£å“ï¼‰</li>
</ul>
</li>
</ul>
<h3 id="3-opcache-å½±å“">3. <strong>OPcache å½±å“</strong></h3>
<ul>
<li>åå°„ç»“æœ<strong>ä¸å— OPcache å½±å“</strong>ï¼Œå› ä¸ºå®ƒæ˜¯è¿è¡Œæ—¶è¡Œä¸ºã€‚</li>
</ul>
<hr>
<h2 id="-å…­é«˜çº§æŠ€å·§é€’å½’åå°„å±æ€§php-80">ğŸ§ª å…­ã€é«˜çº§æŠ€å·§ï¼šé€’å½’åå°„å±æ€§ï¼ˆPHP 8.0+ï¼‰</h2>
<p>PHP 8 å¼•å…¥äº†å¯¹ <strong>Typed Properties</strong> çš„æ›´å¥½æ”¯æŒï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">class</span> <span class="nc">Config</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">public</span> <span class="nx">string</span> <span class="nv">$host</span> <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="k">public</span> <span class="nx">int</span> <span class="nv">$port</span> <span class="o">=</span> <span class="mi">3306</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">private</span> <span class="nx">bool</span> <span class="nv">$debug</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="nv">$ref</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ReflectionClass</span><span class="p">(</span><span class="nx">Config</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$ref</span><span class="o">-&gt;</span><span class="na">getProperties</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$prop</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="nv">$prop</span><span class="o">-&gt;</span><span class="na">setAccessible</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="nv">$type</span> <span class="o">=</span> <span class="nv">$prop</span><span class="o">-&gt;</span><span class="na">getType</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;</span><span class="si">{</span><span class="nv">$prop</span><span class="o">-&gt;</span><span class="na">getName</span><span class="p">()</span><span class="si">}</span><span class="s2">: &#34;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$type</span> <span class="o">?</span> <span class="nv">$type</span><span class="o">-&gt;</span><span class="na">getName</span><span class="p">()</span> <span class="o">:</span> <span class="s1">&#39;mixed&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&#34; = &#34;</span> <span class="o">.</span> <span class="nv">$prop</span><span class="o">-&gt;</span><span class="na">getValue</span><span class="p">(</span><span class="k">new</span> <span class="nx">Config</span><span class="p">())</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><hr>
<h2 id="-ä¸ƒçœŸå®ä¸–ç•Œåº”ç”¨">ğŸ“¦ ä¸ƒã€çœŸå®ä¸–ç•Œåº”ç”¨</h2>
<table>
  <thead>
      <tr>
          <th>æ¡†æ¶/å·¥å…·</th>
          <th>åå°„ç”¨é€”</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Laravel</strong></td>
          <td>æœåŠ¡å®¹å™¨è§£æä¾èµ–ã€äº‹ä»¶ç›‘å¬å™¨å‘ç°</td>
      </tr>
      <tr>
          <td><strong>Symfony</strong></td>
          <td>æ§åˆ¶å™¨å‚æ•°è§£æã€Validator ç»„ä»¶</td>
      </tr>
      <tr>
          <td><strong>Doctrine ORM</strong></td>
          <td>å®ä½“æ˜ å°„ï¼ˆ@Column è§£æï¼‰ã€å»¶è¿ŸåŠ è½½ä»£ç†</td>
      </tr>
      <tr>
          <td><strong>PHPUnit</strong></td>
          <td>æµ‹è¯•æ–¹æ³•å‘ç°ã€Mock å¯¹è±¡ç”Ÿæˆ</td>
      </tr>
      <tr>
          <td><strong>Composer</strong></td>
          <td>è‡ªåŠ¨åŠ è½½ç±»åˆ†æï¼ˆéƒ¨åˆ†ï¼‰</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-æ€»ç»“-6">âœ… æ€»ç»“</h2>
<table>
  <thead>
      <tr>
          <th>é—®é¢˜</th>
          <th>ç­”æ¡ˆ</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>åå°„æ˜¯ä»€ä¹ˆï¼Ÿ</strong></td>
          <td>è¿è¡Œæ—¶æ£€æŸ¥å’Œæ“ä½œç±»/æ–¹æ³•/å±æ€§çš„æœºåˆ¶</td>
      </tr>
      <tr>
          <td><strong>éœ€è¦å®‰è£…å—ï¼Ÿ</strong></td>
          <td>âŒ é»˜è®¤å¯ç”¨ï¼ˆ<code>Reflection</code> æ‰©å±•ï¼‰</td>
      </tr>
      <tr>
          <td><strong>èƒ½è®¿é—® private æˆå‘˜å—ï¼Ÿ</strong></td>
          <td>âœ… é€šè¿‡ <code>setAccessible(true)</code></td>
      </tr>
      <tr>
          <td><strong>æ€§èƒ½å¦‚ä½•ï¼Ÿ</strong></td>
          <td>æ¯”ç›´æ¥è°ƒç”¨æ…¢ï¼Œä½†å¯æ¥å—ï¼ˆé¿å…å¾ªç¯å†…ä½¿ç”¨ï¼‰</td>
      </tr>
      <tr>
          <td><strong>å…¸å‹ç”¨é€”ï¼Ÿ</strong></td>
          <td>æ¡†æ¶ã€ORMã€DIã€æµ‹è¯•ã€è°ƒè¯•</td>
      </tr>
      <tr>
          <td><strong>å±é™©å—ï¼Ÿ</strong></td>
          <td>æ»¥ç”¨ä¼šç ´åå°è£…ï¼Œä½†æ¯” <code>eval</code> å®‰å…¨</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>ğŸ’¡ <strong>è®°ä½</strong>ï¼š<br>
<strong>â€œåå°„æ˜¯æ¡†æ¶ä½œè€…çš„åˆ©å™¨ï¼Œä¸æ˜¯ä¸šåŠ¡ä»£ç çš„ç©å…·ã€‚â€</strong></p>
</blockquote>
<h1 id="php-çš„-ç”Ÿæˆå™¨generator-æ˜¯ä¸€ç§ç®€å•å†…å­˜é«˜æ•ˆçš„æ–¹å¼æ¥å®ç°è¿­ä»£å™¨iteratoræ— éœ€æ‰‹åŠ¨ç¼–å†™å®Œæ•´çš„-iterator-æ¥å£ç±»å®ƒä»-php-55-å¼€å§‹å¼•å…¥ç‰¹åˆ«é€‚åˆå¤„ç†å¤§é‡æ•°æ®æˆ–æ— é™åºåˆ—çš„åœºæ™¯">PHP çš„ <strong>ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰</strong> æ˜¯ä¸€ç§ç®€å•ã€å†…å­˜é«˜æ•ˆçš„æ–¹å¼æ¥å®ç°<strong>è¿­ä»£å™¨ï¼ˆIteratorï¼‰</strong>ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–å†™å®Œæ•´çš„ <code>Iterator</code> æ¥å£ç±»ã€‚å®ƒä» <strong>PHP 5.5</strong> å¼€å§‹å¼•å…¥ï¼Œç‰¹åˆ«é€‚åˆå¤„ç†<strong>å¤§é‡æ•°æ®</strong>æˆ–<strong>æ— é™åºåˆ—</strong>çš„åœºæ™¯ã€‚</h1>
<hr>
<h2 id="-æ ¸å¿ƒæ¦‚å¿µ">âœ… æ ¸å¿ƒæ¦‚å¿µ</h2>
<ul>
<li>ä½¿ç”¨ <code>yield</code> å…³é”®å­—ä»£æ›¿ <code>return</code></li>
<li>æ¯æ¬¡è°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°æ—¶ï¼Œ<strong>ä¸ä¼šç«‹å³æ‰§è¡Œå‡½æ•°ä½“</strong>ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ª <code>Generator</code> å¯¹è±¡</li>
<li>æ¯æ¬¡è¿­ä»£ï¼ˆå¦‚ <code>foreach</code>ï¼‰æ—¶ï¼Œå‡½æ•°ä»ä¸Šæ¬¡ <code>yield</code> çš„ä½ç½®ç»§ç»­æ‰§è¡Œï¼Œç›´åˆ°ä¸‹ä¸€ä¸ª <code>yield</code> æˆ–ç»“æŸ</li>
</ul>
<hr>
<h2 id="-åŸºæœ¬è¯­æ³•">ğŸŒŸ åŸºæœ¬è¯­æ³•</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">function</span> <span class="nf">myGenerator</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="k">yield</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">yield</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="k">yield</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nx">myGenerator</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">    <span class="k">echo</span> <span class="nv">$value</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span> <span class="c1">// è¾“å‡º: 1 2 3
</span></span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>ğŸ’¡ æ³¨æ„ï¼š<code>myGenerator()</code> è¿”å›çš„æ˜¯ <code>Generator</code> å¯¹è±¡ï¼Œä¸æ˜¯æ•°ç»„ï¼</p>
</blockquote>
<hr>
<h2 id="-ä¸ºä»€ä¹ˆç”¨ç”Ÿæˆå™¨-å†…å­˜ä¼˜åŠ¿">ğŸ§  ä¸ºä»€ä¹ˆç”¨ç”Ÿæˆå™¨ï¼Ÿâ€”â€” å†…å­˜ä¼˜åŠ¿</h2>
<h3 id="-æ™®é€šå‡½æ•°åŠ è½½å…¨éƒ¨æ•°æ®åˆ°å†…å­˜">âŒ æ™®é€šå‡½æ•°ï¼ˆåŠ è½½å…¨éƒ¨æ•°æ®åˆ°å†…å­˜ï¼‰ï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">function</span> <span class="nf">getNumbers</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="nv">$numbers</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;=</span> <span class="mi">1000000</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">        <span class="nv">$numbers</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$i</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">    <span class="k">return</span> <span class="nv">$numbers</span><span class="p">;</span> <span class="c1">// å ç”¨å¤§é‡å†…å­˜
</span></span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="-ç”Ÿæˆå™¨ä¸€æ¬¡åªç”Ÿæˆä¸€ä¸ªå€¼">âœ… ç”Ÿæˆå™¨ï¼ˆä¸€æ¬¡åªç”Ÿæˆä¸€ä¸ªå€¼ï¼‰ï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">function</span> <span class="nf">getNumbers</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;=</span> <span class="mi">1000000</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">        <span class="k">yield</span> <span class="nv">$i</span><span class="p">;</span> <span class="c1">// æ¯æ¬¡åªè¿”å›ä¸€ä¸ªå€¼ï¼Œä¸å­˜å‚¨æ•´ä¸ªæ•°ç»„
</span></span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nx">getNumbers</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$num</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">    <span class="c1">// å¤„ç† $numï¼Œå†…å­˜å ç”¨æä½
</span></span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>ğŸ” <strong>å®æµ‹</strong>ï¼šå¤„ç†ç™¾ä¸‡çº§æ•°æ®æ—¶ï¼Œæ™®é€šæ•°ç»„å¯èƒ½å ç”¨å‡ ç™¾ MB å†…å­˜ï¼Œè€Œç”Ÿæˆå™¨ä»…å‡  KBï¼</p>
</blockquote>
<hr>
<h2 id="-é«˜çº§ç”¨æ³•">ğŸ› ï¸ é«˜çº§ç”¨æ³•</h2>
<h3 id="1-å¸¦-key-çš„-yield">1. <strong>å¸¦ key çš„ yield</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">function</span> <span class="nf">config</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="k">yield</span> <span class="s1">&#39;host&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;localhost&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">yield</span> <span class="s1">&#39;port&#39;</span> <span class="o">=&gt;</span> <span class="mi">3306</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nx">config</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;</span><span class="si">$key</span><span class="s2">: </span><span class="si">$value\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="2-yield-fromå§”æ‰˜ç”Ÿæˆå™¨">2. <strong>yield from</strong>ï¼ˆå§”æ‰˜ç”Ÿæˆå™¨ï¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">function</span> <span class="nf">gen1</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">yield</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="k">yield</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">function</span> <span class="nf">gen2</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">yield</span> <span class="nx">from</span> <span class="nx">gen1</span><span class="p">();</span> <span class="c1">// å§”æ‰˜ç»™ gen1
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="k">yield</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nx">gen2</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="k">echo</span> <span class="nv">$v</span><span class="p">;</span> <span class="c1">// 1 2 3
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="3-å‘é€å€¼ç»™ç”Ÿæˆå™¨åŒå‘é€šä¿¡">3. <strong>å‘é€å€¼ç»™ç”Ÿæˆå™¨ï¼ˆåŒå‘é€šä¿¡ï¼‰</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">function</span> <span class="nf">logger</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">        <span class="nv">$message</span> <span class="o">=</span> <span class="k">yield</span><span class="p">;</span> <span class="c1">// æ¥æ”¶å¤–éƒ¨ä¼ å…¥çš„å€¼
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;Log: </span><span class="si">$message\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="nv">$logger</span> <span class="o">=</span> <span class="nx">logger</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span><span class="s1">&#39;User logged in&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span><span class="s1">&#39;Error occurred&#39;</span><span class="p">);</span>
</span></span></code></pre></div><h3 id="4-è¿”å›æœ€ç»ˆå€¼php-7">4. <strong>è¿”å›æœ€ç»ˆå€¼ï¼ˆPHP 7+ï¼‰</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">function</span> <span class="nf">countdown</span><span class="p">(</span><span class="nv">$start</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="nv">$start</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">        <span class="k">yield</span> <span class="nv">$start</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="k">return</span> <span class="s2">&#34;Done!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="nv">$gen</span> <span class="o">=</span> <span class="nx">countdown</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$gen</span> <span class="k">as</span> <span class="nv">$val</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">echo</span> <span class="nv">$val</span> <span class="o">.</span> <span class="s2">&#34; &#34;</span><span class="p">;</span> <span class="c1">// 3 2 1
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="k">echo</span> <span class="nv">$gen</span><span class="o">-&gt;</span><span class="na">getReturn</span><span class="p">();</span> <span class="c1">// &#34;Done!&#34;
</span></span></span></code></pre></div><hr>
<h2 id="-æ³¨æ„äº‹é¡¹">âš ï¸ æ³¨æ„äº‹é¡¹</h2>
<table>
  <thead>
      <tr>
          <th>é—®é¢˜</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>ä¸èƒ½é‡å¤éå†</strong></td>
          <td><code>Generator</code> åªèƒ½éå†ä¸€æ¬¡ï¼Œå†æ¬¡éå†éœ€é‡æ–°è°ƒç”¨å‡½æ•°</td>
      </tr>
      <tr>
          <td><strong>ä¸èƒ½ <code>rewind()</code></strong></td>
          <td>ä¸æ”¯æŒé‡ç½®æŒ‡é’ˆï¼ˆé™¤éè‡ªå·±å®ç° <code>Iterator</code>ï¼‰</td>
      </tr>
      <tr>
          <td><strong>ä¸èƒ½åºåˆ—åŒ–</strong></td>
          <td><code>Generator</code> å¯¹è±¡ä¸å¯ <code>serialize()</code></td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-å…¸å‹åº”ç”¨åœºæ™¯">ğŸ“Œ å…¸å‹åº”ç”¨åœºæ™¯</h2>
<ol>
<li>
<p><strong>è¯»å–å¤§æ–‡ä»¶é€è¡Œå¤„ç†</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">function</span> <span class="nf">readLines</span><span class="p">(</span><span class="nv">$file</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="nv">$handle</span> <span class="o">=</span> <span class="nx">fopen</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="nx">feof</span><span class="p">(</span><span class="nv">$handle</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">        <span class="k">yield</span> <span class="nx">fgets</span><span class="p">(</span><span class="nv">$handle</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">    <span class="nx">fclose</span><span class="p">(</span><span class="nv">$handle</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
<li>
<p><strong>æ•°æ®åº“åˆ†é¡µæ‰¹é‡å¤„ç†</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">function</span> <span class="nf">fetchUsers</span><span class="p">(</span><span class="nv">$pdo</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$pdo</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&#34;SELECT * FROM users&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">        <span class="k">yield</span> <span class="nv">$row</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
<li>
<p><strong>æ— é™åºåˆ—ï¼ˆå¦‚æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼‰</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">function</span> <span class="nf">fibonacci</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="nv">$a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="k">yield</span> <span class="nv">$a</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">yield</span> <span class="nv">$b</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">        <span class="nv">$next</span> <span class="o">=</span> <span class="nv">$a</span> <span class="o">+</span> <span class="nv">$b</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">        <span class="k">yield</span> <span class="nv">$next</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="nv">$a</span> <span class="o">=</span> <span class="nv">$b</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="nv">$b</span> <span class="o">=</span> <span class="nv">$next</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
</ol>
<hr>
<h2 id="-æ€»ç»“-7">âœ… æ€»ç»“</h2>
<table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>å…³é”®å­—</strong></td>
          <td><code>yield</code></td>
      </tr>
      <tr>
          <td><strong>è¿”å›ç±»å‹</strong></td>
          <td><code>Generator</code>ï¼ˆå®ç°äº† <code>Iterator</code>ï¼‰</td>
      </tr>
      <tr>
          <td><strong>å†…å­˜æ•ˆç‡</strong></td>
          <td>æé«˜ï¼ˆæƒ°æ€§æ±‚å€¼ï¼‰</td>
      </tr>
      <tr>
          <td><strong>é€‚ç”¨ç‰ˆæœ¬</strong></td>
          <td>PHP â‰¥ 5.5</td>
      </tr>
      <tr>
          <td><strong>æ ¸å¿ƒä¼˜åŠ¿</strong></td>
          <td>ç”¨ç®€å•è¯­æ³•å®ç°é«˜æ•ˆè¿­ä»£ï¼Œé¿å… OOMï¼ˆå†…å­˜æº¢å‡ºï¼‰</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>ğŸ’¡ <strong>å»ºè®®</strong>ï¼šå½“ä½ éœ€è¦éå†å¤§é‡æ•°æ®ã€æµå¼å¤„ç†æˆ–å®ç°æƒ°æ€§è®¡ç®—æ—¶ï¼Œä¼˜å…ˆè€ƒè™‘ç”Ÿæˆå™¨ï¼</p>
</blockquote>
<h1 id="åœ¨-php-ä¸­ç”Ÿæˆå™¨generator-å’Œ-è¿­ä»£å™¨iterator-éƒ½æ˜¯ç”¨æ¥éå†æ•°æ®çš„å·¥å…·ä½†å®ƒä»¬çš„å®šä½å®ç°æ–¹å¼å’Œä½¿ç”¨åœºæ™¯å…¶å®å·®åˆ«æŒºå¤§çš„æˆ‘æ¥ç”¨è½»æ¾ä¸€ç‚¹çš„æ–¹å¼ç»™ä½ è®²æ¸…æ¥šé¡ºä¾¿åŠ ç‚¹äººè¯æ¯”å–»-">åœ¨ PHP ä¸­ï¼Œ<strong>ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰</strong> å’Œ <strong>è¿­ä»£å™¨ï¼ˆIteratorï¼‰</strong> éƒ½æ˜¯ç”¨æ¥â€œéå†æ•°æ®â€çš„å·¥å…·ï¼Œä½†å®ƒä»¬çš„å®šä½ã€å®ç°æ–¹å¼å’Œä½¿ç”¨åœºæ™¯å…¶å®å·®åˆ«æŒºå¤§çš„ã€‚æˆ‘æ¥ç”¨è½»æ¾ä¸€ç‚¹çš„æ–¹å¼ç»™ä½ è®²æ¸…æ¥šï¼Œé¡ºä¾¿åŠ ç‚¹â€œäººè¯â€æ¯”å–» ğŸ˜„</h1>
<hr>
<h3 id="-ä¸€å¥è¯æ€»ç»“">ğŸŒŸ ä¸€å¥è¯æ€»ç»“</h3>
<blockquote>
<p><strong>è¿­ä»£å™¨æ˜¯â€œæ¥å£è§„èŒƒâ€ï¼Œç”Ÿæˆå™¨æ˜¯â€œè‡ªåŠ¨å¸®ä½ å®ç°è¿™ä¸ªè§„èŒƒçš„æ‡’äººç¥å™¨â€ã€‚</strong></p>
</blockquote>
<p>æ¢å¥è¯è¯´ï¼š<br>
âœ… æ‰€æœ‰ç”Ÿæˆå™¨éƒ½æ˜¯è¿­ä»£å™¨ï¼ˆå› ä¸ºå®ƒä»¬èƒ½è¢« foreach éå†ï¼‰ï¼Œ<br>
âŒ ä½†ä¸æ˜¯æ‰€æœ‰è¿­ä»£å™¨éƒ½æ˜¯ç”Ÿæˆå™¨ã€‚</p>
<hr>
<h2 id="-1-è¿­ä»£å™¨iteratoræ‰‹åŠ¨æŒ¡æ±½è½¦">ğŸ”§ 1. è¿­ä»£å™¨ï¼ˆIteratorï¼‰â€”â€”â€œæ‰‹åŠ¨æŒ¡æ±½è½¦â€</h2>
<p>PHP çš„ <code>Iterator</code> æ˜¯ä¸€ä¸ª<strong>æ¥å£ï¼ˆinterfaceï¼‰</strong>ï¼Œä½ å¦‚æœæƒ³è‡ªå®šä¹‰ä¸€ä¸ªå¯éå†çš„å¯¹è±¡ï¼Œå°±å¾—<strong>æ‰‹åŠ¨å®ç° 5 ä¸ªæ–¹æ³•</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">class</span> <span class="nc">MyIterator</span> <span class="k">implements</span> <span class="nx">Iterator</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">private</span> <span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="k">private</span> <span class="nv">$position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">current</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">position</span><span class="p">];</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">key</span><span class="p">()</span>     <span class="p">{</span> <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">position</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">next</span><span class="p">()</span>    <span class="p">{</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">position</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">rewind</span><span class="p">()</span>  <span class="p">{</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">valid</span><span class="p">()</span>   <span class="p">{</span> <span class="k">return</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">position</span><span class="p">]);</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>âœ… <strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>å®Œå…¨å¯æ§ï¼ä½ å¯ä»¥è‡ªå®šä¹‰æ€ä¹ˆéå†ï¼ˆæ¯”å¦‚å€’åºã€è·³æ­¥ã€æ ‘å½¢ç»“æ„ç­‰ï¼‰</li>
<li>å¯ä»¥å¤šæ¬¡éå†ï¼ˆè°ƒç”¨ <code>rewind()</code> å°±èƒ½é‡æ¥ï¼‰</li>
</ul>
<p>âŒ <strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>å†™èµ·æ¥å•°å—¦ï¼Œ5 ä¸ªæ–¹æ³•ä¸€ä¸ªéƒ½ä¸èƒ½å°‘</li>
<li>é€šå¸¸éœ€è¦æå‰æŠŠæ‰€æœ‰æ•°æ®å­˜åœ¨å†…å­˜é‡Œï¼ˆæ¯”å¦‚ <code>$this-&gt;data</code> æ•°ç»„ï¼‰</li>
</ul>
<hr>
<h2 id="-2-ç”Ÿæˆå™¨generatorè‡ªåŠ¨é©¾é©¶æ±½è½¦">âš¡ 2. ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰â€”â€”â€œè‡ªåŠ¨é©¾é©¶æ±½è½¦â€</h2>
<p>PHP 5.5 å¼•å…¥äº† <code>yield</code> å…³é”®å­—ï¼Œåªè¦å‡½æ•°é‡Œç”¨äº† <code>yield</code>ï¼Œå®ƒå°±è‡ªåŠ¨å˜æˆä¸€ä¸ª<strong>ç”Ÿæˆå™¨å‡½æ•°</strong>ï¼Œè¿”å›çš„æ˜¯ <code>Generator</code> å¯¹è±¡ â€”â€” è€Œè¿™ä¸ªå¯¹è±¡<strong>å¤©ç„¶å°±æ˜¯ä¸€ä¸ªè¿­ä»£å™¨</strong>ï¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">function</span> <span class="nf">numberGenerator</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="k">yield</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">yield</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="k">yield</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nx">numberGenerator</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">    <span class="k">echo</span> <span class="nv">$n</span><span class="p">;</span> <span class="c1">// è¾“å‡º 123
</span></span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>âœ… <strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>ä»£ç è¶…ç®€æ´ï¼ä¸ç”¨å†™é‚£ 5 ä¸ªæ–¹æ³•</li>
<li><strong>æƒ°æ€§æ±‚å€¼ï¼ˆLazy Evaluationï¼‰</strong>ï¼šåªåœ¨éœ€è¦æ—¶æ‰ç”Ÿæˆä¸‹ä¸€ä¸ªå€¼</li>
<li><strong>å†…å­˜å ç”¨æä½</strong>ï¼šæ¯”å¦‚ç”Ÿæˆ 100 ä¸‡ä¸ªæ•°ï¼Œä¸ä¼šä¸€æ¬¡æ€§å¡è¿›å†…å­˜ï¼Œè€Œæ˜¯ä¸€æ¬¡åªå­˜ä¸€ä¸ªå€¼çš„çŠ¶æ€</li>
</ul>
<p>âŒ <strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li><strong>åªèƒ½éå†ä¸€æ¬¡</strong>ï¼éå†å®Œå°±â€œè€—å°½â€äº†ï¼Œä¸èƒ½ rewind é‡æ¥ï¼ˆé™¤éé‡æ–°è°ƒç”¨å‡½æ•°ï¼‰</li>
<li>æ— æ³•è‡ªå®šä¹‰å¤æ‚çš„éå†é€»è¾‘ï¼ˆæ¯”å¦‚ä¸èƒ½å€’ç€èµ°ï¼‰</li>
</ul>
<hr>
<h2 id="-å¯¹æ¯”è¡¨æ ¼php-è§†è§’">ğŸ†š å¯¹æ¯”è¡¨æ ¼ï¼ˆPHP è§†è§’ï¼‰</h2>
<table>
  <thead>
      <tr>
          <th>ç»´åº¦</th>
          <th>è¿­ä»£å™¨ï¼ˆIteratorï¼‰</th>
          <th>ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>æœ¬è´¨</strong></td>
          <td>æ¥å£ï¼ˆéœ€æ‰‹åŠ¨å®ç°ï¼‰</td>
          <td>å‡½æ•° + <code>yield</code> è‡ªåŠ¨ç”Ÿæˆ</td>
      </tr>
      <tr>
          <td><strong>å†…å­˜å ç”¨</strong></td>
          <td>é€šå¸¸é«˜ï¼ˆéœ€é¢„å­˜æ•°æ®ï¼‰</td>
          <td>æä½ï¼ˆæŒ‰éœ€ç”Ÿæˆï¼‰</td>
      </tr>
      <tr>
          <td><strong>ä»£ç å¤æ‚åº¦</strong></td>
          <td>é«˜ï¼ˆ5ä¸ªæ–¹æ³•ï¼‰</td>
          <td>è¶…ä½ï¼ˆä¸€è¡Œ <code>yield</code>ï¼‰</td>
      </tr>
      <tr>
          <td><strong>èƒ½å¦å¤šæ¬¡éå†</strong></td>
          <td>âœ… å¯ä»¥ï¼ˆ<code>rewind()</code>ï¼‰</td>
          <td>âŒ ä¸è¡Œï¼ˆä¸€æ¬¡æ€§ï¼‰</td>
      </tr>
      <tr>
          <td><strong>é€‚ç”¨åœºæ™¯</strong></td>
          <td>è‡ªå®šä¹‰éå†é€»è¾‘ã€å¤æ‚æ•°æ®ç»“æ„</td>
          <td>å¤§æ•°æ®æµã€æ— é™åºåˆ—ã€èŠ‚çœå†…å­˜</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-ä¸¾ä¸ªç”Ÿæ´»åŒ–çš„ä¾‹å­">ğŸ’¡ ä¸¾ä¸ªç”Ÿæ´»åŒ–çš„ä¾‹å­</h2>
<p>æƒ³è±¡ä½ è¦é€å¿«é€’ï¼š</p>
<ul>
<li><strong>è¿­ä»£å™¨</strong>ï¼šä½ å…ˆæŠŠæ‰€æœ‰åŒ…è£¹è£…ä¸Šè½¦ï¼ˆå†…å­˜ä¸­å­˜å¥½ï¼‰ï¼Œç„¶åæŒ‰é¡ºåºä¸€ä¸ªä¸ªé€ï¼ˆ<code>current()</code>/<code>next()</code>ï¼‰ã€‚é€å®Œäº†è¿˜èƒ½é‡æ–°è£…è½¦å†é€ä¸€éã€‚</li>
<li><strong>ç”Ÿæˆå™¨</strong>ï¼šä½ ä¸è£…è½¦ï¼å®¢æˆ·è¦ä¸€ä¸ªåŒ…è£¹ï¼Œä½ æ‰ä»ä»“åº“æ‹¿ä¸€ä¸ªå‡ºæ¥é€ï¼ˆ<code>yield</code>ï¼‰ã€‚é€å®Œå°±æ²¡äº†ï¼Œæƒ³å†é€ï¼Ÿå¾—é‡æ–°å«ä½ ä¸€è¶Ÿï¼ˆé‡æ–°è°ƒç”¨å‡½æ•°ï¼‰ã€‚</li>
</ul>
<hr>
<h2 id="-ä»€ä¹ˆæ—¶å€™ç”¨å“ªä¸ª">âœ… ä»€ä¹ˆæ—¶å€™ç”¨å“ªä¸ªï¼Ÿ</h2>
<ul>
<li>æƒ³å¿«é€Ÿç”Ÿæˆå¤§é‡æ•°æ®ï¼ˆæ¯”å¦‚æ—¥å¿—è§£æã€ç™¾ä¸‡æ¡æµ‹è¯•æ•°æ®ï¼‰â†’ <strong>ç”¨ç”Ÿæˆå™¨</strong></li>
<li>éœ€è¦è‡ªå®šä¹‰éå†æ–¹å¼ï¼ˆæ¯”å¦‚è·³è¿‡å¶æ•°ã€å€’åºã€æ ‘éå†ï¼‰â†’ <strong>ç”¨è¿­ä»£å™¨</strong></li>
<li>ä¸ç¡®å®šï¼Ÿå…ˆè¯•è¯•ç”Ÿæˆå™¨ï¼Œç®€å•åˆçœå†…å­˜ï¼</li>
</ul>
<hr>
<h1 id="å¾ˆå¤šåˆšæ¥è§¦-php-æšä¸¾å°¤å…¶æ˜¯ä»å…¶ä»–è¯­è¨€æˆ–ä¼ ç»Ÿç†è§£è¿‡æ¥çš„éƒ½ä¼šè§‰å¾—æšä¸¾ä¸å°±æ˜¯å‡ ä¸ªå›ºå®šå€¼å—æ€ä¹ˆè¿˜èƒ½æœ‰æ–¹æ³•æ¥å£å•ä¾‹å¯¹è±¡">å¾ˆå¤šåˆšæ¥è§¦ PHP æšä¸¾ï¼ˆå°¤å…¶æ˜¯ä»å…¶ä»–è¯­è¨€æˆ–ä¼ ç»Ÿç†è§£è¿‡æ¥çš„ï¼‰éƒ½ä¼šè§‰å¾—ï¼šâ€œ<strong>æšä¸¾ä¸å°±æ˜¯å‡ ä¸ªå›ºå®šå€¼å—ï¼Ÿæ€ä¹ˆè¿˜èƒ½æœ‰æ–¹æ³•ã€æ¥å£ã€å•ä¾‹å¯¹è±¡ï¼Ÿ</strong>â€</h1>
<p>åˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬<strong>ä»æœ€åŸºç¡€ã€æœ€ç›´ç™½çš„è§’åº¦é‡æ–°æ¢³ç†ä¸€é</strong>ï¼Œé‡ç‚¹è®²æ¸…æ¥šï¼š</p>
<blockquote>
<p>âœ… <strong>PHP æšä¸¾åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</strong><br>
âœ… <strong><code>enum</code> å…³é”®å­—æ€ä¹ˆå†™ï¼Ÿ</strong><br>
âœ… <strong>ç±»å‹åç§°ï¼ˆå¦‚ <code>Status</code>ï¼‰ä»£è¡¨ä»€ä¹ˆï¼Ÿ</strong></p>
</blockquote>
<hr>
<h2 id="-ä¸€å…ˆå¿˜æ‰é«˜çº§åŠŸèƒ½å›åˆ°åˆå¿ƒæšä¸¾--å›ºå®šé€‰é¡¹">ğŸŒŸ ä¸€ã€å…ˆå¿˜æ‰â€œé«˜çº§åŠŸèƒ½â€ï¼Œå›åˆ°åˆå¿ƒï¼šæšä¸¾ = å›ºå®šé€‰é¡¹</h2>
<p>ä½ æœ€åˆçš„ç†è§£å®Œå…¨æ²¡é”™ï¼</p>
<blockquote>
<p><strong>æšä¸¾ï¼ˆEnumerationï¼‰çš„æœ¬è´¨ï¼Œå°±æ˜¯ä¸€ç»„å‘½åçš„ã€å›ºå®šçš„ã€æœ‰é™çš„å€¼ã€‚</strong></p>
</blockquote>
<p>æ¯”å¦‚ï¼š</p>
<ul>
<li>è®¢å•çŠ¶æ€ï¼š<code>å¾…æ”¯ä»˜</code>ã€<code>å·²å‘è´§</code>ã€<code>å·²å®Œæˆ</code>ã€<code>å·²å–æ¶ˆ</code></li>
<li>ç”¨æˆ·è§’è‰²ï¼š<code>ç®¡ç†å‘˜</code>ã€<code>ç¼–è¾‘</code>ã€<code>è®¿å®¢</code></li>
<li>é¢œè‰²é€‰é¡¹ï¼š<code>çº¢</code>ã€<code>ç»¿</code>ã€<code>è“</code></li>
</ul>
<p>åœ¨ PHP 8.1 ä¹‹å‰ï¼Œæˆ‘ä»¬åªèƒ½ç”¨ <strong>ç±»å¸¸é‡</strong> æ¨¡æ‹Ÿï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">class</span> <span class="nc">Status</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="k">const</span> <span class="no">DRAFT</span> <span class="o">=</span> <span class="s1">&#39;draft&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">const</span> <span class="no">PUBLISHED</span> <span class="o">=</span> <span class="s1">&#39;published&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ä½†è¿™æ ·<strong>æ²¡æœ‰ç±»å‹å®‰å…¨</strong>â€”â€”ä½ å¯ä»¥éšä¾¿ä¼  <code>'drfat'</code>ï¼ˆæ‹¼é”™ï¼‰ï¼ŒPHP ä¸ä¼šæŠ¥é”™ã€‚</p>
<p><strong>PHP æšä¸¾è§£å†³äº†è¿™ä¸ªé—®é¢˜</strong>ï¼šå®ƒè®©è¿™äº›â€œå›ºå®šå€¼â€å˜æˆ<strong>æœ‰ç±»å‹çš„ã€ä¸å¯ä¼ªé€ çš„ä¸“å±å¯¹è±¡</strong>ã€‚</p>
<hr>
<h2 id="-äºŒenum-å…³é”®å­—å®šä¹‰æšä¸¾çš„èµ·ç‚¹">ğŸ”‘ äºŒã€<code>enum</code> å…³é”®å­—ï¼šå®šä¹‰æšä¸¾çš„èµ·ç‚¹</h2>
<h3 id="åŸºæœ¬è¯­æ³•-2">åŸºæœ¬è¯­æ³•ï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">enum</span> <span class="nx">æšä¸¾åç§°</span> <span class="p">[</span><span class="o">:</span> <span class="nx">æ ‡é‡ç±»å‹</span><span class="p">]</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="k">case</span> <span class="nx">é€‰é¡¹1</span> <span class="p">[</span><span class="o">=</span> <span class="nx">å€¼</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">case</span> <span class="nx">é€‰é¡¹2</span> <span class="p">[</span><span class="o">=</span> <span class="nx">å€¼</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="ä¸¤ç§å†™æ³•">ä¸¤ç§å†™æ³•ï¼š</h3>
<h4 id="1-çº¯æšä¸¾pure-enum--åªæœ‰åå­—æ²¡æœ‰å€¼">1ï¸âƒ£ <strong>çº¯æšä¸¾ï¼ˆPure Enumï¼‰</strong> â€”â€” åªæœ‰åå­—ï¼Œæ²¡æœ‰å€¼</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">enum</span> <span class="nx">Status</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="k">case</span> <span class="nx">Draft</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">case</span> <span class="nx">Published</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="k">case</span> <span class="nx">Archived</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ul>
<li>è¿™é‡Œçš„ <code>Draft</code>ã€<code>Published</code> æ˜¯ <strong><code>Status</code> ç±»å‹çš„ç‰¹æ®Šå¯¹è±¡</strong></li>
<li>å®ƒä»¬<strong>æ²¡æœ‰åº•å±‚å€¼</strong>ï¼ˆä¸èƒ½ <code>$status-&gt;value</code>ï¼‰</li>
<li>åªèƒ½é€šè¿‡ <code>Status::Draft</code> æ¥å¼•ç”¨</li>
</ul>
<h4 id="2-å¸¦å€¼æšä¸¾backed-enum--æ¯ä¸ªé€‰é¡¹å¯¹åº”ä¸€ä¸ªå…·ä½“å€¼string-æˆ–-int">2ï¸âƒ£ <strong>å¸¦å€¼æšä¸¾ï¼ˆBacked Enumï¼‰</strong> â€”â€” æ¯ä¸ªé€‰é¡¹å¯¹åº”ä¸€ä¸ªå…·ä½“å€¼ï¼ˆstring æˆ– intï¼‰</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">enum</span> <span class="nx">Status</span><span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="k">case</span> <span class="nx">Draft</span> <span class="o">=</span> <span class="s1">&#39;draft&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">case</span> <span class="nx">Published</span> <span class="o">=</span> <span class="s1">&#39;published&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="k">case</span> <span class="nx">Archived</span> <span class="o">=</span> <span class="s1">&#39;archived&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ul>
<li><code>: string</code> è¡¨ç¤ºè¿™ä¸ªæšä¸¾çš„åº•å±‚å€¼æ˜¯å­—ç¬¦ä¸²</li>
<li>æ¯ä¸ª <code>case</code> å¿…é¡»èµ‹ä¸€ä¸ª <code>string</code> å€¼ï¼ˆä¸”å”¯ä¸€ï¼‰</li>
<li>å¯ä»¥é€šè¿‡ <code>Status::Draft-&gt;value</code> è·å– <code>'draft'</code></li>
</ul>
<blockquote>
<p>âœ… <strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li><code>enum</code> æ˜¯<strong>å®šä¹‰æ–°ç±»å‹çš„å…³é”®å­—</strong>ï¼ˆç±»ä¼¼ <code>class</code>ï¼‰</li>
<li><code>Status</code> æ˜¯<strong>è¿™ä¸ªæ–°ç±»å‹çš„åç§°</strong>ï¼ˆå°±åƒç±»åï¼‰</li>
<li><code>case Draft</code> æ˜¯è¿™ä¸ªç±»å‹çš„ä¸€ä¸ª<strong>é¢„å®šä¹‰å®ä¾‹</strong></li>
</ul>
</blockquote>
<hr>
<h2 id="-ä¸‰ç±»å‹åç§°å¦‚-statusåˆ°åº•æ˜¯ä»€ä¹ˆ">ğŸ§  ä¸‰ã€ç±»å‹åç§°ï¼ˆå¦‚ <code>Status</code>ï¼‰åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>è¿™æ˜¯æœ€å®¹æ˜“æ··æ·†çš„åœ°æ–¹ï¼</p>
<h3 id="åœ¨-php-ä¸­">åœ¨ PHP ä¸­ï¼š</h3>
<ul>
<li><code>Status</code> <strong>ä¸æ˜¯ä¸€ä¸ªå˜é‡ï¼Œä¹Ÿä¸æ˜¯ä¸€ä¸ªå€¼</strong></li>
<li><code>Status</code> <strong>æ˜¯ä¸€ä¸ªç±»å‹ï¼ˆTypeï¼‰</strong></li>
<li>è€Œ <code>Status::Draft</code> æ‰æ˜¯è¿™ä¸ªç±»å‹çš„<strong>ä¸€ä¸ªå…·ä½“å€¼ï¼ˆå®ä¾‹ï¼‰</strong></li>
</ul>
<h3 id="ç±»æ¯”ç†è§£ç”¨ç±»æ¥æ¯”å–»">ç±»æ¯”ç†è§£ï¼ˆç”¨ç±»æ¥æ¯”å–»ï¼‰ï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">// æ™®é€šç±»
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="k">class</span> <span class="nc">User</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="k">public</span> <span class="nx">string</span> <span class="nv">$name</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nv">$user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">);</span> <span class="c1">// $user æ˜¯ User ç±»å‹çš„ä¸€ä¸ªå®ä¾‹
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1">// æšä¸¾ï¼ˆç±»ä¼¼â€œé¢„å®šä¹‰å¥½çš„å•ä¾‹ç±»â€ï¼‰
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="nx">enum</span> <span class="nx">Status</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">case</span> <span class="nx">Draft</span><span class="p">;</span>      <span class="c1">// ç›¸å½“äºé¢„å…ˆåˆ›å»ºå¥½çš„å”¯ä¸€å®ä¾‹
</span></span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">case</span> <span class="nx">Published</span><span class="p">;</span>  <span class="c1">// ä¹Ÿæ˜¯å”¯ä¸€å®ä¾‹
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nv">$st</span> <span class="o">=</span> <span class="nx">Status</span><span class="o">::</span><span class="na">Draft</span><span class="p">;</span> <span class="c1">// $st æ˜¯ Status ç±»å‹çš„ä¸€ä¸ªå®ä¾‹
</span></span></span></code></pre></div><blockquote>
<p>ğŸ’¡ æ‰€ä»¥ï¼š</p>
<ul>
<li><code>Status</code> æ˜¯<strong>ç±»å‹å</strong>ï¼ˆç”¨äºç±»å‹å£°æ˜ï¼‰</li>
<li><code>Status::Draft</code> æ˜¯<strong>å€¼</strong>ï¼ˆç”¨äºèµ‹å€¼ã€æ¯”è¾ƒï¼‰</li>
</ul>
</blockquote>
<hr>
<h2 id="-å››å®é™…ä»£ç æ¼”ç¤ºç±»å‹-vs-å€¼">âœ… å››ã€å®é™…ä»£ç æ¼”ç¤ºï¼šç±»å‹ vs å€¼</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">// 1. å®šä¹‰æšä¸¾
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nx">enum</span> <span class="nx">Color</span><span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="k">case</span> <span class="nx">Red</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">case</span> <span class="nx">Green</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="c1">// 2. ä½¿ç”¨ï¼šç±»å‹å£°æ˜
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">function</span> <span class="nf">paint</span><span class="p">(</span><span class="nx">Color</span> <span class="nv">$color</span><span class="p">)</span><span class="o">:</span> <span class="nx">void</span> <span class="p">{</span> <span class="c1">// â† è¿™é‡Œ Color æ˜¯ç±»å‹
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;Painting with &#34;</span> <span class="o">.</span> <span class="nv">$color</span><span class="o">-&gt;</span><span class="na">value</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="c1">// 3. è°ƒç”¨ï¼šä¼ å…¥å…·ä½“çš„æšä¸¾å€¼
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">paint</span><span class="p">(</span><span class="nx">Color</span><span class="o">::</span><span class="na">Red</span><span class="p">);</span> <span class="c1">// â† Color::Red æ˜¯å€¼ï¼ˆColor ç±»å‹çš„å®ä¾‹ï¼‰
</span></span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1">// 4. æ¯”è¾ƒ
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$color</span> <span class="o">===</span> <span class="nx">Color</span><span class="o">::</span><span class="na">Red</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;It&#39;s red!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>âŒ ä½ ä¸èƒ½è¿™æ ·åšï¼š</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">paint</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">);</span>        <span class="c1">// é”™ï¼&#39;red&#39; æ˜¯å­—ç¬¦ä¸²ï¼Œä¸æ˜¯ Color ç±»å‹
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nx">paint</span><span class="p">(</span><span class="nx">Color</span><span class="p">);</span>        <span class="c1">// é”™ï¼Color æ˜¯ç±»å‹ï¼Œä¸æ˜¯å€¼
</span></span></span></code></pre></div><hr>
<h2 id="-äº”ä¸ºä»€ä¹ˆ-php-æšä¸¾èƒ½æœ‰æ–¹æ³•å› ä¸ºå®ƒæœ¬è´¨æ˜¯ç‰¹æ®Šçš„ç±»">ğŸ¯ äº”ã€ä¸ºä»€ä¹ˆ PHP æšä¸¾èƒ½æœ‰æ–¹æ³•ï¼Ÿâ€”â€”å› ä¸ºå®ƒæœ¬è´¨æ˜¯â€œç‰¹æ®Šçš„ç±»â€</h2>
<p>PHP çš„æšä¸¾åœ¨åº•å±‚è¢«å®ç°ä¸ºä¸€ç§<strong>ç‰¹æ®Šçš„ç±»</strong>ï¼Œæ‰€ä»¥å®ƒå¯ä»¥ï¼š</p>
<ul>
<li>æœ‰å¸¸é‡ï¼ˆå°±æ˜¯ <code>case</code>ï¼‰</li>
<li>æœ‰æ–¹æ³•ï¼ˆ<code>public function ...</code>ï¼‰</li>
<li>å®ç°æ¥å£ï¼ˆ<code>implements SomeInterface</code>ï¼‰</li>
<li>ä½†ä¸èƒ½è¢« <code>new</code>ï¼Œä¹Ÿä¸èƒ½ç»§æ‰¿</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">enum</span> <span class="nx">TrafficLight</span><span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">case</span> <span class="nx">Red</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="k">case</span> <span class="nx">Yellow</span> <span class="o">=</span> <span class="s1">&#39;yellow&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">case</span> <span class="nx">Green</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="c1">// æšä¸¾å¯ä»¥æœ‰è‡ªå·±çš„æ–¹æ³•ï¼
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">shouldStop</span><span class="p">()</span><span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="k">return</span> <span class="nv">$this</span> <span class="o">===</span> <span class="nx">self</span><span class="o">::</span><span class="na">Red</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nv">$light</span> <span class="o">=</span> <span class="nx">TrafficLight</span><span class="o">::</span><span class="na">Red</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nv">$light</span><span class="o">-&gt;</span><span class="na">shouldStop</span><span class="p">());</span> <span class="c1">// true
</span></span></span></code></pre></div><blockquote>
<p>ğŸ” è¿™é‡Œçš„ <code>$this</code> å°±æ˜¯æŒ‡å½“å‰çš„æšä¸¾å®ä¾‹ï¼ˆæ¯”å¦‚ <code>TrafficLight::Red</code>ï¼‰</p>
</blockquote>
<hr>
<h2 id="-å…­æ€»ç»“ä¸€å¼ è¡¨ç†æ¸…æ¦‚å¿µ">âœ… å…­ã€æ€»ç»“ï¼šä¸€å¼ è¡¨ç†æ¸…æ¦‚å¿µ</h2>
<table>
  <thead>
      <tr>
          <th>æ¦‚å¿µ</th>
          <th>è¯´æ˜</th>
          <th>ç¤ºä¾‹</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>enum</code></td>
          <td>å®šä¹‰æšä¸¾çš„å…³é”®å­—</td>
          <td><code>enum Status { ... }</code></td>
      </tr>
      <tr>
          <td><code>Status</code></td>
          <td><strong>æšä¸¾ç±»å‹åç§°</strong>ï¼ˆç”¨äºç±»å‹æç¤ºï¼‰</td>
          <td><code>function f(Status $s)</code></td>
      </tr>
      <tr>
          <td><code>Status::Draft</code></td>
          <td><strong>æšä¸¾å€¼</strong>ï¼ˆæ˜¯ <code>Status</code> ç±»å‹çš„ä¸€ä¸ªå®ä¾‹ï¼‰</td>
          <td><code>$s = Status::Draft;</code></td>
      </tr>
      <tr>
          <td><code>case Draft</code></td>
          <td>æšä¸¾ä¸­çš„ä¸€ä¸ªå›ºå®šé€‰é¡¹</td>
          <td><code>case Draft = 'draft';</code></td>
      </tr>
      <tr>
          <td><code>: string</code></td>
          <td>æŒ‡å®šåº•å±‚æ ‡é‡ç±»å‹ï¼ˆå¯é€‰ï¼‰</td>
          <td><code>enum Color: string { ... }</code></td>
      </tr>
      <tr>
          <td><code>$s-&gt;value</code></td>
          <td>è·å–åº•å±‚å€¼ï¼ˆä»… Backed Enumï¼‰</td>
          <td><code>'draft'</code></td>
      </tr>
      <tr>
          <td><code>$s-&gt;name</code></td>
          <td>è·å– case åç§°ï¼ˆæ‰€æœ‰æšä¸¾éƒ½æ”¯æŒï¼‰</td>
          <td><code>'Draft'</code></td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-æœ€åä¸€å¥è¯å¸®ä½ è®°ä½">ğŸ’¡ æœ€åä¸€å¥è¯å¸®ä½ è®°ä½ï¼š</h2>
<blockquote>
<p><strong><code>enum X</code> å®šä¹‰äº†ä¸€ä¸ªå« <code>X</code> çš„æ–°ç±»å‹ï¼›<br>
<code>X::A</code>ã€<code>X::B</code> æ˜¯è¿™ä¸ªç±»å‹ä»…æœ‰çš„å‡ ä¸ªåˆæ³•å€¼ã€‚</strong></p>
</blockquote>
<p>å°±åƒäº¤é€šç¯åªæœ‰çº¢ã€é»„ã€ç»¿ä¸‰ç§çŠ¶æ€ï¼Œä½ ä¸èƒ½è¯´â€œç´«è‰²ç¯â€â€”â€”PHP ä¼šåœ¨ç±»å‹å±‚é¢é˜»æ­¢ä½ çŠ¯é”™ï¼</p>
<hr>
<h1 id="php-çš„-æšä¸¾enum-æ˜¯ä»-php-81-å¼€å§‹æ­£å¼å¼•å…¥çš„è¯­è¨€ç‰¹æ€§ç”¨äºå®šä¹‰ä¸€ç»„å‘½åçš„å¸¸é‡å€¼ç‰¹åˆ«é€‚åˆè¡¨ç¤ºæœ‰é™å›ºå®šçš„é€‰é¡¹é›†åˆå¦‚çŠ¶æ€ç±»å‹è§’è‰²ç­‰ç›¸æ¯”ä¼ ç»Ÿçš„ç±»å¸¸é‡æˆ–å…¨å±€å¸¸é‡æšä¸¾æ›´å®‰å…¨å¯è¯»æ€§æ›´å¼ºå¹¶æ”¯æŒç±»å‹çº¦æŸ">PHP çš„ <strong>æšä¸¾ï¼ˆEnumï¼‰</strong> æ˜¯ä» <strong>PHP 8.1</strong> å¼€å§‹æ­£å¼å¼•å…¥çš„è¯­è¨€ç‰¹æ€§ï¼Œç”¨äºå®šä¹‰ä¸€ç»„<strong>å‘½åçš„å¸¸é‡å€¼</strong>ï¼Œç‰¹åˆ«é€‚åˆè¡¨ç¤ºæœ‰é™ã€å›ºå®šçš„é€‰é¡¹é›†åˆï¼ˆå¦‚çŠ¶æ€ã€ç±»å‹ã€è§’è‰²ç­‰ï¼‰ã€‚ç›¸æ¯”ä¼ ç»Ÿçš„ç±»å¸¸é‡æˆ–å…¨å±€å¸¸é‡ï¼Œæšä¸¾æ›´å®‰å…¨ã€å¯è¯»æ€§æ›´å¼ºï¼Œå¹¶æ”¯æŒç±»å‹çº¦æŸã€‚</h1>
<hr>
<h2 id="-ä¸€åŸºæœ¬è¯­æ³•å®šä¹‰æšä¸¾">âœ… ä¸€ã€åŸºæœ¬è¯­æ³•ï¼šå®šä¹‰æšä¸¾</h2>
<h3 id="1-çº¯æšä¸¾pure-enumåªæœ‰-cases">1. çº¯æšä¸¾ï¼ˆPure Enumï¼‰â€”â€”åªæœ‰ cases</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">enum</span> <span class="nx">Status</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="k">case</span> <span class="nx">Draft</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">case</span> <span class="nx">Published</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="k">case</span> <span class="nx">Archived</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ul>
<li>æ¯ä¸ª <code>case</code> æ˜¯ä¸€ä¸ª<strong>å•ä¾‹å¯¹è±¡</strong></li>
<li>ä¸èƒ½ç›´æ¥èµ‹å€¼ï¼ˆæ²¡æœ‰åº•å±‚å€¼ï¼‰</li>
<li>åªèƒ½é€šè¿‡ <code>Status::Draft</code> è¿™ç§æ–¹å¼è®¿é—®</li>
</ul>
<h3 id="2-å¸¦æ ‡é‡å€¼çš„æšä¸¾backed-enumæ¯ä¸ª-case-æœ‰å¯¹åº”å€¼">2. å¸¦æ ‡é‡å€¼çš„æšä¸¾ï¼ˆBacked Enumï¼‰â€”â€”æ¯ä¸ª case æœ‰å¯¹åº”å€¼</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">enum</span> <span class="nx">Color</span><span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">case</span> <span class="nx">Red</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="k">case</span> <span class="nx">Green</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">case</span> <span class="nx">Blue</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="nx">enum</span> <span class="nx">Priority</span><span class="o">:</span> <span class="nx">int</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="k">case</span> <span class="nx">Low</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="k">case</span> <span class="nx">Medium</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">case</span> <span class="nx">High</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>âš ï¸ è¦æ±‚ï¼š</p>
<ul>
<li>æ‰€æœ‰ <code>case</code> å¿…é¡»æœ‰ç›¸åŒçš„æ ‡é‡ç±»å‹ï¼ˆ<code>string</code> æˆ– <code>int</code>ï¼‰</li>
<li>å€¼å¿…é¡»å”¯ä¸€</li>
<li>ä¸èƒ½æ··åˆ <code>string</code> å’Œ <code>int</code></li>
</ul>
</blockquote>
<hr>
<h2 id="-äºŒå¸¸ç”¨æ“ä½œä¸æ–¹æ³•">âœ… äºŒã€å¸¸ç”¨æ“ä½œä¸æ–¹æ³•</h2>
<h3 id="1-è·å–-case-åç§°å’Œå€¼">1. è·å– case åç§°å’Œå€¼</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">$status</span> <span class="o">=</span> <span class="nx">Status</span><span class="o">::</span><span class="na">Published</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="k">echo</span> <span class="nv">$status</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">;</span> <span class="c1">// &#34;Published&#34;
</span></span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="nv">$color</span> <span class="o">=</span> <span class="nx">Color</span><span class="o">::</span><span class="na">Red</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="k">echo</span> <span class="nv">$color</span><span class="o">-&gt;</span><span class="na">value</span><span class="p">;</span> <span class="c1">// &#34;red&#34;
</span></span></span></code></pre></div><h3 id="2-ä»å€¼åå‘è·å–æšä¸¾å®ä¾‹ä»…é™-backed-enum">2. ä»å€¼åå‘è·å–æšä¸¾å®ä¾‹ï¼ˆä»…é™ Backed Enumï¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">$color</span> <span class="o">=</span> <span class="nx">Color</span><span class="o">::</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">);</span>     <span class="c1">// è¿”å› Color::Red
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nv">$priority</span> <span class="o">=</span> <span class="nx">Priority</span><span class="o">::</span><span class="na">from</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>   <span class="c1">// è¿”å› Priority::Medium
</span></span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1">// å¦‚æœå€¼ä¸å­˜åœ¨ï¼Œä¼šæŠ›å‡º ValueError
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="c1">// Color::from(&#39;yellow&#39;); // âŒ æŠ›å‡ºå¼‚å¸¸
</span></span></span></code></pre></div><h3 id="3-å®‰å…¨åœ°å°è¯•ä»å€¼è·å–ä¸ä¼šæŠ›å¼‚å¸¸">3. å®‰å…¨åœ°å°è¯•ä»å€¼è·å–ï¼ˆä¸ä¼šæŠ›å¼‚å¸¸ï¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">$color</span> <span class="o">=</span> <span class="nx">Color</span><span class="o">::</span><span class="na">tryFrom</span><span class="p">(</span><span class="s1">&#39;yellow&#39;</span><span class="p">);</span> <span class="c1">// è¿”å› nullï¼ˆè€Œä¸æ˜¯æŠ¥é”™ï¼‰
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$color</span> <span class="o">===</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;æ— æ•ˆé¢œè‰²&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="4-è·å–æ‰€æœ‰-cases">4. è·å–æ‰€æœ‰ cases</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">$allStatuses</span> <span class="o">=</span> <span class="nx">Status</span><span class="o">::</span><span class="na">cases</span><span class="p">();</span> 
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1">// è¿”å› [Status::Draft, Status::Published, Status::Archived]
</span></span></span></code></pre></div><hr>
<h2 id="-ä¸‰åœ¨å‡½æ•°ä¸­ä½¿ç”¨ç±»å‹å®‰å…¨">âœ… ä¸‰ã€åœ¨å‡½æ•°ä¸­ä½¿ç”¨ï¼ˆç±»å‹å®‰å…¨ï¼‰</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">function</span> <span class="nf">setStatus</span><span class="p">(</span><span class="nx">Status</span> <span class="nv">$status</span><span class="p">)</span><span class="o">:</span> <span class="nx">void</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="c1">// åªæ¥å— Status æšä¸¾ç±»å‹
</span></span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$status</span> <span class="o">===</span> <span class="nx">Status</span><span class="o">::</span><span class="na">Published</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;æ–‡ç« å·²å‘å¸ƒï¼&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="nx">setStatus</span><span class="p">(</span><span class="nx">Status</span><span class="o">::</span><span class="na">Draft</span><span class="p">);</span> <span class="c1">// âœ… åˆæ³•
</span></span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="c1">// setStatus(&#39;draft&#39;);    // âŒ ç±»å‹é”™è¯¯ï¼å¿…é¡»ä¼ æšä¸¾å®ä¾‹
</span></span></span></code></pre></div><blockquote>
<p>ğŸ’¡ è¿™æ¯”ç”¨å­—ç¬¦ä¸² <code>'draft'</code> å®‰å…¨å¾—å¤šï¼Œé¿å…æ‹¼å†™é”™è¯¯ï¼</p>
</blockquote>
<hr>
<h2 id="-å››æšä¸¾å¯ä»¥åŒ…å«æ–¹æ³•è¡Œä¸º">âœ… å››ã€æšä¸¾å¯ä»¥åŒ…å«æ–¹æ³•ï¼ˆè¡Œä¸ºï¼‰</h2>
<p>æšä¸¾å¯ä»¥åƒç±»ä¸€æ ·å®šä¹‰æ–¹æ³•ï¼Œç”šè‡³å®ç°æ¥å£ï¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nx">enum</span> <span class="nx">OrderStatus</span><span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">case</span> <span class="nx">Pending</span> <span class="o">=</span> <span class="s1">&#39;pending&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="k">case</span> <span class="nx">Processing</span> <span class="o">=</span> <span class="s1">&#39;processing&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">case</span> <span class="nx">Shipped</span> <span class="o">=</span> <span class="s1">&#39;shipped&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="k">case</span> <span class="nx">Cancelled</span> <span class="o">=</span> <span class="s1">&#39;cancelled&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">isFinal</span><span class="p">()</span><span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="k">return</span> <span class="nx">in_array</span><span class="p">(</span><span class="nv">$this</span><span class="p">,</span> <span class="p">[</span><span class="nx">self</span><span class="o">::</span><span class="na">Shipped</span><span class="p">,</span> <span class="nx">self</span><span class="o">::</span><span class="na">Cancelled</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">label</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="k">return</span> <span class="nx">match</span><span class="p">(</span><span class="nv">$this</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">            <span class="nx">self</span><span class="o">::</span><span class="na">Pending</span> <span class="o">=&gt;</span> <span class="s1">&#39;å¾…å¤„ç†&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">            <span class="nx">self</span><span class="o">::</span><span class="na">Processing</span> <span class="o">=&gt;</span> <span class="s1">&#39;å¤„ç†ä¸­&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">            <span class="nx">self</span><span class="o">::</span><span class="na">Shipped</span> <span class="o">=&gt;</span> <span class="s1">&#39;å·²å‘è´§&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">            <span class="nx">self</span><span class="o">::</span><span class="na">Cancelled</span> <span class="o">=&gt;</span> <span class="s1">&#39;å·²å–æ¶ˆ&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="p">};</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="nv">$status</span> <span class="o">=</span> <span class="nx">OrderStatus</span><span class="o">::</span><span class="na">Shipped</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="k">echo</span> <span class="nv">$status</span><span class="o">-&gt;</span><span class="na">label</span><span class="p">();</span>      <span class="c1">// &#34;å·²å‘è´§&#34;
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nv">$status</span><span class="o">-&gt;</span><span class="na">isFinal</span><span class="p">());</span> <span class="c1">// bool(true)
</span></span></span></code></pre></div><hr>
<h2 id="-äº”æšä¸¾å¯ä»¥å®ç°æ¥å£">âœ… äº”ã€æšä¸¾å¯ä»¥å®ç°æ¥å£</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">interface</span> <span class="nx">Describable</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getDescription</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="nx">enum</span> <span class="nx">UserRole</span><span class="o">:</span> <span class="nx">string</span> <span class="k">implements</span> <span class="nx">Describable</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">case</span> <span class="nx">Admin</span> <span class="o">=</span> <span class="s1">&#39;admin&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="k">case</span> <span class="nx">Editor</span> <span class="o">=</span> <span class="s1">&#39;editor&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="k">case</span> <span class="nx">Viewer</span> <span class="o">=</span> <span class="s1">&#39;viewer&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getDescription</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="k">return</span> <span class="nx">match</span><span class="p">(</span><span class="nv">$this</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">            <span class="nx">self</span><span class="o">::</span><span class="na">Admin</span> <span class="o">=&gt;</span> <span class="s1">&#39;ç³»ç»Ÿç®¡ç†å‘˜&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">            <span class="nx">self</span><span class="o">::</span><span class="na">Editor</span> <span class="o">=&gt;</span> <span class="s1">&#39;å†…å®¹ç¼–è¾‘&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">            <span class="nx">self</span><span class="o">::</span><span class="na">Viewer</span> <span class="o">=&gt;</span> <span class="s1">&#39;åªè¯»ç”¨æˆ·&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="p">};</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><hr>
<h2 id="-å…­ä¸æ•°æ®åº“json-çš„äº¤äº’å¸¸è§å®è·µ">âœ… å…­ã€ä¸æ•°æ®åº“/JSON çš„äº¤äº’ï¼ˆå¸¸è§å®è·µï¼‰</h2>
<h3 id="å­˜å‚¨åˆ°æ•°æ®åº“">å­˜å‚¨åˆ°æ•°æ®åº“</h3>
<p>é€šå¸¸å­˜å‚¨æšä¸¾çš„ <strong><code>value</code></strong>ï¼ˆå¦‚ <code>'published'</code> æˆ– <code>2</code>ï¼‰ï¼Œè€Œä¸æ˜¯åç§°ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">// ä¿å­˜
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bindValue</span><span class="p">(</span><span class="s1">&#39;:status&#39;</span><span class="p">,</span> <span class="nv">$status</span><span class="o">-&gt;</span><span class="na">value</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1">// è¯»å–
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="nv">$status</span> <span class="o">=</span> <span class="nx">Status</span><span class="o">::</span><span class="na">from</span><span class="p">(</span><span class="nv">$dbValue</span><span class="p">);</span> <span class="c1">// å‡è®¾æ˜¯ Backed Enum
</span></span></span></code></pre></div><h3 id="è½¬ä¸º-json">è½¬ä¸º JSON</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">echo</span> <span class="nx">json_encode</span><span class="p">(</span><span class="nx">Color</span><span class="o">::</span><span class="na">Red</span><span class="o">-&gt;</span><span class="na">value</span><span class="p">);</span> <span class="c1">// &#34;red&#34;
</span></span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="c1">// æˆ–è€…è‡ªå®šä¹‰åºåˆ—åŒ–
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="k">class</span> <span class="nc">ColorDTO</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="k">public</span> <span class="nx">string</span> <span class="nv">$name</span><span class="p">,</span> <span class="k">public</span> <span class="nx">string</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="nv">$color</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ColorDTO</span><span class="p">(</span><span class="nx">Color</span><span class="o">::</span><span class="na">Red</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">,</span> <span class="nx">Color</span><span class="o">::</span><span class="na">Red</span><span class="o">-&gt;</span><span class="na">value</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="k">echo</span> <span class="nx">json_encode</span><span class="p">(</span><span class="nv">$color</span><span class="p">);</span> <span class="c1">// {&#34;name&#34;:&#34;Red&#34;,&#34;value&#34;:&#34;red&#34;}
</span></span></span></code></pre></div><hr>
<h2 id="-æ³¨æ„äº‹é¡¹-1">âš ï¸ æ³¨æ„äº‹é¡¹</h2>
<table>
  <thead>
      <tr>
          <th>é—®é¢˜</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>ä¸èƒ½ç»§æ‰¿</strong></td>
          <td>æšä¸¾ä¸èƒ½ <code>extends</code> å…¶ä»–æšä¸¾æˆ–ç±»</td>
      </tr>
      <tr>
          <td><strong>ä¸èƒ½å®ä¾‹åŒ–</strong></td>
          <td>ä¸èƒ½ <code>new Status()</code>ï¼Œåªèƒ½ç”¨é¢„å®šä¹‰çš„ <code>case</code></td>
      </tr>
      <tr>
          <td><strong>çº¯æšä¸¾æ—  value</strong></td>
          <td><code>Status::Draft-&gt;value</code> ä¼šæŠ¥é”™ï¼ˆå› ä¸ºæ²¡å®šä¹‰åº•å±‚å€¼ï¼‰</td>
      </tr>
      <tr>
          <td><strong>åŒºåˆ†å¤§å°å†™</strong></td>
          <td><code>Status::draft</code> â‰  <code>Status::Draft</code></td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-æ€»ç»“ä»€ä¹ˆæ—¶å€™ç”¨æšä¸¾">âœ… æ€»ç»“ï¼šä»€ä¹ˆæ—¶å€™ç”¨æšä¸¾ï¼Ÿ</h2>
<table>
  <thead>
      <tr>
          <th>åœºæ™¯</th>
          <th>æ¨è</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>è¡¨ç¤ºå›ºå®šé€‰é¡¹ï¼ˆçŠ¶æ€ã€ç±»å‹ã€è§’è‰²ï¼‰</td>
          <td>âœ… å¼ºçƒˆæ¨è</td>
      </tr>
      <tr>
          <td>éœ€è¦ç±»å‹å®‰å…¨å’Œ IDE è‡ªåŠ¨è¡¥å…¨</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td>æ›¿ä»£é­”æ³•å­—ç¬¦ä¸²/æ•°å­—ï¼ˆå¦‚ <code>'active'</code>, <code>1</code>ï¼‰</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td>åŠ¨æ€å€¼æˆ–æ— é™é›†åˆ</td>
          <td>âŒ ä¸é€‚åˆï¼ˆç”¨å¸¸é‡æˆ–é…ç½®ï¼‰</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-æœ€ä½³å®è·µå»ºè®®">ğŸ¯ æœ€ä½³å®è·µå»ºè®®</h2>
<ol>
<li><strong>ä¼˜å…ˆä½¿ç”¨ Backed Enumï¼ˆå¸¦å€¼ï¼‰</strong>ï¼Œæ–¹ä¾¿ä¸æ•°æ®åº“ã€API äº¤äº’</li>
<li><strong>ç»™æšä¸¾åŠ æè¿°æ–¹æ³•</strong>ï¼ˆå¦‚ <code>label()</code>, <code>description()</code>ï¼‰æå‡å¯è¯»æ€§</li>
<li><strong>é…åˆç±»å‹å£°æ˜</strong>ï¼Œè®©ä»£ç æ›´å¥å£®</li>
<li><strong>ä¸è¦æ»¥ç”¨</strong>ï¼šåªæœ‰â€œæœ‰é™ä¸”å›ºå®šâ€çš„é€‰é¡¹æ‰ç”¨æšä¸¾</li>
</ol>
<hr>
<blockquote>
<p>ğŸ’¡ <strong>å°è´´å£«</strong>ï¼šå¦‚æœä½ è¿˜åœ¨ç”¨ PHP 8.0 æˆ–æ›´ä½ç‰ˆæœ¬ï¼Œå¯ä»¥ç”¨ <a href="https://github.com/myclabs/php-enum"><code>myclabs/php-enum</code></a> åŒ…æ¨¡æ‹Ÿæšä¸¾ï¼Œä½†åŸç”Ÿæšä¸¾ï¼ˆPHP 8.1+ï¼‰æ›´å¼ºå¤§ã€æ›´æ ‡å‡†ï¼</p>
</blockquote>
<h1 id="php-çš„-fibersçº¤ç¨‹-æ˜¯ä»-php-81-å¼€å§‹å¼•å…¥çš„ä¸€ç§è½»é‡çº§å¹¶å‘åŸè¯­ç”¨äºå®ç°åä½œå¼å¤šä»»åŠ¡cooperative-multitaskingå®ƒå…è®¸ä½ åœ¨å•çº¿ç¨‹ä¸­æš‚åœå’Œæ¢å¤å‡½æ•°çš„æ‰§è¡Œè€Œæ— éœ€ä¾èµ–å›è°ƒç”Ÿæˆå™¨æˆ–å¤æ‚çš„å¼‚æ­¥æ¡†æ¶">PHP çš„ <strong>Fibersï¼ˆçº¤ç¨‹ï¼‰</strong> æ˜¯ä» <strong>PHP 8.1</strong> å¼€å§‹å¼•å…¥çš„ä¸€ç§<strong>è½»é‡çº§å¹¶å‘åŸè¯­</strong>ï¼Œç”¨äºå®ç°<strong>åä½œå¼å¤šä»»åŠ¡ï¼ˆcooperative multitaskingï¼‰</strong>ã€‚å®ƒå…è®¸ä½ åœ¨å•çº¿ç¨‹ä¸­<strong>æš‚åœå’Œæ¢å¤å‡½æ•°çš„æ‰§è¡Œ</strong>ï¼Œè€Œæ— éœ€ä¾èµ–å›è°ƒã€ç”Ÿæˆå™¨æˆ–å¤æ‚çš„å¼‚æ­¥æ¡†æ¶ã€‚</h1>
<blockquote>
<p>ğŸ’¡ ç®€å•è¯´ï¼š<strong>Fiber è®©ä½ å†™å‡ºâ€œçœ‹ä¼¼åŒæ­¥â€ä½†åº•å±‚å¯ä¸­æ–­/æ¢å¤çš„ä»£ç </strong>ï¼Œæ˜¯æ„å»ºåç¨‹ï¼ˆCoroutineï¼‰ç³»ç»Ÿçš„åŸºç¡€ã€‚</p>
</blockquote>
<hr>
<h2 id="-ä¸€æ ¸å¿ƒæ¦‚å¿µ">âœ… ä¸€ã€æ ¸å¿ƒæ¦‚å¿µ</h2>
<table>
  <thead>
      <tr>
          <th>æ¦‚å¿µ</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Fiber</strong></td>
          <td>ä¸€ä¸ªå¯ç‹¬ç«‹æ§åˆ¶æ‰§è¡Œæµç¨‹çš„â€œå¾®çº¿ç¨‹â€ï¼ˆä¸æ˜¯çœŸæ­£çš„ OS çº¿ç¨‹ï¼‰</td>
      </tr>
      <tr>
          <td><strong>æŒ‚èµ·ï¼ˆSuspendï¼‰</strong></td>
          <td>æš‚åœå½“å‰ Fiber çš„æ‰§è¡Œï¼Œäº¤å‡ºæ§åˆ¶æƒ</td>
      </tr>
      <tr>
          <td><strong>æ¢å¤ï¼ˆResumeï¼‰</strong></td>
          <td>ä»æŒ‚èµ·ç‚¹ç»§ç»­æ‰§è¡Œ Fiber</td>
      </tr>
      <tr>
          <td><strong>å•çº¿ç¨‹</strong></td>
          <td>æ‰€æœ‰ Fiber åœ¨åŒä¸€ä¸ª PHP çº¿ç¨‹ä¸­è¿è¡Œï¼Œ<strong>ä¸ä¼šå¹¶è¡Œ</strong>ï¼Œä½†å¯ä»¥<strong>äº¤æ›¿æ‰§è¡Œ</strong></td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-äºŒåŸºæœ¬è¯­æ³•ä¸ç”¨æ³•">âœ… äºŒã€åŸºæœ¬è¯­æ³•ä¸ç”¨æ³•</h2>
<h3 id="1-åˆ›å»ºä¸€ä¸ª-fiber">1. åˆ›å»ºä¸€ä¸ª Fiber</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">$fiber</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Fiber</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$arg</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;Start with: </span><span class="si">$arg\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="nv">$value</span> <span class="o">=</span> <span class="nx">Fiber</span><span class="o">::</span><span class="na">suspend</span><span class="p">(</span><span class="s1">&#39;æš‚åœå¹¶è¿”å›è¿™ä¸ªå€¼&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">    
</span></span><span class="line"><span class="ln">6</span><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;Resumed with: </span><span class="si">$value\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><h3 id="2-å¯åŠ¨--æ¢å¤">2. å¯åŠ¨ &amp; æ¢å¤</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">// ç¬¬ä¸€æ¬¡å¯åŠ¨ï¼ˆä¼ å…¥å‚æ•°ç»™é—­åŒ…ï¼‰
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nv">$result</span> <span class="o">=</span> <span class="nv">$fiber</span><span class="o">-&gt;</span><span class="na">start</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">);</span> 
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="k">echo</span> <span class="s2">&#34;ç¬¬ä¸€æ¬¡æŒ‚èµ·è¿”å›: </span><span class="si">$result\n</span><span class="s2">&#34;</span><span class="p">;</span> <span class="c1">// è¾“å‡º: æš‚åœå¹¶è¿”å›è¿™ä¸ªå€¼
</span></span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="c1">// æ¢å¤æ‰§è¡Œï¼ˆä¼ å€¼ç»™ suspend() çš„è¿”å›å€¼ï¼‰
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nv">$fiber</span><span class="o">-&gt;</span><span class="na">resume</span><span class="p">(</span><span class="s1">&#39;World&#39;</span><span class="p">);</span>
</span></span></code></pre></div><h3 id="è¾“å‡º">è¾“å‡ºï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">Start with: Hello
</span></span><span class="line"><span class="ln">2</span><span class="cl">ç¬¬ä¸€æ¬¡æŒ‚èµ·è¿”å›: æš‚åœå¹¶è¿”å›è¿™ä¸ªå€¼
</span></span><span class="line"><span class="ln">3</span><span class="cl">Resumed with: World
</span></span></code></pre></div><hr>
<h2 id="-ä¸‰å…³é”®æ–¹æ³•è¯¦è§£">ğŸ” ä¸‰ã€å…³é”®æ–¹æ³•è¯¦è§£</h2>
<table>
  <thead>
      <tr>
          <th>æ–¹æ³•</th>
          <th>ä½œç”¨</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>new Fiber(Closure $callback)</code></td>
          <td>åˆ›å»º Fiberï¼Œä¼ å…¥è¦æ‰§è¡Œçš„å‡½æ•°</td>
      </tr>
      <tr>
          <td><code>$fiber-&gt;start(mixed ...$args)</code></td>
          <td><strong>é¦–æ¬¡å¯åŠ¨</strong> Fiberï¼Œå‚æ•°ä¼ ç»™ <code>$callback</code></td>
      </tr>
      <tr>
          <td><code>$fiber-&gt;resume(mixed $value = null)</code></td>
          <td><strong>æ¢å¤</strong>å·²æŒ‚èµ·çš„ Fiberï¼Œ<code>$value</code> ä¼šä½œä¸º <code>Fiber::suspend()</code> çš„è¿”å›å€¼</td>
      </tr>
      <tr>
          <td><code>Fiber::suspend(mixed $value = null)</code></td>
          <td><strong>æŒ‚èµ·å½“å‰ Fiber</strong>ï¼Œå°† <code>$value</code> è¿”å›ç»™ <code>start()</code> æˆ– <code>resume()</code> çš„è°ƒç”¨è€…</td>
      </tr>
      <tr>
          <td><code>$fiber-&gt;isStarted()</code> / <code>isSuspended()</code> / <code>isTerminated()</code></td>
          <td>æ£€æŸ¥çŠ¶æ€</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-å››å®é™…åº”ç”¨åœºæ™¯">ğŸŒŸ å››ã€å®é™…åº”ç”¨åœºæ™¯</h2>
<h3 id="åœºæ™¯-1æ¨¡æ‹Ÿåç¨‹coroutine">åœºæ™¯ 1ï¼šæ¨¡æ‹Ÿåç¨‹ï¼ˆCoroutineï¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">function</span> <span class="nf">asyncTask</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$delay</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">return</span> <span class="k">new</span> <span class="nx">Fiber</span><span class="p">(</span><span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$delay</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;[</span><span class="si">$name</span><span class="s2">] å¼€å§‹</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">        <span class="nx">sleep</span><span class="p">(</span><span class="nv">$delay</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">        <span class="nx">Fiber</span><span class="o">::</span><span class="na">suspend</span><span class="p">(</span><span class="s2">&#34;[</span><span class="si">$name</span><span class="s2">] å®Œæˆ&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="nv">$task1</span> <span class="o">=</span> <span class="nx">asyncTask</span><span class="p">(</span><span class="s1">&#39;ä»»åŠ¡A&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="nv">$task2</span> <span class="o">=</span> <span class="nx">asyncTask</span><span class="p">(</span><span class="s1">&#39;ä»»åŠ¡B&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="c1">// æ‰‹åŠ¨è°ƒåº¦ï¼ˆçœŸå®åç¨‹åº“ä¼šè‡ªåŠ¨ç®¡ç†ï¼‰
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">echo</span> <span class="nv">$task1</span><span class="o">-&gt;</span><span class="na">start</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">echo</span> <span class="nv">$task2</span><span class="o">-&gt;</span><span class="na">start</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span></code></pre></div><blockquote>
<p>âš ï¸ æ³¨æ„ï¼šä¸Šé¢ä»æ˜¯<strong>é˜»å¡å¼ sleep</strong>ï¼ŒçœŸæ­£éé˜»å¡éœ€ç»“åˆäº‹ä»¶å¾ªç¯ï¼ˆå¦‚ Swooleã€ReactPHPï¼‰ã€‚</p>
</blockquote>
<hr>
<h3 id="åœºæ™¯-2ç®€åŒ–çŠ¶æ€æœºæˆ–åˆ†æ­¥é€»è¾‘">åœºæ™¯ 2ï¼šç®€åŒ–çŠ¶æ€æœºæˆ–åˆ†æ­¥é€»è¾‘</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">function</span> <span class="nf">stepByStepForm</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">return</span> <span class="k">new</span> <span class="nx">Fiber</span><span class="p">(</span><span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">        <span class="nv">$name</span> <span class="o">=</span> <span class="nx">Fiber</span><span class="o">::</span><span class="na">suspend</span><span class="p">(</span><span class="s1">&#39;è¯·è¾“å…¥å§“å:&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">        <span class="nv">$email</span> <span class="o">=</span> <span class="nx">Fiber</span><span class="o">::</span><span class="na">suspend</span><span class="p">(</span><span class="s1">&#39;è¯·è¾“å…¥é‚®ç®±:&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">        <span class="k">return</span> <span class="s2">&#34;æ³¨å†ŒæˆåŠŸ: </span><span class="si">$name</span><span class="s2"> &lt;</span><span class="si">$email</span><span class="s2">&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="nv">$fiber</span> <span class="o">=</span> <span class="nx">stepByStepForm</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="k">echo</span> <span class="nv">$fiber</span><span class="o">-&gt;</span><span class="na">start</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>      <span class="c1">// è¯·è¾“å…¥å§“å:
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="k">echo</span> <span class="nv">$fiber</span><span class="o">-&gt;</span><span class="na">resume</span><span class="p">(</span><span class="s1">&#39;Alice&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span> <span class="c1">// è¯·è¾“å…¥é‚®ç®±:
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="k">echo</span> <span class="nv">$fiber</span><span class="o">-&gt;</span><span class="na">resume</span><span class="p">(</span><span class="s1">&#39;alice@example.com&#39;</span><span class="p">);</span> <span class="c1">// æ³¨å†ŒæˆåŠŸ...
</span></span></span></code></pre></div><hr>
<h3 id="åœºæ™¯-3æ›¿ä»£å¤æ‚çš„å›è°ƒåµŒå¥—">åœºæ™¯ 3ï¼šæ›¿ä»£å¤æ‚çš„å›è°ƒåµŒå¥—</h3>
<p>ä¼ ç»Ÿå›è°ƒåœ°ç‹±ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">getData</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="nx">process</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">        <span class="nx">save</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="nv">$ok</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">});</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><p>ç”¨ Fiber å¯å†™æˆâ€œåŒæ­¥é£æ ¼â€ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">$fiber</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Fiber</span><span class="p">(</span><span class="k">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="nv">$data</span> <span class="o">=</span> <span class="nx">await</span><span class="p">(</span><span class="nx">getData</span><span class="p">());</span>      <span class="c1">// è‡ªå®šä¹‰ await å‡½æ•°å†…éƒ¨è°ƒç”¨ suspend
</span></span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">await</span><span class="p">(</span><span class="nx">process</span><span class="p">(</span><span class="nv">$data</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="nv">$ok</span> <span class="o">=</span> <span class="nx">await</span><span class="p">(</span><span class="nx">save</span><span class="p">(</span><span class="nv">$result</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="k">return</span> <span class="nv">$ok</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><blockquote>
<p>ï¼ˆéœ€è¦é…åˆäº‹ä»¶å¾ªç¯åº“å®ç°çœŸæ­£çš„ <code>await</code>ï¼‰</p>
</blockquote>
<hr>
<h2 id="-äº”é‡è¦æ³¨æ„äº‹é¡¹">âš ï¸ äº”ã€é‡è¦æ³¨æ„äº‹é¡¹</h2>
<table>
  <thead>
      <tr>
          <th>é—®é¢˜</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>ä¸æ˜¯å¤šçº¿ç¨‹</strong></td>
          <td>Fiber æ˜¯å•çº¿ç¨‹åä½œå¼ï¼Œ<strong>ä¸ä¼šåˆ©ç”¨å¤šæ ¸</strong></td>
      </tr>
      <tr>
          <td><strong>ä¸èƒ½è‡ªåŠ¨è°ƒåº¦</strong></td>
          <td>PHP ä¸ä¼šè‡ªåŠ¨åˆ‡æ¢ Fiberï¼Œéœ€æ‰‹åŠ¨ <code>resume()</code>ï¼ˆæˆ–ç”¨åç¨‹åº“ï¼‰</td>
      </tr>
      <tr>
          <td><strong>å¼‚å¸¸å¤„ç†</strong></td>
          <td>åœ¨ Fiber å†…æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¿…é¡»åœ¨ <code>start()</code>/<code>resume()</code> å¤–å±‚æ•è·</td>
      </tr>
      <tr>
          <td><strong>ä¸èƒ½è·¨è¯·æ±‚</strong></td>
          <td>Fiber ç”Ÿå‘½å‘¨æœŸé™äºå½“å‰è„šæœ¬æ‰§è¡Œ</td>
      </tr>
      <tr>
          <td><strong>å†…å­˜å®‰å…¨</strong></td>
          <td>æŒ‚èµ·æ—¶ä¼šä¿å­˜æ•´ä¸ªè°ƒç”¨æ ˆï¼Œé¿å…æ— é™é€’å½’å¯¼è‡´æ ˆæº¢å‡º</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-fibers-vs-generatorsç”Ÿæˆå™¨">ğŸ†š Fibers vs Generatorsï¼ˆç”Ÿæˆå™¨ï¼‰</h2>
<table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th>Generator</th>
          <th>Fiber</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>æ§åˆ¶æµ</strong></td>
          <td>åªèƒ½ä»å¤–å‘å†…ä¼ å€¼ï¼ˆ<code>send()</code>ï¼‰</td>
          <td>åŒå‘è‡ªç”±ä¼ å€¼</td>
      </tr>
      <tr>
          <td><strong>è°ƒç”¨æ ˆ</strong></td>
          <td>ä¸èƒ½åœ¨æ·±å±‚å‡½æ•°ä¸­ <code>yield</code></td>
          <td>å¯åœ¨ä»»æ„åµŒå¥—å‡½æ•°ä¸­ <code>suspend()</code></td>
      </tr>
      <tr>
          <td><strong>çµæ´»æ€§</strong></td>
          <td>ä»…ç”¨äºè¿­ä»£</td>
          <td>é€šç”¨åç¨‹åŸºç¡€</td>
      </tr>
      <tr>
          <td><strong>PHP ç‰ˆæœ¬</strong></td>
          <td>â‰¥ 5.5</td>
          <td>â‰¥ 8.1</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>âœ… <strong>Fiber æ˜¯ Generator çš„è¶…é›†</strong>ï¼ŒåŠŸèƒ½æ›´å¼ºå¤§ã€‚</p>
</blockquote>
<hr>
<h2 id="-å…­ç”Ÿæ€æ”¯æŒ">ğŸ“¦ å…­ã€ç”Ÿæ€æ”¯æŒ</h2>
<ul>
<li><strong>Swoole</strong>ï¼šå·²æ”¯æŒ Fiberï¼Œç”¨äºåç¨‹ç½‘ç»œç¼–ç¨‹</li>
<li><strong>ReactPHP</strong>ï¼šå®éªŒæ€§æ”¯æŒ</li>
<li><strong>Amphp</strong>ï¼šæ­£åœ¨é€‚é… Fiber API</li>
<li><strong>Laravel Octane</strong>ï¼šå¯ç»“åˆ Swoole + Fiber æå‡æ€§èƒ½</li>
</ul>
<hr>
<h2 id="-æ€»ç»“-8">âœ… æ€»ç»“</h2>
<table>
  <thead>
      <tr>
          <th>ä½ è¯¥è®°ä½çš„</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>Fiber</code> æ˜¯<strong>å¯æŒ‚èµ·/æ¢å¤çš„æ‰§è¡Œå•å…ƒ</strong></td>
          <td>ç±»ä¼¼â€œä¿å­˜æ¸¸æˆè¿›åº¦â€</td>
      </tr>
      <tr>
          <td><code>Fiber::suspend()</code> äº¤å‡ºæ§åˆ¶æƒ</td>
          <td>æŠŠå€¼ä¼ å›ç»™è°ƒç”¨è€…</td>
      </tr>
      <tr>
          <td><code>$fiber-&gt;resume()</code> ç»§ç»­æ‰§è¡Œ</td>
          <td>æŠŠå€¼ä¼ å›ç»™ <code>suspend()</code></td>
      </tr>
      <tr>
          <td><strong>ä¸æ˜¯å¹¶å‘ï¼Œè€Œæ˜¯åä½œå¼å¤šä»»åŠ¡</strong></td>
          <td>éœ€è¦ä¸»åŠ¨è®©å‡ºæ§åˆ¶æƒ</td>
      </tr>
      <tr>
          <td><strong>æ˜¯æ„å»ºç°ä»£ PHP åç¨‹ç³»ç»Ÿçš„åŸºçŸ³</strong></td>
          <td>æœªæ¥å¼‚æ­¥ç¼–ç¨‹çš„å…³é”®</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>ğŸ’¡ <strong>å»ºè®®</strong>ï¼š</p>
<ul>
<li>å¦‚æœä½ ç”¨ <strong>Swoole</strong>ï¼Œå¯ä»¥ç›´æ¥ç”¨å®ƒçš„åç¨‹ï¼›</li>
<li>å¦‚æœä½ å†™åº•å±‚æ¡†æ¶æˆ–æƒ³æ·±å…¥ç†è§£ PHP å¼‚æ­¥æ¨¡å‹ï¼ŒFiber å€¼å¾—æŒæ¡ï¼</li>
</ul>
</blockquote>
<h1 id="php-çš„-jitjust-in-time-compilationå³æ—¶ç¼–è¯‘-æ˜¯ä»-php-80-å¼€å§‹æ­£å¼å¼•å…¥çš„ä¸€é¡¹é‡å¤§æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯å®ƒçš„ç›®æ ‡æ˜¯æå‡-cpu-å¯†é›†å‹ä»»åŠ¡çš„æ‰§è¡Œé€Ÿåº¦è™½ç„¶å¯¹ä¼ ç»Ÿ-web-åº”ç”¨io-å¯†é›†å‹æå‡æœ‰é™ä½†åœ¨ç§‘å­¦è®¡ç®—æœºå™¨å­¦ä¹ æ¸¸æˆé€»è¾‘ç­‰åœºæ™¯ä¸­æ•ˆæœæ˜¾è‘—">PHP çš„ <strong>JITï¼ˆJust-In-Time Compilationï¼Œå³æ—¶ç¼–è¯‘ï¼‰</strong> æ˜¯ä» <strong>PHP 8.0</strong> å¼€å§‹æ­£å¼å¼•å…¥çš„ä¸€é¡¹é‡å¤§æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ã€‚å®ƒçš„ç›®æ ‡æ˜¯<strong>æå‡ CPU å¯†é›†å‹ä»»åŠ¡çš„æ‰§è¡Œé€Ÿåº¦</strong>ï¼Œè™½ç„¶å¯¹ä¼ ç»Ÿ Web åº”ç”¨ï¼ˆI/O å¯†é›†å‹ï¼‰æå‡æœ‰é™ï¼Œä½†åœ¨ç§‘å­¦è®¡ç®—ã€æœºå™¨å­¦ä¹ ã€æ¸¸æˆé€»è¾‘ç­‰åœºæ™¯ä¸­æ•ˆæœæ˜¾è‘—ã€‚</h1>
<hr>
<h2 id="-ä¸€jit-æ˜¯ä»€ä¹ˆç”¨äººè¯è§£é‡Š">ğŸŒŸ ä¸€ã€JIT æ˜¯ä»€ä¹ˆï¼Ÿâ€”â€”ç”¨äººè¯è§£é‡Š</h2>
<h3 id="ä¼ ç»Ÿ-php-æ‰§è¡Œæµç¨‹æ— -jit">ä¼ ç»Ÿ PHP æ‰§è¡Œæµç¨‹ï¼ˆæ—  JITï¼‰ï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">PHP æºä»£ç  
</span></span><span class="line"><span class="ln">2</span><span class="cl">   â†’ Zend å¼•æ“è§£æä¸º **Opcodeï¼ˆå­—èŠ‚ç ï¼‰** 
</span></span><span class="line"><span class="ln">3</span><span class="cl">   â†’ **Zend VMï¼ˆè™šæ‹Ÿæœºï¼‰é€æ¡è§£é‡Šæ‰§è¡Œ**
</span></span></code></pre></div><blockquote>
<p>â±ï¸ è§£é‡Šæ‰§è¡Œï¼šæ¯æ¬¡éƒ½è¦â€œç¿»è¯‘â€ Opcode æˆæœºå™¨æŒ‡ä»¤ï¼Œæ•ˆç‡è¾ƒä½ã€‚</p>
</blockquote>
<h3 id="å¯ç”¨-jit-å">å¯ç”¨ JIT åï¼š</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">PHP æºä»£ç  
</span></span><span class="line"><span class="ln">2</span><span class="cl">   â†’ ç”Ÿæˆ Opcode 
</span></span><span class="line"><span class="ln">3</span><span class="cl">   â†’ **JIT ç¼–è¯‘å™¨å°†çƒ­ç‚¹ Opcode ç›´æ¥ç¼–è¯‘æˆ CPU åŸç”Ÿæœºå™¨ç ** 
</span></span><span class="line"><span class="ln">4</span><span class="cl">   â†’ CPU ç›´æ¥è¿è¡Œæœºå™¨ç ï¼ˆè·³è¿‡è§£é‡Šæ­¥éª¤ï¼‰
</span></span></code></pre></div><blockquote>
<p>âš¡ ç»“æœï¼š<strong>CPU è®¡ç®—å¿«å¾ˆå¤šï¼</strong></p>
</blockquote>
<blockquote>
<p>ğŸ’¡ <strong>ç±»æ¯”</strong>ï¼š</p>
<ul>
<li>æ—  JITï¼šåƒåŒå£°ä¼ è¯‘ï¼ˆè¾¹å¬è¾¹ç¿»ï¼‰</li>
<li>æœ‰ JITï¼šæå‰æŠŠæ¼”è®²ç¨¿ç¿»è¯‘æˆä½ çš„æ¯è¯­ï¼Œç›´æ¥è¯»ï¼ˆæ›´å¿«æ›´æµç•…ï¼‰</li>
</ul>
</blockquote>
<hr>
<h2 id="-äºŒå¦‚ä½•å¯ç”¨-jit">ğŸ”§ äºŒã€å¦‚ä½•å¯ç”¨ JITï¼Ÿ</h2>
<p>JIT åœ¨ <strong>PHP 8.0+</strong> ä¸­é»˜è®¤<strong>åŒ…å«ä½†æœªå¯ç”¨</strong>ï¼ˆå› ä¸º Web åœºæ™¯æ”¶ç›Šå°ï¼‰ã€‚éœ€æ‰‹åŠ¨é…ç½® <code>php.ini</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">; å¯ç”¨ OPcacheï¼ˆJIT ä¾èµ–å®ƒï¼‰</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="na">opcache.enable</span><span class="o">=</span><span class="s">1</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="na">opcache.jit_buffer_size</span><span class="o">=</span><span class="s">100M  ; JIT ç¼“å†²åŒºå¤§å°ï¼ˆå¿…é¡» &gt; 0ï¼‰</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="na">opcache.jit</span><span class="o">=</span><span class="s">1235              ; JIT ç­–ç•¥ï¼ˆæœ€å¸¸ç”¨ï¼‰</span>
</span></span></code></pre></div><h3 id="opcachejit-å€¼è¯´æ˜4ä½æ•°å­—crto"><code>opcache.jit</code> å€¼è¯´æ˜ï¼ˆ4ä½æ•°å­—ï¼šCRTOï¼‰</h3>
<table>
  <thead>
      <tr>
          <th>ä½</th>
          <th>å«ä¹‰</th>
          <th>å¸¸è§å€¼</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>C (CPU)</td>
          <td>CPU ç‰¹æ€§</td>
          <td><code>1</code> = å¯ç”¨ AVXï¼ˆé»˜è®¤ï¼‰</td>
      </tr>
      <tr>
          <td>R (è§¦å‘)</td>
          <td>ä½•æ—¶ç¼–è¯‘</td>
          <td><code>2</code> = å‡½æ•°é¦–æ¬¡è°ƒç”¨æ—¶ç¼–è¯‘</td>
      </tr>
      <tr>
          <td>T (ç±»å‹)</td>
          <td>ç¼–è¯‘ç›®æ ‡</td>
          <td><code>3</code> = æ ¹æ®ç±»å‹æ¨å¯¼ä¼˜åŒ–</td>
      </tr>
      <tr>
          <td>O (ä¼˜åŒ–)</td>
          <td>ä¼˜åŒ–çº§åˆ«</td>
          <td><code>5</code> = æœ€é«˜ä¼˜åŒ–ï¼ˆå«å†…è”ç­‰ï¼‰</td>
      </tr>
  </tbody>
</table>
<p>âœ… <strong>æ¨èå€¼</strong>ï¼š</p>
<ul>
<li><code>1235</code>ï¼šå¹³è¡¡æ€§èƒ½ä¸å†…å­˜ï¼ˆæœ€å¸¸ç”¨ï¼‰</li>
<li><code>1254</code>ï¼šæ›´é«˜ä¼˜åŒ–ï¼ˆé€‚åˆ CPU å¯†é›†å‹ï¼‰</li>
<li><code>0</code>ï¼šå…³é—­ JIT</li>
</ul>
<blockquote>
<p>ğŸ” æŸ¥çœ‹æ˜¯å¦ç”Ÿæ•ˆï¼š</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln">1</span><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nx">opcache_get_status</span><span class="p">()[</span><span class="s1">&#39;jit&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1">// å¦‚æœè¿”å› arrayï¼Œè¯´æ˜ JIT å·²å¯ç”¨
</span></span></span></code></pre></div><hr>
<h2 id="-ä¸‰jit-èƒ½æå‡å¤šå°‘æ€§èƒ½">ğŸ“Š ä¸‰ã€JIT èƒ½æå‡å¤šå°‘æ€§èƒ½ï¼Ÿ</h2>
<h3 id="-æ˜¾è‘—æå‡çš„åœºæ™¯cpu-å¯†é›†å‹">âœ… æ˜¾è‘—æå‡çš„åœºæ™¯ï¼ˆCPU å¯†é›†å‹ï¼‰ï¼š</h3>
<table>
  <thead>
      <tr>
          <th>ä»»åŠ¡</th>
          <th>PHP 7.4</th>
          <th>PHP 8.0 + JIT</th>
          <th>æå‡</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>æ•°å­¦è®¡ç®—ï¼ˆå¦‚ Mandelbrotï¼‰</td>
          <td>100%</td>
          <td>~20%</td>
          <td><strong>5å€+</strong></td>
      </tr>
      <tr>
          <td>åŠ å¯†/å“ˆå¸Œè¿ç®—</td>
          <td>100%</td>
          <td>~30%</td>
          <td><strong>3å€+</strong></td>
      </tr>
      <tr>
          <td>æ­£åˆ™è¡¨è¾¾å¼ï¼ˆå¤æ‚æ¨¡å¼ï¼‰</td>
          <td>100%</td>
          <td>~60%</td>
          <td><strong>1.6å€</strong></td>
      </tr>
  </tbody>
</table>
<h3 id="-å‡ ä¹æ— æå‡çš„åœºæ™¯io-å¯†é›†å‹">âŒ å‡ ä¹æ— æå‡çš„åœºæ™¯ï¼ˆI/O å¯†é›†å‹ï¼‰ï¼š</h3>
<ul>
<li>Web è¯·æ±‚ï¼ˆæ•°æ®åº“æŸ¥è¯¢ã€æ–‡ä»¶è¯»å†™ã€API è°ƒç”¨ï¼‰</li>
<li>å¤§å¤šæ•° Laravel / WordPress ç½‘ç«™</li>
</ul>
<blockquote>
<p>ğŸ’¡ å› ä¸ºç“¶é¢ˆåœ¨ <strong>ç£ç›˜/ç½‘ç»œ</strong>ï¼Œä¸åœ¨ CPU</p>
</blockquote>
<hr>
<h2 id="-å››jit-çš„å·¥ä½œåŸç†ç®€åŒ–ç‰ˆ">âš™ï¸ å››ã€JIT çš„å·¥ä½œåŸç†ï¼ˆç®€åŒ–ç‰ˆï¼‰</h2>
<ol>
<li><strong>ç›‘æ§æ‰§è¡Œ</strong>ï¼šOPcache è®°å½•å“ªäº›å‡½æ•°/ä»£ç å—è¢«é¢‘ç¹è°ƒç”¨ï¼ˆâ€œçƒ­ç‚¹ä»£ç â€ï¼‰</li>
<li><strong>è§¦å‘ç¼–è¯‘</strong>ï¼šå½“çƒ­ç‚¹ä»£ç è¾¾åˆ°é˜ˆå€¼ï¼ŒJIT å°†å…¶ Opcode ç¼–è¯‘ä¸º x86/ARM æœºå™¨ç </li>
<li><strong>ç¼“å­˜æœºå™¨ç </strong>ï¼šå­˜å…¥ <code>jit_buffer</code>ï¼Œä¸‹æ¬¡ç›´æ¥æ‰§è¡Œ</li>
<li><strong>å›é€€æœºåˆ¶</strong>ï¼šå¦‚æœç±»å‹å˜åŒ–å¯¼è‡´ä¼˜åŒ–å¤±æ•ˆï¼Œè‡ªåŠ¨å›é€€åˆ°è§£é‡Šæ‰§è¡Œ</li>
</ol>
<blockquote>
<p>ğŸ”¬ æŠ€æœ¯ç»†èŠ‚ï¼šPHP JIT åŸºäº <strong>DynASM</strong>ï¼ˆLuaJIT çš„æ±‡ç¼–å™¨ï¼‰ï¼Œç›´æ¥ç”Ÿæˆåº•å±‚æ±‡ç¼–ç ã€‚</p>
</blockquote>
<hr>
<h2 id="-äº”æ³¨æ„äº‹é¡¹--å¸¸è§è¯¯åŒº">âš ï¸ äº”ã€æ³¨æ„äº‹é¡¹ &amp; å¸¸è§è¯¯åŒº</h2>
<table>
  <thead>
      <tr>
          <th>è¯¯åŒº</th>
          <th>çœŸç›¸</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>â€œJIT è®©æ‰€æœ‰ PHP ç¨‹åºå˜å¿«â€</td>
          <td>âŒ åªåŠ é€Ÿ CPU è®¡ç®—ï¼ŒWeb åº”ç”¨é€šå¸¸ä¸æ˜æ˜¾</td>
      </tr>
      <tr>
          <td>â€œJIT ä¼šå¢åŠ å†…å­˜â€</td>
          <td>âœ… éœ€è¦é¢å¤–å†…å­˜å­˜æœºå™¨ç ï¼ˆ<code>jit_buffer_size</code>ï¼‰</td>
      </tr>
      <tr>
          <td>â€œJIT å’Œ OPcache å†²çªâ€</td>
          <td>âŒ JIT <strong>ä¾èµ– OPcache</strong>ï¼Œå¿…é¡»åŒæ—¶å¼€å¯</td>
      </tr>
      <tr>
          <td>â€œJIT ä¼šè®©ç¨‹åºä¸ç¨³å®šâ€</td>
          <td>âš ï¸ æå°‘æ•°æƒ…å†µä¸‹å¯èƒ½æœ‰ bugï¼ˆPHP 8.1+ å·²å¾ˆç¨³å®šï¼‰</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-å…­æµ‹è¯•-jit-æ•ˆæœç®€å•ä¾‹å­">ğŸ§ª å…­ã€æµ‹è¯• JIT æ•ˆæœï¼ˆç®€å•ä¾‹å­ï¼‰</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">// test.php
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="k">function</span> <span class="nf">mandelbrot</span><span class="p">(</span><span class="nv">$n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="nv">$sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$n</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">        <span class="nv">$zr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$zi</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$tr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$ti</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="nv">$j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">;</span> <span class="nv">$j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">            <span class="nv">$tr</span> <span class="o">=</span> <span class="nv">$zr</span> <span class="o">*</span> <span class="nv">$zr</span> <span class="o">-</span> <span class="nv">$zi</span> <span class="o">*</span> <span class="nv">$zi</span> <span class="o">+</span> <span class="mf">0.3</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">            <span class="nv">$ti</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nv">$zr</span> <span class="o">*</span> <span class="nv">$zi</span> <span class="o">+</span> <span class="mf">0.6</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$tr</span> <span class="o">*</span> <span class="nv">$tr</span> <span class="o">+</span> <span class="nv">$ti</span> <span class="o">*</span> <span class="nv">$ti</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">            <span class="nv">$zr</span> <span class="o">=</span> <span class="nv">$tr</span><span class="p">;</span> <span class="nv">$zi</span> <span class="o">=</span> <span class="nv">$ti</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="nv">$sum</span> <span class="o">+=</span> <span class="nv">$j</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="k">return</span> <span class="nv">$sum</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="nv">$start</span> <span class="o">=</span> <span class="nx">microtime</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="nx">mandelbrot</span><span class="p">(</span><span class="mi">5000</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="k">echo</span> <span class="s2">&#34;Time: &#34;</span> <span class="o">.</span> <span class="p">(</span><span class="nx">microtime</span><span class="p">(</span><span class="k">true</span><span class="p">)</span> <span class="o">-</span> <span class="nv">$start</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&#34;s</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span></code></pre></div><p>åˆ†åˆ«ç”¨ <strong>PHP 8.0+ å…³é—­ JIT</strong> å’Œ <strong>å¼€å¯ JIT</strong> è¿è¡Œï¼Œå¯¹æ¯”æ—¶é—´ï¼</p>
<hr>
<h2 id="-ä¸ƒæ€»ç»“ä½ åº”è¯¥å…³å¿ƒ-jit-å—">ğŸ“Œ ä¸ƒã€æ€»ç»“ï¼šä½ åº”è¯¥å…³å¿ƒ JIT å—ï¼Ÿ</h2>
<table>
  <thead>
      <tr>
          <th>ä½ çš„åœºæ™¯</th>
          <th>å»ºè®®</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>æ™®é€š Web å¼€å‘ï¼ˆLaravel, WordPressï¼‰</td>
          <td>ğŸ”¸ <strong>ä¸ç”¨ç‰¹åˆ«å…³æ³¨</strong>ï¼Œä¿æŒé»˜è®¤å³å¯</td>
      </tr>
      <tr>
          <td>é«˜æ€§èƒ½è®¡ç®—ï¼ˆAIã€ç§‘å­¦è®¡ç®—ã€æ¸¸æˆæœåŠ¡å™¨ï¼‰</td>
          <td>âœ… <strong>åŠ¡å¿…å¼€å¯ JIT</strong>ï¼Œæ€§èƒ½é£è·ƒ</td>
      </tr>
      <tr>
          <td>å¾®æœåŠ¡/CLI å·¥å…·ï¼ˆå¤§é‡æ•°æ®å¤„ç†ï¼‰</td>
          <td>ğŸ”¸ <strong>æµ‹è¯•åå†³å®š</strong>ï¼Œå¯èƒ½æœ‰æ”¶ç›Š</td>
      </tr>
      <tr>
          <td>ä½å†…å­˜ç¯å¢ƒï¼ˆ&lt; 512MBï¼‰</td>
          <td>âŒ <strong>è°¨æ…å¼€å¯</strong>ï¼Œé¿å… OOM</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>ğŸ’¡ <strong>æœ€ä½³å®è·µ</strong>ï¼š</p>
<ul>
<li>ç”Ÿäº§ç¯å¢ƒå…ˆ <strong>å‹æµ‹å¯¹æ¯”</strong>ï¼ˆå¼€/å…³ JITï¼‰</li>
<li>ä» <code>opcache.jit=1235</code> å¼€å§‹å°è¯•</li>
<li>ç›‘æ§å†…å­˜ä½¿ç”¨ï¼ˆ<code>jit_buffer_size</code> ä¸å®œè¿‡å¤§ï¼‰</li>
</ul>
</blockquote>
<hr>
<h2 id="-æœªæ¥å±•æœ›php-9">ğŸ”® æœªæ¥å±•æœ›ï¼ˆPHP 9+ï¼‰</h2>
<ul>
<li>æ›´æ™ºèƒ½çš„çƒ­ç‚¹æ£€æµ‹</li>
<li>æ›´æ·±åº¦çš„ç±»å‹æ¨å¯¼ä¼˜åŒ–</li>
<li>ä¸ Fiber åç¨‹ç»“åˆï¼Œæ‰“é€ é«˜æ€§èƒ½å¼‚æ­¥ç”Ÿæ€</li>
</ul>
<hr>

    </div><div class="post_comments">
  
  
  
  
</div>




  </article>
<aside class="sidebar">
  <section class="sidebar_inner">
    <br>
    
  
  <div class="search">
    <input type="search" class="search_field form_field" placeholder='æœç´¢å†…å®¹...' id="find" autocomplete="off" data-scope='post'>
    <label for="find" class="search_label"><svg class="icon">
  <title>search</title>
  <use xlink:href="#search"></use>
</svg>

    </label>
    
    <div class="search_results results"></div>
  </div>

        <div class="author_header">
          <img src="https://jianlin-li.github.io/images/fish-head.png" alt="æå»ºæ— photo">
          <h2>æå»ºæ—</h2>
        </div>
      <div class="author_bio">
        PHP, GoLang, Docker, Kubernetes, MySQL, Redis, RabbitMQ, Elasticsearch, Yii, Laravel
      </div>
      <a href='https://jianlin-li.github.io/about/' class="button mt-1" role="button" title='é˜…è¯»æ›´å¤š'>é˜…è¯»æ›´å¤š</a>

    
    <h2 class="mt-4">ç²¾é€‰æ–‡ç« </h2>
    <ul>
      <li>
        <a href="https://jianlin-li.github.io/post/elasticsearch_review_2/" class="nav-link" title="Elasticsearchçš„çŸ¥è¯†ç‚¹-2">Elasticsearchçš„çŸ¥è¯†ç‚¹-2</a>
      </li>
      <li>
        <a href="https://jianlin-li.github.io/post/elasticsearch_review_1/" class="nav-link" title="Elasticsearchçš„çŸ¥è¯†ç‚¹-1">Elasticsearchçš„çŸ¥è¯†ç‚¹-1</a>
      </li>
      <li>
        <a href="https://jianlin-li.github.io/post/docker_review_1/" class="nav-link" title="Dockerçš„çŸ¥è¯†ç‚¹-1">Dockerçš„çŸ¥è¯†ç‚¹-1</a>
      </li>
      <li>
        <a href="https://jianlin-li.github.io/post/go_review_4/" class="nav-link" title="Goè¯­è¨€çš„çŸ¥è¯†ç‚¹-4">Goè¯­è¨€çš„çŸ¥è¯†ç‚¹-4</a>
      </li>
      <li>
        <a href="https://jianlin-li.github.io/post/go_review_3/" class="nav-link" title="Goè¯­è¨€çš„çŸ¥è¯†ç‚¹-3">Goè¯­è¨€çš„çŸ¥è¯†ç‚¹-3</a>
      </li>
      <li>
        <a href="https://jianlin-li.github.io/post/go_review_2/" class="nav-link" title="Goè¯­è¨€çš„çŸ¥è¯†ç‚¹-2">Goè¯­è¨€çš„çŸ¥è¯†ç‚¹-2</a>
      </li>
      <li>
        <a href="https://jianlin-li.github.io/post/go_review_1/" class="nav-link" title="Goè¯­è¨€çš„çŸ¥è¯†ç‚¹-1">Goè¯­è¨€çš„çŸ¥è¯†ç‚¹-1</a>
      </li>
      <li>
        <a href="https://jianlin-li.github.io/post/go_review/" class="nav-link" title="Goè¯­è¨€çš„çŸ¥è¯†ç‚¹--GOPATHå’ŒGo Modules">Goè¯­è¨€çš„çŸ¥è¯†ç‚¹--GOPATHå’ŒGo Modules</a>
      </li>
    </ul>
    <h2 class="mt-4">æœ€æ–°æ–‡ç« </h2>
    <ul class="flex-column">
      <li>
        <a href="https://jianlin-li.github.io/post/rabbitmq_review/" class="nav-link" title="RabbitMQæ¶ˆæ¯ä¸­é—´ä»¶è¯¦è§£">RabbitMQæ¶ˆæ¯ä¸­é—´ä»¶è¯¦è§£</a>
      </li>
      <li>
        <a href="https://jianlin-li.github.io/post/php_review_4/" class="nav-link" title="PHPè¯­è¨€çš„çŸ¥è¯†ç‚¹-4">PHPè¯­è¨€çš„çŸ¥è¯†ç‚¹-4</a>
      </li>
      <li>
        <a href="https://jianlin-li.github.io/post/php_review_3/" class="nav-link" title="PHPè¯­è¨€çš„çŸ¥è¯†ç‚¹-3">PHPè¯­è¨€çš„çŸ¥è¯†ç‚¹-3</a>
      </li>
      <li>
        <a href="https://jianlin-li.github.io/post/php_review_2/" class="nav-link" title="PHPè¯­è¨€çš„çŸ¥è¯†ç‚¹-2">PHPè¯­è¨€çš„çŸ¥è¯†ç‚¹-2</a>
      </li>
      <li>
        <a href="https://jianlin-li.github.io/post/php_review_1/" class="nav-link" title="PHPè¯­è¨€çš„çŸ¥è¯†ç‚¹-1">PHPè¯­è¨€çš„çŸ¥è¯†ç‚¹-1</a>
      </li>
      <li>
        <a href="https://jianlin-li.github.io/post/luoxi/" class="nav-link" title="åå¾®ä¸–çºªç›¸å…³è„šæœ¬è§£å†³æ–¹æ¡ˆ">åå¾®ä¸–çºªç›¸å…³è„šæœ¬è§£å†³æ–¹æ¡ˆ</a>
      </li>
      <li>
        <a href="https://jianlin-li.github.io/post/book_review/" class="nav-link" title="é˜…è¯»è¿‡çš„ä¹¦ç±ä¸çœ‹è¿‡çš„è§†é¢‘">é˜…è¯»è¿‡çš„ä¹¦ç±ä¸çœ‹è¿‡çš„è§†é¢‘</a>
      </li>
      <li>
        <a href="https://jianlin-li.github.io/post/local_hosts_bak/" class="nav-link" title="æœ¬åœ°hostsçš„å¼€å‘ç¯å¢ƒå¤‡ä»½">æœ¬åœ°hostsçš„å¼€å‘ç¯å¢ƒå¤‡ä»½</a>
      </li>
    </ul>
    <div>
      <h2 class="mt-4 taxonomy" id="categories-section">åˆ†ç±»</h2>
      <nav class="tags_nav">
        <a href='https://jianlin-li.github.io/categories/go%E8%AF%AD%E8%A8%80/' class="post_tag button button_translucent" title="goè¯­è¨€">
          GOè¯­è¨€
          <span class="button_tally">5</span>
        </a>
        
        <a href='https://jianlin-li.github.io/categories/php%E8%AF%AD%E8%A8%80/' class="post_tag button button_translucent" title="phpè¯­è¨€">
          PHPè¯­è¨€
          <span class="button_tally">4</span>
        </a>
        
        <a href='https://jianlin-li.github.io/categories/elasticsearch/' class="post_tag button button_translucent" title="elasticsearch">
          ELASTICSEARCH
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://jianlin-li.github.io/categories/%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83/' class="post_tag button button_translucent" title="æœ¬åœ°ç¯å¢ƒ">
          æœ¬åœ°ç¯å¢ƒ
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://jianlin-li.github.io/categories/docker/' class="post_tag button button_translucent" title="docker">
          DOCKER
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://jianlin-li.github.io/categories/hugo/' class="post_tag button button_translucent" title="hugo">
          HUGO
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://jianlin-li.github.io/categories/rabbitmq/' class="post_tag button button_translucent" title="rabbitmq">
          RABBITMQ
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://jianlin-li.github.io/categories/%E4%B9%A6%E7%B1%8D/' class="post_tag button button_translucent" title="ä¹¦ç±">
          ä¹¦ç±
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://jianlin-li.github.io/categories/%E5%8D%8E%E5%BE%AE%E4%B8%96%E7%BA%AA/' class="post_tag button button_translucent" title="åå¾®ä¸–çºª">
          åå¾®ä¸–çºª
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://jianlin-li.github.io/categories/%E5%A4%8D%E4%B9%A0/' class="post_tag button button_translucent" title="å¤ä¹ ">
          å¤ä¹ 
          <span class="button_tally">1</span>
        </a>
        
        
        <br>
        <div class="post_tags_toggle button">æ‰€æœ‰åˆ†ç±»</div>
        <div class="post_tags">
          <div class="tags_list">
            
            <a href='https://jianlin-li.github.io/categories/docker/' class=" post_tag button button_translucent" data-position=1 title="docker">DOCKER<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/categories/elasticsearch/' class=" post_tag button button_translucent" data-position=2 title="elasticsearch">ELASTICSEARCH<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/categories/go%E8%AF%AD%E8%A8%80/' class=" post_tag button button_translucent" data-position=5 title="goè¯­è¨€">GOè¯­è¨€<span class="button_tally">5</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/categories/hugo/' class=" post_tag button button_translucent" data-position=1 title="hugo">HUGO<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/categories/php%E8%AF%AD%E8%A8%80/' class=" post_tag button button_translucent" data-position=4 title="phpè¯­è¨€">PHPè¯­è¨€<span class="button_tally">4</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/categories/rabbitmq/' class=" post_tag button button_translucent" data-position=1 title="rabbitmq">RABBITMQ<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/categories/%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83/' class=" post_tag button button_translucent" data-position=2 title="æœ¬åœ°ç¯å¢ƒ">æœ¬åœ°ç¯å¢ƒ<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/categories/%E5%A4%8D%E4%B9%A0/' class=" post_tag button button_translucent" data-position=1 title="å¤ä¹ ">å¤ä¹ <span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/categories/%E5%8D%8E%E5%BE%AE%E4%B8%96%E7%BA%AA/' class=" post_tag button button_translucent" data-position=1 title="åå¾®ä¸–çºª">åå¾®ä¸–çºª<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/categories/%E6%95%99%E7%A8%8B/' class=" post_tag button button_translucent" data-position=1 title="æ•™ç¨‹">æ•™ç¨‹<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/categories/%E8%A7%86%E9%A2%91/' class=" post_tag button button_translucent" data-position=1 title="è§†é¢‘">è§†é¢‘<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/categories/%E4%B9%A6%E7%B1%8D/' class=" post_tag button button_translucent" data-position=1 title="ä¹¦ç±">ä¹¦ç±<span class="button_tally">1</span>
            </a>
            
            <div class="tags_sort"><span title="sort alphabetically">[A~Z]</span><span title="sort by count">[0~9]</span>
            </div>
            <span class="tags_hide"><svg class="icon">
            <use xlink:href="#closeme"></use>
          </svg></span>
          </div>
        </div>
      </nav>
    </div>
    <div>
      <h2 class="mt-4 taxonomy" id="tags-section">æ ‡ç­¾</h2>
      <nav class="tags_nav">
        <a href='https://jianlin-li.github.io/tags/go/' class="post_tag button button_translucent" title="go">
          GO
          <span class="button_tally">5</span>
        </a>
        
        <a href='https://jianlin-li.github.io/tags/php/' class="post_tag button button_translucent" title="php">
          PHP
          <span class="button_tally">4</span>
        </a>
        
        <a href='https://jianlin-li.github.io/tags/elasticsearch/' class="post_tag button button_translucent" title="elasticsearch">
          ELASTICSEARCH
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://jianlin-li.github.io/tags/docker/' class="post_tag button button_translucent" title="docker">
          DOCKER
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://jianlin-li.github.io/tags/emoji/' class="post_tag button button_translucent" title="emoji">
          EMOJI
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://jianlin-li.github.io/tags/hosts/' class="post_tag button button_translucent" title="hosts">
          HOSTS
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://jianlin-li.github.io/tags/hugo/' class="post_tag button button_translucent" title="hugo">
          HUGO
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://jianlin-li.github.io/tags/markdown/' class="post_tag button button_translucent" title="markdown">
          MARKDOWN
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://jianlin-li.github.io/tags/math/' class="post_tag button button_translucent" title="math">
          MATH
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://jianlin-li.github.io/tags/notices/' class="post_tag button button_translucent" title="notices">
          NOTICES
          <span class="button_tally">1</span>
        </a>
        
        
        <br>
        <div class="post_tags_toggle button">æ‰€æœ‰æ ‡ç­¾</div>
        <div class="post_tags">
          <div class="tags_list">
            
            <a href='https://jianlin-li.github.io/tags/docker/' class=" post_tag button button_translucent" data-position=1 title="docker">DOCKER<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/elasticsearch/' class=" post_tag button button_translucent" data-position=2 title="elasticsearch">ELASTICSEARCH<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/emoji/' class=" post_tag button button_translucent" data-position=1 title="emoji">EMOJI<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/go/' class=" post_tag button button_translucent" data-position=5 title="go">GO<span class="button_tally">5</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/hosts/' class=" post_tag button button_translucent" data-position=1 title="hosts">HOSTS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/hugo/' class=" post_tag button button_translucent" data-position=1 title="hugo">HUGO<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/markdown/' class=" post_tag button button_translucent" data-position=1 title="markdown">MARKDOWN<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/math/' class=" post_tag button button_translucent" data-position=1 title="math">MATH<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/notices/' class=" post_tag button button_translucent" data-position=1 title="notices">NOTICES<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/openstreetmap/' class=" post_tag button button_translucent" data-position=1 title="openstreetmap">OPENSTREETMAP<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/php/' class=" post_tag button button_translucent" data-position=4 title="php">PHP<span class="button_tally">4</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/rabbitmq/' class=" post_tag button button_translucent" data-position=1 title="rabbitmq">RABBITMQ<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/sql/' class=" post_tag button button_translucent" data-position=1 title="sql">SQL<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83/' class=" post_tag button button_translucent" data-position=1 title="æœ¬åœ°ç¯å¢ƒ">æœ¬åœ°ç¯å¢ƒ<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/%E5%A4%8D%E4%B9%A0/' class=" post_tag button button_translucent" data-position=1 title="å¤ä¹ ">å¤ä¹ <span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/%E6%95%99%E7%A8%8B/' class=" post_tag button button_translucent" data-position=1 title="æ•™ç¨‹">æ•™ç¨‹<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/%E4%B9%B1%E7%A0%81/' class=" post_tag button button_translucent" data-position=1 title="ä¹±ç ">ä¹±ç <span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/%E8%A7%86%E9%A2%91/' class=" post_tag button button_translucent" data-position=1 title="è§†é¢‘">è§†é¢‘<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://jianlin-li.github.io/tags/%E4%B9%A6%E7%B1%8D/' class=" post_tag button button_translucent" data-position=1 title="ä¹¦ç±">ä¹¦ç±<span class="button_tally">1</span>
            </a>
            
            <div class="tags_sort"><span title="sort alphabetically">[A~Z]</span><span title="sort by count">[0~9]</span>
            </div>
            <span class="tags_hide"><svg class="icon">
            <use xlink:href="#closeme"></use>
          </svg></span>
          </div>
        </div>
      </nav>
    </div>
  </section>
</aside>

  
</div>
    </main><svg width="0" height="0" class="hidden">
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="facebook">
    <path d="M437 0H75C33.648 0 0 33.648 0 75v362c0 41.352 33.648 75 75 75h151V331h-60v-90h60v-61c0-49.629 40.371-90 90-90h91v90h-91v61h91l-15 90h-76v181h121c41.352 0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zm0 0"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.001 18.001" id="twitter">
    <path d="M15.891 4.013c.808-.496 1.343-1.173 1.605-2.034a8.68 8.68 0 0 1-2.351.861c-.703-.756-1.593-1.14-2.66-1.14-1.043 0-1.924.366-2.643 1.078a3.56 3.56 0 0 0-1.076 2.605c0 .309.039.585.117.819-3.076-.105-5.622-1.381-7.628-3.837-.34.601-.51 1.213-.51 1.846 0 1.301.549 2.332 1.645 3.089-.625-.053-1.176-.211-1.645-.47 0 .929.273 1.705.82 2.388a3.623 3.623 0 0 0 2.115 1.291c-.312.08-.641.118-.979.118-.312 0-.533-.026-.664-.083.23.757.664 1.371 1.291 1.841a3.652 3.652 0 0 0 2.152.743C4.148 14.173 2.625 14.69.902 14.69c-.422 0-.721-.006-.902-.038 1.697 1.102 3.586 1.649 5.676 1.649 2.139 0 4.029-.542 5.674-1.626 1.645-1.078 2.859-2.408 3.639-3.974a10.77 10.77 0 0 0 1.172-4.892v-.468a7.788 7.788 0 0 0 1.84-1.921 8.142 8.142 0 0 1-2.11.593z"
      ></path>
  </symbol>
  <symbol aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="mail">
    <path  d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="calendar">
    <path d="M452 40h-24V0h-40v40H124V0H84v40H60C26.916 40 0 66.916 0 100v352c0 33.084 26.916 60 60 60h392c33.084 0 60-26.916 60-60V100c0-33.084-26.916-60-60-60zm20 412c0 11.028-8.972 20-20 20H60c-11.028 0-20-8.972-20-20V188h432v264zm0-304H40v-48c0-11.028 8.972-20 20-20h24v40h40V80h264v40h40V80h24c11.028 0 20 8.972 20 20v48z"></path>
    <path d="M76 230h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 310h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 390h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80-80h40v40h-40z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="github">
    <path d="M255.968 5.329C114.624 5.329 0 120.401 0 262.353c0 113.536 73.344 209.856 175.104 243.872 12.8 2.368 17.472-5.568 17.472-12.384 0-6.112-.224-22.272-.352-43.712-71.2 15.52-86.24-34.464-86.24-34.464-11.616-29.696-28.416-37.6-28.416-37.6-23.264-15.936 1.728-15.616 1.728-15.616 25.696 1.824 39.2 26.496 39.2 26.496 22.848 39.264 59.936 27.936 74.528 21.344 2.304-16.608 8.928-27.936 16.256-34.368-56.832-6.496-116.608-28.544-116.608-127.008 0-28.064 9.984-51.008 26.368-68.992-2.656-6.496-11.424-32.64 2.496-68 0 0 21.504-6.912 70.4 26.336 20.416-5.696 42.304-8.544 64.096-8.64 21.728.128 43.648 2.944 64.096 8.672 48.864-33.248 70.336-26.336 70.336-26.336 13.952 35.392 5.184 61.504 2.56 68 16.416 17.984 26.304 40.928 26.304 68.992 0 98.72-59.84 120.448-116.864 126.816 9.184 7.936 17.376 23.616 17.376 47.584 0 34.368-.32 62.08-.32 70.496 0 6.88 4.608 14.88 17.6 12.352C438.72 472.145 512 375.857 512 262.353 512 120.401 397.376 5.329 255.968 5.329z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212 212" id="gitlab">
    <path d="M12.3 74.7h54L43.3 3c-1-3.6-6.4-3.6-7.6 0L12.3 74.8z" />
    <path d="M12.3 74.7L.5 111c-1 3.2 0 6.8 3 8.8l101.6 74-92.5-119z"/>
    <path d="M105 193.7l-38.6-119h-54l92.7 119z"/>
    <path d="M105 193.7l38.7-119H66.4l38.7 119z"/>
    <path d="M105 193.7l38.7-119H198l-93 119z"/>
    <path d="M198 74.7l11.6 36.2c1 3 0 6.6-3 8.6l-101.5 74 93-119z"/>
    <path d="M198 74.7h-54.3L167 3c1.2-3.6 6.4-3.6 7.6 0L198 74.8z"/>
  </symbol>
  <symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="rss">
    <circle cx="3.429" cy="20.571" r="3.429"></circle>
    <path d="M11.429 24h4.57C15.999 15.179 8.821 8.001 0 8v4.572c6.302.001 11.429 5.126 11.429 11.428z"></path>
    <path d="M24 24C24 10.766 13.234 0 0 0v4.571c10.714 0 19.43 8.714 19.43 19.429z"></path>
  </symbol>
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="linkedin">
    <path d="M437 0H75C33.648 0 0 33.648 0 75v362c0 41.352 33.648 75 75 75h362c41.352 0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zM181 406h-60V196h60zm0-240h-60v-60h60zm210 240h-60V286c0-16.54-13.46-30-30-30s-30 13.46-30 30v120h-60V196h60v11.309C286.719 202.422 296.93 196 316 196c40.691.043 75 36.547 75 79.688zm0 0"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612" id="to-top">
    <path d="M604.501 440.509L325.398 134.956c-5.331-5.357-12.423-7.627-19.386-7.27-6.989-.357-14.056 1.913-19.387 7.27L7.499 440.509c-9.999 10.024-9.999 26.298 0 36.323s26.223 10.024 36.222 0l262.293-287.164L568.28 476.832c9.999 10.024 26.222 10.024 36.221 0 9.999-10.023 9.999-26.298 0-36.323z"></path>
  </symbol>
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="carly">
    <path d="M504.971 239.029L448 182.059V84c0-46.317-37.682-84-84-84h-44c-13.255 0-24 10.745-24 24s10.745 24 24 24h44c19.851 0 36 16.149 36 36v108c0 6.365 2.529 12.47 7.029 16.971L454.059 256l-47.029 47.029A24.002 24.002 0 0 0 400 320v108c0 19.851-16.149 36-36 36h-44c-13.255 0-24 10.745-24 24s10.745 24 24 24h44c46.318 0 84-37.683 84-84v-98.059l56.971-56.971c9.372-9.372 9.372-24.568 0-33.941zM112 192V84c0-19.851 16.149-36 36-36h44c13.255 0 24-10.745 24-24S205.255 0 192 0h-44c-46.318 0-84 37.683-84 84v98.059l-56.971 56.97c-9.373 9.373-9.373 24.568 0 33.941L64 329.941V428c0 46.317 37.682 84 84 84h44c13.255 0 24-10.745 24-24s-10.745-24-24-24h-44c-19.851 0-36-16.149-36-36V320c0-6.365-2.529-12.47-7.029-16.971L57.941 256l47.029-47.029A24.002 24.002 0 0 0 112 192z"></path>
  </symbol>
  <symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="copy">
    <path d="M23 2.75A2.75 2.75 0 0 0 20.25 0H8.75A2.75 2.75 0 0 0 6 2.75v13.5A2.75 2.75 0 0 0 8.75 19h11.5A2.75 2.75 0 0 0 23 16.25zM18.25 14.5h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5zm0-3h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5zm0-3h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5z"></path>
    <path d="M8.75 20.5a4.255 4.255 0 0 1-4.25-4.25V2.75c0-.086.02-.166.025-.25H3.75A2.752 2.752 0 0 0 1 5.25v16A2.752 2.752 0 0 0 3.75 24h12a2.752 2.752 0 0 0 2.75-2.75v-.75z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.001 512.001" id="closeme">
    <path d="M284.286 256.002L506.143 34.144c7.811-7.811 7.811-20.475 0-28.285-7.811-7.81-20.475-7.811-28.285 0L256 227.717 34.143 5.859c-7.811-7.811-20.475-7.811-28.285 0-7.81 7.811-7.811 20.475 0 28.285l221.857 221.857L5.858 477.859c-7.811 7.811-7.811 20.475 0 28.285a19.938 19.938 0 0 0 14.143 5.857 19.94 19.94 0 0 0 14.143-5.857L256 284.287l221.857 221.857c3.905 3.905 9.024 5.857 14.143 5.857s10.237-1.952 14.143-5.857c7.811-7.811 7.811-20.475 0-28.285L284.286 256.002z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="open-menu">
    <path d="M492 236H20c-11.046 0-20 8.954-20 20s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20zm0-160H20C8.954 76 0 84.954 0 96s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20zm0 320H20c-11.046 0-20 8.954-20 20s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="instagram">
    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id=youtube>
    <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="stackoverflow">
    <path d="M21 27v-8h3v11H0V19h3v8h18z"></path><path d="M17.1.2L15 1.8l7.9 10.6 2.1-1.6L17.1.2zm3.7 14.7L10.6 6.4l1.7-2 10.2 8.5-1.7 2zM7.2 12.3l12 5.6 1.1-2.4-12-5.6-1.1 2.4zm-1.8 6.8l13.56 1.96.17-2.38-13.26-2.55-.47 2.97zM19 25H5v-3h14v3z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="xing">
    <path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 71 55" id="discord">
    <path d="M60.1045 4.8978C55.5792 2.8214 50.7265 1.2916 45.6527 0.41542C45.5603 0.39851 45.468 0.440769 45.4204 0.525289C44.7963 1.6353 44.105 3.0834 43.6209 4.2216C38.1637 3.4046 32.7345 3.4046 27.3892 4.2216C26.905 3.0581 26.1886 1.6353 25.5617 0.525289C25.5141 0.443589 25.4218 0.40133 25.3294 0.41542C20.2584 1.2888 15.4057 2.8186 10.8776 4.8978C10.8384 4.9147 10.8048 4.9429 10.7825 4.9795C1.57795 18.7309 -0.943561 32.1443 0.293408 45.3914C0.299005 45.4562 0.335386 45.5182 0.385761 45.5576C6.45866 50.0174 12.3413 52.7249 18.1147 54.5195C18.2071 54.5477 18.305 54.5139 18.3638 54.4378C19.7295 52.5728 20.9469 50.6063 21.9907 48.5383C22.0523 48.4172 21.9935 48.2735 21.8676 48.2256C19.9366 47.4931 18.0979 46.6 16.3292 45.5858C16.1893 45.5041 16.1781 45.304 16.3068 45.2082C16.679 44.9293 17.0513 44.6391 17.4067 44.3461C17.471 44.2926 17.5606 44.2813 17.6362 44.3151C29.2558 49.6202 41.8354 49.6202 53.3179 44.3151C53.3935 44.2785 53.4831 44.2898 53.5502 44.3433C53.9057 44.6363 54.2779 44.9293 54.6529 45.2082C54.7816 45.304 54.7732 45.5041 54.6333 45.5858C52.8646 46.6197 51.0259 47.4931 49.0921 48.2228C48.9662 48.2707 48.9102 48.4172 48.9718 48.5383C50.038 50.6034 51.2554 52.5699 52.5959 54.435C52.6519 54.5139 52.7526 54.5477 52.845 54.5195C58.6464 52.7249 64.529 50.0174 70.6019 45.5576C70.6551 45.5182 70.6887 45.459 70.6943 45.3942C72.1747 30.0791 68.2147 16.7757 60.1968 4.9823C60.1772 4.9429 60.1437 4.9147 60.1045 4.8978ZM23.7259 37.3253C20.2276 37.3253 17.3451 34.1136 17.3451 30.1693C17.3451 26.225 20.1717 23.0133 23.7259 23.0133C27.308 23.0133 30.1626 26.2532 30.1066 30.1693C30.1066 34.1136 27.28 37.3253 23.7259 37.3253ZM47.3178 37.3253C43.8196 37.3253 40.9371 34.1136 40.9371 30.1693C40.9371 26.225 43.7636 23.0133 47.3178 23.0133C50.9 23.0133 53.7545 26.2532 53.6986 30.1693C53.6986 34.1136 50.9 37.3253 47.3178 37.3253Z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 18" id="mastodon">
    <path
    fill="#ffffff"
    d="m 15.054695,9.8859583 c -0.22611,1.1632697 -2.02517,2.4363497 -4.09138,2.6830797 -1.0774504,0.12856 -2.1382704,0.24673 -3.2694704,0.19484 -1.84996,-0.0848 -3.30971,-0.44157 -3.30971,-0.44157 0,0.1801 0.0111,0.35157 0.0333,0.51194 0.24051,1.82571 1.81034,1.93508 3.29737,1.98607 1.50088,0.0514 2.8373104,-0.37004 2.8373104,-0.37004 l 0.0617,1.35686 c 0,0 -1.0498104,0.56374 -2.9199404,0.66742 -1.03124,0.0567 -2.3117,-0.0259 -3.80308,-0.42069 -3.23454998,-0.85613 -3.79081998,-4.304 -3.87592998,-7.8024197 -0.026,-1.03871 -0.01,-2.01815 -0.01,-2.83732 0,-3.57732 2.34385998,-4.62587996 2.34385998,-4.62587996 1.18184,-0.54277 3.20976,-0.77101 5.318,-0.7882499985409 h 0.0518 C 9.8267646,0.01719834 11.856025,0.24547834 13.037775,0.78824834 c 0,0 2.34377,1.04855996 2.34377,4.62587996 0,0 0.0294,2.63937 -0.32687,4.47183"/>
 <path
    fill="#000000"
    d="m 12.616925,5.6916583 v 4.3315297 h -1.71607 V 5.8189683 c 0,-0.88624 -0.37289,-1.33607 -1.1187604,-1.33607 -0.82467,0 -1.23799,0.53361 -1.23799,1.58875 v 2.30122 h -1.70594 v -2.30122 c 0,-1.05514 -0.4134,-1.58875 -1.23808,-1.58875 -0.74587,0 -1.11876,0.44983 -1.11876,1.33607 v 4.2042197 h -1.71607 V 5.6916583 c 0,-0.88527 0.22541,-1.58876 0.67817,-2.10922 0.46689,-0.52047 1.07833,-0.78727 1.83735,-0.78727 0.87816,0 1.54317,0.33752 1.98288,1.01267 l 0.42744,0.71655 0.42753,-0.71655 c 0.43961,-0.67515 1.10463,-1.01267 1.9828704,-1.01267 0.75893,0 1.37037,0.2668 1.83735,0.78727 0.45268,0.52046 0.67808,1.22395 0.67808,2.10922"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 530" id="bluesky" >
    <path d="m135.72 44.03c66.496 49.921 138.02 151.14 164.28 205.46 26.262-54.316 97.782-155.54 164.28-205.46 47.98-36.021 125.72-63.892 125.72 24.795 0 17.712-10.155 148.79-16.111 170.07-20.703 73.984-96.144 92.854-163.25 81.433 117.3 19.964 147.14 86.092 82.697 152.22-122.39 125.59-175.91-31.511-189.63-71.766-2.514-7.3797-3.6904-10.832-3.7077-7.8964-0.0174-2.9357-1.1937 0.51669-3.7077 7.8964-13.714 40.255-67.233 197.36-189.63 71.766-64.444-66.128-34.605-132.26 82.697-152.22-67.108 11.421-142.55-7.4491-163.25-81.433-5.9562-21.282-16.111-152.36-16.111-170.07 0-88.687 77.742-60.816 125.72-24.795z"/>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" id="ko-fi">
    <path fill="#ffffff" d="M4.5,9.8527H32.7947a0,0,0,0,1,0,0v19.225a9.07,9.07,0,0,1-9.07,9.07H13.57a9.07,9.07,0,0,1-9.07-9.07V9.8527A0,0,0,0,1,4.5,9.8527Z"/>
    <path fill="#000000" d="M12.197,25.9493l6.45,6.45,6.45-6.45a8.2,8.2,0,0,0,2.4016-5.798h0a4.5082,4.5082,0,0,0-4.212-4.5459,4.4262,4.4262,0,0,0-4.64,4.4209,4.4261,4.4261,0,0,0-4.64-4.4209,4.5082,4.5082,0,0,0-4.212,4.5459h0A8.2,8.2,0,0,0,12.197,25.9493Z"/>
    <path fill="#ffffff" d="M32.7947,9.8527H35.73a7.77,7.77,0,0,1,0,15.5394H32.7947"/>
  </svg>
  </symbol>
</svg>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha512-aOFyMMzZF7l7ei3vOKgQiRhZnYqk9YC/uMzl4T0j5N5D3Kul+QAFU8ssENDRMAqr/lxDOjMF69dSYJ8HYqY+WQ==" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha512-UPFOadao2nEorjtjl0xUTtN3w20Ja143UPEU6EyJ1mi5MB2bDtMkiWmqGDqi47xNLB5z1dy31GKJDEWhjUJFiQ==" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha512-YJVxTjqttjsU3cSvaTRqsSl0wbRgZUNF+NGGCgto/MUbIvaLdXQzGTCQu4CvyJZbZctgflVB0PXw9LLmTWm5/w==" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<footer class="footer">
  <div class="footer_inner wrap pale">
    <img src='https://jianlin-li.github.io/icons/apple-touch-icon.png' class="icon icon_2 transparent" alt="Copyright Â© 1989â€“2025, æå»ºæ— ">
    <p>Copyright&nbsp;1989-&nbsp;<span class="year"></span>&nbsp;COPYRIGHT Â© 1989â€“2025, æå»ºæ— . All Rights Reserved</p><a class="to_top" href="#documentTop">
  <svg class="icon">
  <title>to-top</title>
  <use xlink:href="#to-top"></use>
</svg>

</a>

  </div>
</footer>

<script type="text/javascript" src="https://jianlin-li.github.io/zh-cn/js/bundle.e4e0e4fbe8acb50d7f973828f4138cdbea727800047fc93f9abbd6751e8f3422d6ef193f98da36fdb8488219c25692d73da89480f46abc8421a4ee3526dd6c23.js" integrity="sha512-5ODk&#43;&#43;istQ1/lzgo9BOM2&#43;pyeAAEf8k/mrvWdR6PNCLW7xk/mNo2/bhIghnCVpLXPaiUgPRqvIQhpO41Jt1sIw==" crossorigin="anonymous"></script>

  <script src="https://jianlin-li.github.io/js/search.min.8d141e1e7aa85984a5288b2172ad03540fc235f64379f8df11d062fd3deb9d49bbd9fb0f3df983e9663e322fa8e322a336d5350fbe833c77eb9ee7d907636cff.js"></script>

  </body>
</html>
